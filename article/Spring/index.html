<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="keyword"  content="">
    <link rel="shortcut icon" href="/img/ironman-draw.png">
    <!-- Place this tag in your head or just before your close body tag. -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <title>
        
          Spring - äºè…¾ | Blog
        
    </title>

    <link rel="canonical" href="https://github-yuteng.github.io/article/Spring/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS --> 
    <link rel="stylesheet" href="/css/beantech.min.css">

    <link rel="stylesheet" href="/css/donate.css">
    
    <!-- Pygments Highlight CSS -->
    <link rel="stylesheet" href="/css/highlight.css">

    <link rel="stylesheet" href="/css/widget.css">

    <link rel="stylesheet" href="/css/rocket.css">

    <link rel="stylesheet" href="/css/signature.css">

    <link rel="stylesheet" href="/css/toc.css">

    <!-- Custom Fonts -->
    <!-- <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <!-- Hux change font-awesome CDN to qiniu -->
    <link href="https://cdn.staticfile.org/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">


    <!-- Hux Delete, sad but pending in China
    <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/
    css'>
    -->


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- ga & ba script hoook -->
    <script></script>
</head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">
	<!-- Modified by Yu-Hsuan Yen -->
<!-- Post Header -->
<style type="text/css">
    header.intro-header{
        
            background-image: url('/img/article_header/article_bg.jpg')
            /*post*/
        
    }
    
</style>

<header class="intro-header" >
    <!-- Signature -->
    <div id="signature">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                
                    <div class="post-heading">
                        <div class="tags">
                            
                              <a class="tag" href="/tags/#Springå…¨å®¶æ¡¶" title="Springå…¨å®¶æ¡¶">Springå…¨å®¶æ¡¶</a>
                            
                        </div>
                        <h1>Spring</h1>
                        <h2 class="subheading"></h2>
                        <span class="meta">
                            Posted by äºè…¾ on
                            2019-03-24
                        </span>
                    </div>
                


                </div>
            </div>
        </div>
    </div>
</header>

	
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">æ‰€çˆ±éš”å±±æµ·</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <!-- Known Issue, found by Hux:
            <nav>'s height woule be hold on by its content.
            so, when navbar scale out, the <nav> will cover tags.
            also mask any touch event of tags, unfortunately.
        -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>

                    

                        
                    

                        
                        <li>
                            <a href="/about/">å…³äºæˆ‘</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/archive/">Archives</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/tags/">Tags</a>
                        </li>
                        
                    
                    
                </ul>
            </div>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        // CLOSE
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        // OPEN
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>


    <!-- Main Content -->
    <!-- Modify by Yu-Hsuan Yen -->

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                <h3 id="å…·ä½“æè¿°">å…·ä½“æè¿°ï¼š</h3>
<ul>
<li>è½»é‡çº§ï¼šSpring æ˜¯éä¾µå…¥æ€§çš„ â€“ åŸºäº Spring å¼€å‘çš„åº”ç”¨ä¸­çš„å¯¹è±¡å¯ä»¥ä¸ä¾èµ–äº Spring çš„ API</li>
<li>ä¾èµ–æ³¨å…¥ (DI â€“ dependency injectionã€IOC) DIå’ŒIOCå…¶å®æ˜¯ä¸€å›äº‹</li>
<li>é¢å‘åˆ‡é¢ç¼–ç¨‹ (AOP â€“ aspect oriented programming)</li>
<li>å®¹å™¨ï¼š Spring æ˜¯ä¸€ä¸ªå®¹å™¨, å› ä¸ºå®ƒåŒ…å«å¹¶ä¸”ç®¡ç†åº”ç”¨å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸ</li>
<li>æ¡†æ¶ï¼š Spring å®ç°äº†ä½¿ç”¨ç®€å•çš„ç»„ä»¶é…ç½®ç»„åˆæˆä¸€ä¸ªå¤æ‚çš„åº”ç”¨ã€‚ åœ¨ Spring ä¸­å¯ä»¥ä½¿ç”¨ XML å’Œ Java æ³¨è§£ç»„åˆè¿™äº›å¯¹è±¡</li>
<li>ä¸€ç«™å¼ï¼šåœ¨ IOC å’Œ AOP çš„åŸºç¡€ä¸Šå¯ä»¥æ•´åˆå„ç§ä¼ä¸šåº”ç”¨çš„å¼€æºæ¡†æ¶å’Œä¼˜ç§€çš„ç¬¬ä¸‰æ–¹ç±»åº“</li>
<li>ï¼ˆå®é™…ä¸Š Spring è‡ªèº«ä¹Ÿæä¾›äº†å±•ç°å±‚çš„ SpringMVC å’Œ æŒä¹…å±‚çš„ Spring JDBCï¼‰</li>
</ul>
<a id="more"></a>
<h1 id="springåŸºçŸ³ä¹‹ä¸€-ioc-å’Œ-di">SpringåŸºçŸ³ä¹‹ä¸€ ï¼š IOC å’Œ DI</h1>
<p><strong>1ã€IOC æ§åˆ¶åè½¬(Inversion of Control)</strong></p>
<ul>
<li>å…¶æ€æƒ³æ˜¯åè½¬èµ„æºè·å–çš„æ–¹å‘ã€‚ä¼ ç»Ÿçš„èµ„æºæŸ¥æ‰¾æ–¹å¼è¦æ±‚ç»„ä»¶å‘å®¹å™¨å‘èµ·è¯·æ±‚æŸ¥æ‰¾èµ„æºã€‚ä½œä¸ºå›åº”ï¼Œå®¹å™¨é€‚æ—¶çš„è¿”å›èµ„æºã€‚è€Œåº”ç”¨äº† IOC ä¹‹åï¼Œ åˆ™æ˜¯å®¹å™¨ä¸»åŠ¨åœ°å°†èµ„æºæ¨é€ç»™å®ƒæ‰€ç®¡ç†çš„ç»„ä»¶ï¼Œç»„ä»¶æ‰€è¦åšçš„ä»…æ˜¯é€‰æ‹©ä¸€ç§åˆé€‚çš„æ–¹å¼æ¥æ¥å—èµ„æºã€‚è¿™ç§è¡Œä¸ºä¹Ÿè¢«ç§°ä¸ºæŸ¥æ‰¾çš„è¢«åŠ¨å½¢å¼ã€‚</li>
</ul>
<p><strong>2ã€DI ä¾èµ–æ³¨å…¥(Dependency Injection)ä¾èµ–å®¹å™¨æŠŠèµ„æºæ³¨å…¥ â€” IOC çš„å¦ä¸€ç§è¡¨è¿°æ–¹å¼ï¼š</strong></p>
<ul>
<li>å³ç»„ä»¶ä»¥ä¸€äº›é¢„å…ˆå®šä¹‰å¥½çš„æ–¹å¼(ä¾‹å¦‚ï¼š setter æ–¹æ³•)æ¥å—æ¥è‡ªå¦‚å®¹å™¨çš„èµ„æºæ³¨å…¥ã€‚ç›¸å¯¹äº IOC è€Œè¨€ï¼Œè¿™ç§è¡¨è¿°æ›´ç›´æ¥ã€‚</li>
</ul>
<hr>
<p><strong>æ·»åŠ  jar åŒ…</strong></p>
<ul>
<li>commons-logging-1.x.x.jar</li>
<li>spring-core-4.0.0.RELEASE.jar</li>
<li>spring-context-4.0.0.RELEASE.jar</li>
<li>spring-expression-4.0.0.RELEASE.jar</li>
<li>spring-beans-4.0.0.RELEASE.jar</li>
</ul>
<p><strong>é…ç½® bean</strong><br>
1ã€é…ç½®å½¢å¼ï¼š åŸºäº XML æ–‡ä»¶çš„æ–¹å¼; åŸºäº æ³¨è§£ çš„æ–¹å¼;<br>
2ã€Bean çš„é…ç½®æ–¹å¼ï¼šé€šè¿‡å…¨ç±»åï¼ˆåå°„ï¼‰ã€é€šè¿‡å·¥å‚æ–¹æ³•ï¼ˆé™æ€å·¥å‚æ–¹æ³• &amp; å®ä¾‹å·¥å‚æ–¹æ³•ï¼‰ã€FactoryBean<br>
3ã€IOC å®¹å™¨ BeanFactory &amp; ApplicationContext æ¦‚è¿°<br>
4ã€ä¾èµ–æ³¨å…¥çš„æ–¹å¼ï¼š å±æ€§æ³¨å…¥; æ„é€ å™¨æ³¨å…¥ã€‚</p>
<hr>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"helloWorld"</span> <span class="attr">class</span>=<span class="string">"Spring1.HelloWorld"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"Spring"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="applicationcontextxml-springé…ç½®æ–‡ä»¶">applicationContext.xml Springé…ç½®æ–‡ä»¶</h4>
<p><strong>idï¼š</strong> Beançš„åç§°</p>
<ul>
<li>åœ¨IOCå®¹å™¨ä¸­å¿…é¡»æ˜¯å”¯ä¸€çš„ã€‚</li>
<li>è‹¥idæ²¡æœ‰æŒ‡å®šï¼ŒSpringè‡ªåŠ¨å°†æƒé™å®šæ€§ç±»åä½œä¸ºBeançš„åå­—ã€‚</li>
<li>idå¯ä»¥æŒ‡å®šå¤šä¸ªåå­—ï¼Œåå­—ä¹‹é—´å¯ç”¨ é€—å·ã€åˆ†å·ã€æˆ–ç©ºæ ¼åˆ†éš”ã€‚</li>
</ul>
<p><strong>classï¼š</strong> Beançš„å…¨ç±»åï¼Œé€šè¿‡åå°„çš„æœºåˆ¶åˆ›å»ºBeançš„å®ä¾‹ï¼Œéœ€è¦é»˜è®¤æ„é€ å™¨ã€‚è·å–å®¹å™¨å‰ä¼šåˆå§‹åŒ–ç±»ï¼Œè°ƒç”¨é»˜è®¤æ„é€ å™¨ã€‚<br>
<strong>propertyï¼š</strong> nameå±æ€§ --&gt; setXxxæ–¹æ³•å¯¹åº”æ³¨å…¥ã€‚value --&gt; å¯¹å˜é‡æ³¨å…¥çš„å€¼ã€‚</p>
<hr>
<h2 id="spring-å®¹å™¨">Spring å®¹å™¨</h2>
<ul>
<li>1ã€åœ¨ Spring IOC å®¹å™¨è¯»å– Bean é…ç½®åˆ›å»º Bean å®ä¾‹ä¹‹å‰, å¿…é¡»å¯¹å®ƒè¿›è¡Œå®ä¾‹åŒ–ã€‚</li>
<li>
<ul>
<li>åªæœ‰åœ¨å®¹å™¨å®ä¾‹åŒ–å, æ‰å¯ä»¥ä» IOC å®¹å™¨é‡Œè·å– Bean å®ä¾‹å¹¶ä½¿ç”¨ã€‚</li>
</ul>
</li>
<li>2ã€Spring æä¾›äº†ä¸¤ç§ç±»å‹çš„ IOC å®¹å™¨å®ç°ã€‚
<ul>
<li>BeanFactoryï¼š IOC å®¹å™¨çš„åŸºæœ¬å®ç°ã€‚</li>
<li><strong>ApplicationContextï¼š æä¾›äº†æ›´å¤šçš„é«˜çº§ç‰¹æ€§ã€‚<br>
æ˜¯ BeanFactory çš„å­æ¥å£</strong>( getBean() æ–¹æ³•æ‰€åœ¨ä½ç½®)ã€‚</li>
</ul>
</li>
<li>ClassPathXmlApplicationContext æ˜¯ ApplicationContext å®ç°ç±»ï¼Œä»ç±»è·¯å¾„ä¸‹åŠ è½½é…ç½®æ–‡ä»¶ã€‚</li>
<li>3ã€BeanFactory æ˜¯ Spring æ¡†æ¶çš„åŸºç¡€è®¾æ–½ï¼Œé¢å‘ Spring æœ¬èº«ï¼›
<ul>
<li>ApplicationContext é¢å‘ä½¿ç”¨ Spring æ¡†æ¶çš„å¼€å‘è€…ï¼Œå‡ ä¹æ‰€æœ‰çš„åº”ç”¨åœºåˆéƒ½ç›´æ¥ä½¿ç”¨</li>
<li>ApplicationContext è€Œéåº•å±‚çš„ BeanFactoryæ— è®ºä½¿ç”¨ä½•ç§æ–¹å¼, é…ç½®æ–‡ä»¶æ—¶ç›¸åŒçš„ã€‚</li>
</ul>
</li>
</ul>
<hr>
<h3 id="xml-é…ç½®é‡Œçš„-bean-è‡ªåŠ¨è£…é…">XML é…ç½®é‡Œçš„ Bean è‡ªåŠ¨è£…é…</h3>
<ul>
<li>Spring IOC å®¹å™¨å¯ä»¥è‡ªåŠ¨è£…é… Beanã€‚éœ€è¦åšçš„ä»…ä»…æ˜¯åœ¨ <bean> çš„ autowire å±æ€§æŒ‡å®šè‡ªåŠ¨è£…é…çš„æ¨¡å¼
<ul>
<li>
<p>byType(æ ¹æ®ç±»å‹è‡ªåŠ¨è£…é…)ï¼š è‹¥ IOC å®¹å™¨ä¸­æœ‰å¤šä¸ªä¸ç›®æ ‡ Bean ç±»å‹ä¸€è‡´çš„ Beanã€‚</p>
<ul>
<li>åœ¨è¿™ç§æƒ…å†µ, Springå°†æ— æ³•åˆ¤å®šå“ªä¸ª Bean æœ€åˆé€‚è¯¥å±æ€§, æ‰€ä»¥ä¸èƒ½æ‰§è¡Œè‡ªåŠ¨è£…é…ã€‚</li>
</ul>
</li>
<li>
<p>byName(æ ¹æ®åç§°è‡ªåŠ¨è£…é…)ï¼š å¿…é¡»å°†ç›®æ ‡ Bean çš„åç§°å’Œå±æ€§åè®¾ç½®çš„å®Œå…¨ç›¸åŒã€‚</p>
<ul>
<li>constructor(é€šè¿‡æ„é€ å™¨è‡ªåŠ¨è£…é…)ï¼š å½“ Bean ä¸­å­˜åœ¨å¤šä¸ªæ„é€ å™¨æ—¶, æ­¤ç§è‡ªåŠ¨è£…é…æ–¹å¼å°†ä¼šå¾ˆå¤æ‚ã€‚ ä¸æ¨èä½¿ç”¨ã€‚</li>
</ul>
</li>
</ul>
</bean></li>
</ul>
<hr>
<h3 id="bean-çš„ä½œç”¨åŸŸ">Bean çš„ä½œç”¨åŸŸ</h3>
<p><strong>åœ¨ Spring ä¸­, å¯ä»¥åœ¨ <bean> å…ƒç´ çš„ scope å±æ€§é‡Œè®¾ç½® Bean çš„ä½œç”¨åŸŸã€‚</bean></strong></p>
<p><strong>é»˜è®¤æƒ…å†µä¸‹, Spring åªä¸ºæ¯ä¸ªåœ¨ IOC å®¹å™¨é‡Œå£°æ˜çš„ Bean åˆ›å»º<code>å”¯ä¸€å®ä¾‹</code></strong><br>
<strong>æ•´ä¸ª IOC å®¹å™¨èŒƒå›´å†…éƒ½èƒ½å…±äº«è¯¥å®ä¾‹;æ‰€æœ‰åç»­çš„ getBean()è°ƒç”¨å’ŒBeanå¼•ç”¨éƒ½å°†è¿”å›è¿™ä¸ªçš„Bean</strong></p>
<p><strong>è¯¥ä½œç”¨åŸŸè¢«ç§°ä¸º singleton</strong>,å®ƒæ˜¯æ‰€æœ‰Beançš„é»˜è®¤ä½œç”¨åŸŸã€‚</p>
<ul>
<li><strong>scopeå±æ€§ä¸º prototype å¤šä¾‹ æ¯æ¬¡ getBean() è·å–Beanéƒ½åˆ›å»ºä¸€ä¸ªæ–°å®ä¾‹ã€‚</strong></li>
</ul>
<hr>
<h3 id="ioc-å®¹å™¨ä¸­-bean-çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•">IOC å®¹å™¨ä¸­ Bean çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•</h3>
<p>Spring IOC å®¹å™¨å¯ä»¥ç®¡ç† Bean çš„ç”Ÿå‘½å‘¨æœŸ, Spring å…è®¸åœ¨ Bean ç”Ÿå‘½å‘¨æœŸçš„ç‰¹å®šç‚¹æ‰§è¡Œå®šåˆ¶çš„ä»»åŠ¡ã€‚</p>
<p><strong>Spring IOC å®¹å™¨å¯¹ Bean çš„ç”Ÿå‘½å‘¨æœŸè¿›è¡Œç®¡ç†çš„è¿‡ç¨‹ï¼š</strong><br>
1ã€é€šè¿‡æ„é€ å™¨æˆ–å·¥å‚æ–¹æ³•åˆ›å»º Bean å®ä¾‹,è°ƒç”¨é»˜è®¤æ„é€ å™¨ã€‚<br>
2ã€ä¸º Bean çš„å±æ€§è®¾ç½®å€¼å’Œå¯¹å…¶ä»– Bean çš„å¼•ç”¨ã€‚<br>
3ã€è°ƒç”¨ Bean çš„åˆå§‹åŒ–æ–¹æ³• init();<br>
4ã€Bean å¯ä»¥ä½¿ç”¨äº†ã€‚<br>
5ã€å½“å®¹å™¨å…³é—­æ—¶, è°ƒç”¨ Bean çš„é”€æ¯æ–¹æ³• destroy();<br>
6ã€åœ¨ Bean çš„å£°æ˜é‡Œè®¾ç½® init-method å’Œ destroy-method å±æ€§, ä¸º Bean æŒ‡å®šåˆå§‹åŒ–å’Œé”€æ¯æ–¹æ³•ã€‚</p>
<h3 id="åˆ›å»º-bean-åç½®å¤„ç†å™¨åçš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•-æ¯”è¾ƒä¸Šæ–¹ç”Ÿå‘½å‘¨æœŸ">åˆ›å»º Bean åç½®å¤„ç†å™¨åçš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•  æ¯”è¾ƒä¸Šæ–¹ç”Ÿå‘½å‘¨æœŸ ğŸ‘†</h3>
<blockquote>
<p>Bean åç½®å¤„ç†å™¨å…è®¸åœ¨è°ƒç”¨åˆå§‹åŒ–æ–¹æ³•å‰åå¯¹ Bean è¿›è¡Œé¢å¤–çš„å¤„ç†ã€‚<br>
<code>Bean åç½®å¤„ç†å™¨å¯¹ IOC å®¹å™¨é‡Œçš„æ‰€æœ‰ Bean å®ä¾‹é€ä¸€å¤„ç†, è€Œéå•ä¸€å®ä¾‹ã€‚</code></p>
</blockquote>
<ul>
<li>å…¶å…¸å‹åº”ç”¨æ˜¯ï¼š æ£€æŸ¥ Bean å±æ€§çš„æ­£ç¡®æ€§æˆ–æ ¹æ®ç‰¹å®šçš„æ ‡å‡†æ›´æ”¹ Bean çš„å±æ€§.</li>
</ul>
<blockquote>
<p>** å¯¹Bean åç½®å¤„ç†å™¨è€Œè¨€, éœ€è¦å®ç° BeanPostProcessor æ¥å£ã€‚**<br>
åœ¨åˆå§‹åŒ–æ–¹æ³•è¢«è°ƒç”¨å‰å, Spring å°†æŠŠæ¯ä¸ª Bean å®ä¾‹åˆ†åˆ«ä¼ é€’ç»™ä¸Šè¿°æ¥å£çš„ä»¥ä¸‹ä¸¤ä¸ªæ–¹æ³•ï¼š<br>
postProcessAfterInitialization();<br>
postProcessBeforeInitialization();<br>
** éœ€è¦åœ¨ applicationContext.xmlé…ç½®æ–‡ä»¶ é…ç½®è¿™ä¸ªå®ç° BeanPostProcessor æ¥å£çš„ç±» **</p>
</blockquote>
<p><strong>æ·»åŠ  Bean åç½®å¤„ç†å™¨å Bean çš„ç”Ÿå‘½å‘¨æœŸ Spring IOC å®¹å™¨å¯¹ Bean çš„ç”Ÿå‘½å‘¨æœŸè¿›è¡Œç®¡ç†çš„è¿‡ç¨‹ï¼š</strong><br>
1ã€é€šè¿‡æ„é€ å™¨æˆ–å·¥å‚æ–¹æ³•åˆ›å»º Bean å®ä¾‹,è°ƒç”¨é»˜è®¤æ„é€ å™¨ã€‚<br>
2ã€ä¸º Bean çš„å±æ€§è®¾ç½®å€¼å’Œå¯¹å…¶ä»– Bean çš„å¼•ç”¨ã€‚<br>
3ã€å°† Bean å®ä¾‹ä¼ é€’ç»™ Bean åç½®å¤„ç†å™¨çš„ postProcessBeforeInitialization æ–¹æ³• init() æ–¹æ³•ä¹‹å‰è°ƒç”¨<br>
4ã€è°ƒç”¨ Bean çš„åˆå§‹åŒ–æ–¹æ³• init();<br>
5ã€å°† Bean å®ä¾‹ä¼ é€’ç»™ Bean åç½®å¤„ç†å™¨çš„ postProcessAfterInitialization æ–¹æ³•  init() æ–¹æ³•ä¹‹åè°ƒç”¨<br>
6ã€Bean å¯ä»¥ä½¿ç”¨äº†<br>
7ã€å½“å®¹å™¨å…³é—­æ—¶, è°ƒç”¨ Bean çš„é”€æ¯æ–¹æ³• destroy();</p>
<hr>
<h3 id="ä½¿ç”¨å¤–éƒ¨å±æ€§æ–‡ä»¶">ä½¿ç”¨å¤–éƒ¨å±æ€§æ–‡ä»¶</h3>
<blockquote>
<p>åœ¨é…ç½®æ–‡ä»¶é‡Œé…ç½® Bean æ—¶, æœ‰æ—¶éœ€è¦åœ¨ Bean çš„é…ç½®é‡Œæ··å…¥ç³»ç»Ÿéƒ¨ç½²çš„ç»†èŠ‚ä¿¡æ¯(ä¾‹å¦‚ï¼š æ–‡ä»¶è·¯å¾„, æ•°æ®æºé…ç½®ä¿¡æ¯ç­‰)ã€‚<br>
è€Œè¿™äº›éƒ¨ç½²ç»†èŠ‚å®é™…ä¸Šéœ€è¦å’Œ Bean é…ç½®ç›¸åˆ†ç¦»</p>
</blockquote>
<p><s>Spring 2.0 Spring æä¾›äº†ä¸€ä¸ª PropertyPlaceholderConfigurer çš„ BeanFactory åç½®å¤„ç†å™¨ (è¿‡æ—¶)</s><br>
è¿™ä¸ªå¤„ç†å™¨å…è®¸ç”¨æˆ·å°† Bean é…ç½®çš„éƒ¨åˆ†å†…å®¹å¤–ç§»åˆ°å±æ€§æ–‡ä»¶ä¸­ã€‚</p>
<p>** Spring 2.5 ä¹‹åï¼š å¯é€šè¿‡ &lt; contextï¼šproperty-placeholder /&gt; å…ƒç´ ç®€åŒ– **</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;contextï¼šcomponent-scan base-package="Spring"&gt;&lt;/contextï¼šcomponent-scan&gt;</span><br><span class="line">	</span><br><span class="line">&lt;!-- å¯¼å…¥èµ„æºæ–‡ä»¶ --&gt;</span><br><span class="line">&lt;contextï¼šproperty-placeholder location=<span class="string">"classpathï¼šdb.properties"</span>/&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- é…ç½® C3P0 æ•°æ®æº --&gt;</span><br><span class="line">&lt;bean id=<span class="string">"dataSource"</span></span><br><span class="line">	<span class="class"><span class="keyword">class</span></span>=<span class="string">"com.mchange.v2.c3p0.ComboPooledDataSource"</span>&gt;</span><br><span class="line">	&lt;property name="user" value="$&#123;jdbc.user&#125;"&gt;&lt;/property&gt;</span><br><span class="line">	&lt;property name="password" value="$&#123;jdbc.password&#125;"&gt;&lt;/property&gt;</span><br><span class="line">	&lt;property name="jdbcUrl" value="$&#123;jdbc.jdbcUrl&#125;"&gt;&lt;/property&gt;</span><br><span class="line">	&lt;property name="driverClass" value="$&#123;jdbc.driverClass&#125;"&gt;&lt;/property&gt;</span><br><span class="line"></span><br><span class="line">	&lt;property name="initialPoolSize" value="$&#123;jdbc.initPoolSize&#125;"&gt;&lt;/property&gt;</span><br><span class="line">	&lt;property name="maxPoolSize" value="$&#123;jdbc.maxPoolSize&#125;"&gt;&lt;/property&gt;</span><br><span class="line">&lt;/bean&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">db.properties</span><br><span class="line">æ–‡ä»¶å†…å®¹</span><br><span class="line">jdbc.user=root</span><br><span class="line">jdbc.password=root</span><br><span class="line">jdbc.jdbcUrl=jdbcï¼šmysqlï¼š//test</span><br><span class="line">jdbc.driverClass=com.mysql.jdbc.Driver</span><br><span class="line"></span><br><span class="line">jdbc.initPoolSize=5</span><br><span class="line">jdbc.maxPoolSize=10</span><br></pre></td></tr></table></figure>
<p>** å¯ä»¥åœ¨ Bean é…ç½®æ–‡ä»¶é‡Œä½¿ç”¨å½¢å¼ä¸º ${var} çš„å˜é‡ã€‚ **</p>
<hr>
<h3 id="é€šè¿‡è°ƒç”¨é™æ€å·¥å‚æ–¹æ³•åˆ›å»º-bean">é€šè¿‡è°ƒç”¨é™æ€å·¥å‚æ–¹æ³•åˆ›å»º Bean</h3>
<ul>
<li>è°ƒç”¨é™æ€å·¥å‚æ–¹æ³•åˆ›å»º Beanæ˜¯å°†å¯¹è±¡åˆ›å»ºçš„è¿‡ç¨‹å°è£…åˆ°é™æ€æ–¹æ³•ä¸­ã€‚ å½“å®¢æˆ·ç«¯éœ€è¦å¯¹è±¡æ—¶, åªéœ€è¦ç®€å•åœ°è°ƒç”¨é™æ€æ–¹æ³•, è€Œä¸åŒå…³å¿ƒåˆ›å»ºå¯¹è±¡çš„ç»†èŠ‚ã€‚</li>
<li>è¦å£°æ˜é€šè¿‡é™æ€æ–¹æ³•åˆ›å»ºçš„ Bean, éœ€è¦åœ¨ Bean çš„ class å±æ€§é‡ŒæŒ‡å®šæ‹¥æœ‰è¯¥å·¥å‚çš„æ–¹æ³•çš„ç±», åŒæ—¶åœ¨ factory-method å±æ€§é‡ŒæŒ‡å®šå·¥å‚æ–¹æ³•çš„åç§°ã€‚</li>
<li>æœ€å, ä½¿ç”¨ <constrctor-arg> å…ƒç´ ä¸ºè¯¥æ–¹æ³•ä¼ é€’æ–¹æ³•å‚æ•°ã€‚</constrctor-arg></li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- é€šè¿‡é™æ€å·¥å‚æ–¹æ³•ï¼š ä¸€ä¸ªç±»ä¸­æœ‰ä¸€ä¸ªé™æ€æ–¹æ³•, å¯ä»¥è¿”å›ä¸€ä¸ªç±»çš„å®ä¾‹(äº†è§£) --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- åœ¨ class ä¸­æŒ‡å®šé™æ€å·¥å‚æ–¹æ³•çš„å…¨ç±»å, åœ¨ factory-method ä¸­æŒ‡å®šé™æ€å·¥å‚æ–¹æ³•çš„æ–¹æ³•å --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dateFormat"</span> <span class="attr">class</span>=<span class="string">"java.text.DateFormat"</span> <span class="attr">factory-method</span>=<span class="string">"getDateInstance"</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- å¯ä»¥é€šè¿‡ constructor-arg å­èŠ‚ç‚¹ä¸ºé™æ€å·¥å‚æ–¹æ³•æŒ‡å®šå‚æ•° --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">value</span>=<span class="string">"2"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="é€šè¿‡è°ƒç”¨å®ä¾‹å·¥å‚æ–¹æ³•åˆ›å»º-bean">é€šè¿‡è°ƒç”¨å®ä¾‹å·¥å‚æ–¹æ³•åˆ›å»º Bean</h3>
<ul>
<li>å®ä¾‹å·¥å‚æ–¹æ³•ï¼š å°†å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹å°è£…åˆ°å¦å¤–ä¸€ä¸ªå¯¹è±¡å®ä¾‹çš„æ–¹æ³•é‡Œã€‚</li>
<li>å½“å®¢æˆ·ç«¯éœ€è¦è¯·æ±‚å¯¹è±¡æ—¶, åªéœ€è¦ç®€å•çš„è°ƒç”¨è¯¥å®ä¾‹æ–¹æ³•è€Œä¸éœ€è¦å…³å¿ƒå¯¹è±¡çš„åˆ›å»ºç»†èŠ‚ã€‚</li>
</ul>
<p>** è¦å£°æ˜é€šè¿‡å®ä¾‹å·¥å‚æ–¹æ³•åˆ›å»ºçš„ Bean **<br>
1ã€åœ¨ bean çš„ factory-bean å±æ€§é‡ŒæŒ‡å®šæ‹¥æœ‰è¯¥å·¥å‚æ–¹æ³•çš„ Bean<br>
2ã€åœ¨ factory-method å±æ€§é‡ŒæŒ‡å®šè¯¥å·¥å‚æ–¹æ³•çš„åç§°<br>
3ã€ä½¿ç”¨ construtor-arg å…ƒç´ ä¸ºå·¥å‚æ–¹æ³•ä¼ é€’æ–¹æ³•å‚æ•°</p>
<p>** å®ç° FactoryBean æ¥å£åœ¨ Spring IOC å®¹å™¨ä¸­é…ç½® Bean **</p>
<ul>
<li>Spring ä¸­æœ‰ä¸¤ç§ç±»å‹çš„ Bean, ä¸€ç§æ˜¯æ™®é€šBean, å¦ä¸€ç§æ˜¯å·¥å‚Bean, å³FactoryBean.</li>
<li>å·¥å‚ Bean è·Ÿæ™®é€šBeanä¸åŒ, å…¶è¿”å›çš„å¯¹è±¡ä¸æ˜¯æŒ‡å®šç±»çš„ä¸€ä¸ªå®ä¾‹, å…¶è¿”å›çš„æ˜¯è¯¥å·¥å‚ Bean çš„ getObject æ–¹æ³•æ‰€è¿”å›çš„å¯¹è±¡</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- å®ä¾‹å·¥å‚æ–¹æ³•ï¼š å…ˆéœ€è¦åˆ›å»ºå·¥å‚å¯¹è±¡, å†è°ƒç”¨å·¥å‚çš„éé™æ€æ–¹æ³•è¿”å›å®ä¾‹(äº†è§£) --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- â‘ . åˆ›å»ºå·¥å‚å¯¹åº”çš„ bean --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"simpleDateFormat"</span> <span class="attr">class</span>=<span class="string">"java.text.SimpleDateFormat"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">value</span>=<span class="string">"yyyy-MM-dd hhï¼šmmï¼šss"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- â‘¡. æœ‰å®ä¾‹å·¥å‚æ–¹æ³•æ¥åˆ›å»º bean å®ä¾‹ --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- factory-bean æŒ‡å‘å·¥å‚ bean, factory-method æŒ‡å®šå·¥å‚æ–¹æ³•(äº†è§£) --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"datetime"</span> <span class="attr">factory-bean</span>=<span class="string">"simpleDateFormat"</span> <span class="attr">factory-method</span>=<span class="string">"parse"</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- é€šè¿‡ constructor-arg æ‰§è¡Œè°ƒç”¨å·¥å‚æ–¹æ³•éœ€è¦ä¼ å…¥çš„å‚æ•° --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">value</span>=<span class="string">"1990-12-12 12ï¼š12ï¼š12"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<hr>
<h3 id="åœ¨-classpath-ä¸­æ‰«æç»„ä»¶">åœ¨ classpath ä¸­æ‰«æç»„ä»¶</h3>
<p>** ç»„ä»¶æ‰«æ(component scanning)ï¼š Spring èƒ½å¤Ÿä» classpath ä¸‹è‡ªåŠ¨æ‰«æ, ä¾¦æµ‹å’Œå®ä¾‹åŒ–å…·æœ‰ç‰¹å®šæ³¨è§£çš„ç»„ä»¶ã€‚**</p>
<ul>
<li>ç‰¹å®šç»„ä»¶åŒ…æ‹¬ï¼š
<ul>
<li>@Componentï¼š åŸºæœ¬æ³¨è§£, æ ‡è¯†äº†ä¸€ä¸ªå— Spring ç®¡ç†çš„ç»„ä»¶</li>
<li>@Respositoryï¼š æ ‡è¯†æŒä¹…å±‚ç»„ä»¶</li>
<li>@Serviceï¼š æ ‡è¯†æœåŠ¡å±‚(ä¸šåŠ¡å±‚)ç»„ä»¶</li>
<li>@Controllerï¼š æ ‡è¯†è¡¨ç°å±‚ç»„ä»¶<br>
å¯¹äºæ‰«æåˆ°çš„ç»„ä»¶, Spring æœ‰é»˜è®¤çš„å‘½åç­–ç•¥ï¼š ä½¿ç”¨éé™å®šç±»å, ç¬¬ä¸€ä¸ªå­—æ¯å°å†™ã€‚ä¹Ÿå¯ä»¥åœ¨æ³¨è§£ä¸­é€šè¿‡ value å±æ€§å€¼æ ‡è¯†ç»„ä»¶çš„åç§°ã€‚</li>
</ul>
</li>
</ul>
<blockquote>
<p>** å½“åœ¨ç»„ä»¶ç±»ä¸Šä½¿ç”¨äº†ç‰¹å®šçš„æ³¨è§£ä¹‹å, è¿˜éœ€è¦åœ¨ Spring çš„é…ç½®æ–‡ä»¶ä¸­å£°æ˜ **<br>
** &lt; contextï¼šcomponent-scan base-package=â€œSpringâ€&gt; **<br>
base-package å±æ€§æŒ‡å®šä¸€ä¸ªéœ€è¦æ‰«æçš„åŸºç±»åŒ…ï¼ŒSpring å®¹å™¨å°†ä¼šæ‰«æè¿™ä¸ªåŸºç±»åŒ…é‡ŒåŠå…¶å­åŒ…ä¸­çš„æ‰€æœ‰ç±»ã€‚<br>
å½“éœ€è¦æ‰«æå¤šä¸ªåŒ…æ—¶, å¯ä»¥ä½¿ç”¨é€—å·åˆ†éš”ã€‚</p>
</blockquote>
<blockquote>
<p>** å¦‚æœä»…å¸Œæœ›æ‰«æç‰¹å®šçš„ç±»è€ŒéåŸºåŒ…ä¸‹çš„æ‰€æœ‰ç±»ï¼Œå¯ä½¿ç”¨ resource-pattern æŒ‡å®šæ‰«æçš„èµ„æºï¼Œç¤ºä¾‹ï¼š**<br>
** &lt; contextï¼šcomponent-scan base-package=&quot;â€¦&quot; resource-pattern=â€œRespository/*â€&gt;&lt;/contextï¼šcomponent-scan &gt; **<br>
**	&lt; contextï¼šinclude-filter &gt; å­èŠ‚ç‚¹è¡¨ç¤ºè¦åŒ…å«çš„ç›®æ ‡ç±» **<br>
**	&lt; contextï¼šexclude-filter &gt; å­èŠ‚ç‚¹è¡¨ç¤ºè¦æ’é™¤åœ¨å¤–çš„ç›®æ ‡ç±» **<br>
** &lt; contextï¼šcomponent-scan &gt; ä¸‹å¯ä»¥æ‹¥æœ‰è‹¥å¹²ä¸ª &lt; contextï¼šinclude-filter &gt; å’Œ &lt; contextï¼šexclude-filter &gt; å­èŠ‚ç‚¹ **</p>
</blockquote>
<p>** &lt; contextï¼šinclude-filter &gt; å’Œ &lt; contextï¼šexclude-filter &gt; å­èŠ‚ç‚¹æ”¯æŒå¤šç§ç±»å‹çš„è¿‡æ»¤è¡¨è¾¾å¼ï¼š**</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">** æ³¨è§£ç±»å‹ **</span><br><span class="line"><span class="tag">&lt;<span class="name">contextï¼šcomponent-scan</span> <span class="attr">base-package</span>=<span class="string">"Spring"</span> <span class="attr">use-default-filters</span>=<span class="string">"false"</span>&gt;</span> //é»˜è®¤filterså¦‚æœå€¼ä¸ºtrueé»˜è®¤æ‰«æå…¨éƒ¨</span><br><span class="line">	// include-filter è¯¥å­èŠ‚ç‚¹éœ€è¦é…åˆ use-default-filters="false" ä½¿ç”¨</span><br><span class="line">	<span class="tag">&lt;<span class="name">contextï¼šinclude-filter</span> <span class="attr">type</span>=<span class="string">"annotation"</span> <span class="attr">expression</span>=<span class="string">"æ³¨è§£ç±»å‹å…¨ç±»å"</span>/&gt;</span> </span><br><span class="line">	<span class="tag">&lt;<span class="name">contextï¼šexclude-filter</span> <span class="attr">type</span>=<span class="string">"annotation"</span> <span class="attr">expression</span>=<span class="string">"æ³¨è§£ç±»å‹å…¨ç±»å"</span>/&gt;</span> // ä¸éœ€è¦</span><br><span class="line"><span class="tag">&lt;/<span class="name">contextï¼šcomponent-scan</span>&gt;</span></span><br><span class="line"></span><br><span class="line">** æ¥å£ç±»å‹æ‰«æ **</span><br><span class="line"><span class="tag">&lt;<span class="name">contextï¼šcomponent-scan</span> <span class="attr">base-package</span>=<span class="string">"Spring"</span> <span class="attr">use-default-filters</span>=<span class="string">"false"</span>&gt;</span> //é»˜è®¤filterså¦‚æœå€¼ä¸ºtrueé»˜è®¤æ‰«æå…¨éƒ¨</span><br><span class="line">	// include-filter è¯¥å­èŠ‚ç‚¹éœ€è¦é…åˆ use-default-filters="false" ä½¿ç”¨</span><br><span class="line">	<span class="tag">&lt;<span class="name">contextï¼šinclude-filter</span> <span class="attr">type</span>=<span class="string">"assignable"</span> <span class="attr">expression</span>=<span class="string">"æ¥å£å…¨ç±»å"</span>/&gt;</span> </span><br><span class="line">	<span class="tag">&lt;<span class="name">contextï¼šexclude-filter</span> <span class="attr">type</span>=<span class="string">"assignable"</span> <span class="attr">expression</span>=<span class="string">"æ¥å£å…¨ç±»å"</span>/&gt;</span> // ä¸éœ€è¦</span><br><span class="line"><span class="tag">&lt;/<span class="name">contextï¼šcomponent-scan</span>&gt;</span></span><br></pre></td></tr></table></figure>
<hr>
<h3 id="ç»„ä»¶è£…é…-è‡ªåŠ¨æ³¨å…¥">ç»„ä»¶è£…é… è‡ªåŠ¨æ³¨å…¥</h3>
<ul>
<li>&lt; contextï¼šcomponent-scan &gt; å…ƒç´ è¿˜ä¼šè‡ªåŠ¨æ³¨å†Œ AutowiredAnnotationBeanPostProcessor å®ä¾‹</li>
<li>è¯¥å®ä¾‹å¯ä»¥è‡ªåŠ¨è£…é…å…·æœ‰ @Autowired å’Œ @Resource ã€@Injectæ³¨è§£çš„å±æ€§.</li>
<li>@Resource æ³¨è§£è¦æ±‚æä¾›ä¸€ä¸ª Bean åç§°çš„å±æ€§ï¼Œè‹¥è¯¥å±æ€§ä¸ºç©ºï¼Œåˆ™è‡ªåŠ¨é‡‡ç”¨æ ‡æ³¨å¤„çš„å˜é‡æˆ–æ–¹æ³•åä½œä¸º Bean çš„åç§°</li>
<li>å»ºè®® @Autowired è‡ªåŠ¨è£…é… Bean</li>
<li>@Autowired æ³¨è§£è‡ªåŠ¨è£…é…å…·æœ‰å…¼å®¹ç±»å‹çš„å•ä¸ª Beanå±æ€§</li>
</ul>
<blockquote>
<p>æ„é€ å™¨, æ™®é€šå­—æ®µ (å³ä½¿æ˜¯é public), ä¸€åˆ‡å…·æœ‰å‚æ•°çš„æ–¹æ³•éƒ½å¯ä»¥åº”ç”¨@Autowired æ³¨è§£<br>
é»˜è®¤æƒ…å†µä¸‹, æ‰€æœ‰ä½¿ç”¨ @Autowired æ³¨è§£çš„å±æ€§éƒ½éœ€è¦è¢«è®¾ç½®ã€‚<br>
å½“ Spring æ‰¾ä¸åˆ°åŒ¹é…çš„ Bean è£…é…å±æ€§æ—¶, ä¼šæŠ›å‡ºå¼‚å¸¸, è‹¥æŸä¸€å±æ€§å…è®¸ä¸è¢«è®¾ç½®, å¯</p>
</blockquote>
<ul>
<li>ä»¥è®¾ç½® @Autowired æ³¨è§£çš„ required å±æ€§ä¸º false</li>
</ul>
<blockquote>
<p>é»˜è®¤æƒ…å†µä¸‹, å½“ IOC å®¹å™¨é‡Œå­˜åœ¨å¤šä¸ªç±»å‹å…¼å®¹çš„ Bean æ—¶, é€šè¿‡ç±»å‹çš„è‡ªåŠ¨è£…é…å°†æ— æ³•å·¥ä½œã€‚æ­¤æ—¶å¯ä»¥åœ¨ @Qualifier æ³¨è§£é‡Œæä¾› Bean çš„åç§°. Spring å…è®¸å¯¹æ–¹æ³•çš„å…¥å‚æ ‡æ³¨ @Qualifiter å·²æŒ‡å®šæ³¨å…¥ Bean çš„åç§°</p>
</blockquote>
<ul>
<li>@Autowired æ³¨è§£ä¹Ÿå¯ä»¥åº”ç”¨åœ¨æ•°ç»„ç±»å‹çš„å±æ€§ä¸Š, æ­¤æ—¶ Spring å°†ä¼šæŠŠæ‰€æœ‰åŒ¹é…çš„ Bean è¿›è¡Œè‡ªåŠ¨è£…é…ã€‚</li>
<li>@Autowired æ³¨è§£ä¹Ÿå¯ä»¥åº”ç”¨åœ¨é›†åˆå±æ€§ä¸Š, æ­¤æ—¶ Spring è¯»å–è¯¥é›†åˆçš„ç±»å‹ä¿¡æ¯, ç„¶åè‡ªåŠ¨è£…é…æ‰€æœ‰ä¸ä¹‹å…¼å®¹çš„ Beanã€‚</li>
<li>@Autowired æ³¨è§£ç”¨åœ¨java.util.Mapä¸Šæ—¶,è‹¥è¯¥ Map çš„é”®å€¼ä¸º String,é‚£ä¹ˆ Spring å°†è‡ªåŠ¨è£…é…ä¸ Map å€¼ç±»å‹å…¼å®¹çš„ Bean,æ­¤æ—¶ Bean çš„åç§°ä½œä¸ºé”®å€¼ã€‚</li>
</ul>
<hr>
<h3 id="springè¡¨è¾¾å¼è¯­è¨€spel">Springè¡¨è¾¾å¼è¯­è¨€ï¼šSpEL</h3>
<p>Spring è¡¨è¾¾å¼è¯­è¨€ï¼ˆç®€ç§°SpELï¼‰ï¼šæ˜¯ä¸€ä¸ªæ”¯æŒè¿è¡Œæ—¶æŸ¥è¯¢å’Œæ“ä½œå¯¹è±¡å›¾çš„å¼ºå¤§çš„è¡¨è¾¾å¼è¯­è¨€ã€‚<br>
è¯­æ³•ç±»ä¼¼äº ELï¼šSpEL ä½¿ç”¨ #{â€¦} ä½œä¸ºå®šç•Œç¬¦ï¼Œæ‰€æœ‰åœ¨å¤§æ¡†å·ä¸­çš„å­—ç¬¦éƒ½å°†è¢«è®¤ä¸ºæ˜¯ SpEL<br>
SpEL ä¸º bean çš„å±æ€§è¿›è¡ŒåŠ¨æ€èµ‹å€¼æä¾›äº†ä¾¿åˆ©<br>
é€šè¿‡ SpEL å¯ä»¥å®ç°ï¼š<br>
é€šè¿‡ bean çš„ id å¯¹ bean è¿›è¡Œå¼•ç”¨<br>
è°ƒç”¨æ–¹æ³•ä»¥åŠå¼•ç”¨å¯¹è±¡ä¸­çš„å±æ€§<br>
è®¡ç®—è¡¨è¾¾å¼çš„å€¼<br>
æ­£åˆ™è¡¨è¾¾å¼çš„åŒ¹é…</p>
<hr>
<h1 id="springåŸºçŸ³ä¹‹ä¸€-aop-aspect-oriented-programming-é¢å‘åˆ‡é¢ç¼–ç¨‹">SpringåŸºçŸ³ä¹‹ä¸€ ï¼šAOP (Aspect-Oriented Programming, é¢å‘åˆ‡é¢ç¼–ç¨‹)</h1>
<p>** AOPæ‰€å¤„ç†çš„é—®é¢˜ **</p>
<ul>
<li>ä»£ç æ··ä¹±ï¼šè¶Šæ¥è¶Šå¤šçš„éä¸šåŠ¡éœ€æ±‚(æ—¥å¿—å’ŒéªŒè¯ç­‰)åŠ å…¥å, åŸæœ‰çš„ä¸šåŠ¡æ–¹æ³•æ€¥å‰§è†¨èƒ€ã€‚æ¯ä¸ªæ–¹æ³•åœ¨å¤„ç†æ ¸å¿ƒé€»è¾‘çš„åŒæ—¶è¿˜å¿…é¡»å…¼é¡¾å…¶ä»–å¤šä¸ªå…³æ³¨ç‚¹ã€‚</li>
<li>ä»£ç åˆ†æ•£ï¼šä»¥æ—¥å¿—éœ€æ±‚ä¸ºä¾‹, åªæ˜¯ä¸ºäº†æ»¡è¶³è¿™ä¸ªéœ€æ±‚, ä¸å¾—ä¸åœ¨å¤šä¸ªæ¨¡å—(æ–¹æ³•)é‡Œå¤šæ¬¡é‡å¤ç›¸åŒçš„æ—¥å¿—ä»£ç ã€‚å¦‚æœæ—¥å¿—éœ€æ±‚å‘ç”Ÿå˜åŒ–, å¿…é¡»ä¿®æ”¹æ‰€æœ‰æ¨¡å—ã€‚</li>
</ul>
<hr>
<p>** ä½¿ç”¨åŠ¨æ€ä»£ç†è§£å†³ä¸Šè¿°é—®é¢˜ **</p>
<ul>
<li>ä»£ç†è®¾è®¡æ¨¡å¼çš„åŸç†ï¼š<br>
ä½¿ç”¨ä¸€ä¸ªä»£ç†å°†å¯¹è±¡åŒ…è£…èµ·æ¥, ç„¶åç”¨è¯¥ä»£ç†å¯¹è±¡å–ä»£åŸå§‹å¯¹è±¡ã€‚ä»»ä½•å¯¹åŸå§‹å¯¹è±¡çš„è°ƒç”¨éƒ½è¦é€šè¿‡ä»£ç†ã€‚ä»£ç†å¯¹è±¡å†³å®šæ˜¯å¦ä»¥åŠä½•æ—¶å°†æ–¹æ³•è°ƒç”¨è½¬åˆ°åŸå§‹å¯¹è±¡ä¸Š</li>
</ul>
<hr>
<p>** AOP (Aspect-Oriented Programming, é¢å‘åˆ‡é¢ç¼–ç¨‹) **</p>
<ul>
<li>æ˜¯ä¸€ç§æ–°çš„æ–¹æ³•è®º, æ˜¯å¯¹ä¼ ç»Ÿ OOP(Object-Oriented Programming, é¢å‘å¯¹è±¡ç¼–ç¨‹) çš„è¡¥å……ã€‚</li>
<li>AOP çš„ä¸»è¦ç¼–ç¨‹å¯¹è±¡æ˜¯åˆ‡é¢(aspect), åˆ‡é¢æ¨¡å—åŒ– --&gt; æ¨ªåˆ‡å…³æ³¨ç‚¹ã€‚</li>
<li>åœ¨åº”ç”¨ AOP ç¼–ç¨‹æ—¶, ä»ç„¶éœ€è¦å®šä¹‰å…¬å…±åŠŸèƒ½, ä½†å¯ä»¥æ˜ç¡®çš„å®šä¹‰è¿™ä¸ªåŠŸèƒ½åœ¨å“ªé‡Œ, ä»¥ä»€ä¹ˆæ–¹å¼åº”ç”¨, å¹¶ä¸”ä¸å¿…ä¿®æ”¹å—å½±å“çš„ç±»ã€‚</li>
<li>è¿™æ ·ä¸€æ¥æ¨ªåˆ‡å…³æ³¨ç‚¹å°±è¢«æ¨¡å—åŒ–åˆ°ç‰¹æ®Šçš„å¯¹è±¡(åˆ‡é¢)é‡Œã€‚</li>
</ul>
<hr>
<p>** AOP çš„å¥½å¤„ï¼š **</p>
<ul>
<li>æ¯ä¸ªäº‹ç‰©é€»è¾‘ä½äºä¸€ä¸ªä½ç½®, ä»£ç ä¸åˆ†æ•£, ä¾¿äºç»´æŠ¤å’Œå‡çº§ã€‚</li>
<li>ä¸šåŠ¡æ¨¡å—æ›´ç®€æ´, åªåŒ…å«æ ¸å¿ƒä¸šåŠ¡ä»£ç ã€‚</li>
</ul>
<hr>
<p>** AOP æœ¯è¯­ **<br>
** åˆ‡é¢(Aspect)ï¼š** æ¨ªåˆ‡å…³æ³¨ç‚¹ (è·¨è¶Šåº”ç”¨ç¨‹åºå¤šä¸ªæ¨¡å—çš„åŠŸèƒ½) è¢«æ¨¡å—åŒ–çš„ç‰¹æ®Šå¯¹è±¡ã€‚<br>
** é€šçŸ¥(Advice)ï¼š** åˆ‡é¢å¿…é¡»è¦å®Œæˆçš„å·¥ä½œã€‚<br>
** ç›®æ ‡(Target)ï¼š** è¢«é€šçŸ¥çš„å¯¹è±¡ã€‚<br>
** ä»£ç†(Proxy)ï¼š** å‘ç›®æ ‡å¯¹è±¡åº”ç”¨é€šçŸ¥ä¹‹ååˆ›å»ºçš„å¯¹è±¡ã€‚<br>
** è¿æ¥ç‚¹ï¼ˆJoinpointï¼‰ï¼š** ç¨‹åºæ‰§è¡Œçš„æŸä¸ªç‰¹å®šä½ç½®ï¼šå¦‚ç±»æŸä¸ªæ–¹æ³•è°ƒç”¨å‰ã€è°ƒç”¨åã€æ–¹æ³•æŠ›å‡ºå¼‚å¸¸åç­‰ã€‚</p>
<ul>
<li>** è¿æ¥ç‚¹ç”±ä¸¤ä¸ªä¿¡æ¯ç¡®å®šï¼š**
<ul>
<li>æ–¹æ³•è¡¨ç¤ºçš„ç¨‹åºæ‰§è¡Œç‚¹ã€‚</li>
<li>ç›¸å¯¹ç‚¹è¡¨ç¤ºçš„æ–¹ä½ã€‚</li>
<li>ä¾‹å¦‚ Calculator.add() æ–¹æ³•æ‰§è¡Œå‰çš„è¿æ¥ç‚¹ï¼Œæ‰§è¡Œç‚¹ä¸º Calculator.add()ï¼›æ–¹ä½ä¸ºè¯¥æ–¹æ³•æ‰§è¡Œå‰çš„ä½ç½®ã€‚</li>
</ul>
</li>
</ul>
<p>** åˆ‡ç‚¹ï¼ˆpointcutï¼‰ï¼š** æ¯ä¸ªç±»éƒ½æ‹¥æœ‰å¤šä¸ªè¿æ¥ç‚¹ï¼šä¾‹å¦‚ Calculator çš„æ‰€æœ‰æ–¹æ³•å®é™…ä¸Šéƒ½æ˜¯è¿æ¥ç‚¹ï¼Œå³è¿æ¥ç‚¹æ˜¯ç¨‹åºç±»ä¸­å®¢è§‚å­˜åœ¨çš„äº‹åŠ¡ã€‚</p>
<blockquote>
<p>** AOP é€šè¿‡åˆ‡ç‚¹å®šä½åˆ°ç‰¹å®šçš„è¿æ¥ç‚¹ã€‚ç±»æ¯”ï¼šè¿æ¥ç‚¹ç›¸å½“äºæ•°æ®åº“ä¸­çš„è®°å½•ï¼Œåˆ‡ç‚¹ç›¸å½“äºæŸ¥è¯¢æ¡ä»¶ã€‚**<br>
<code>åˆ‡ç‚¹å’Œè¿æ¥ç‚¹ä¸æ˜¯ä¸€å¯¹ä¸€çš„å…³ç³»ï¼Œä¸€ä¸ªåˆ‡ç‚¹åŒ¹é…å¤šä¸ªè¿æ¥ç‚¹ã€‚</code><br>
åˆ‡ç‚¹é€šè¿‡ org.springframework.aop.Pointcut æ¥å£è¿›è¡Œæè¿°ï¼Œå®ƒä½¿ç”¨ç±»å’Œæ–¹æ³•ä½œä¸ºè¿æ¥ç‚¹çš„æŸ¥è¯¢æ¡ä»¶ã€‚</p>
</blockquote>
<hr>
<h2 id="åœ¨-spring-ä¸­å¯ç”¨-aspectj-æ³¨è§£æ”¯æŒ">åœ¨ Spring ä¸­å¯ç”¨ AspectJ æ³¨è§£æ”¯æŒ</h2>
<ul>
<li>** è¦åœ¨ Spring åº”ç”¨ä¸­ä½¿ç”¨ AspectJ æ³¨è§£, å¿…é¡»åœ¨ classpath ä¸‹åŒ…å« AspectJ ç±»åº“ï¼š**
<ul>
<li>aopalliance.jar</li>
<li>aspectj.weaver.jar</li>
<li>spring-aspects-4.0.0.RELEASE.jar</li>
<li>spring-aop-4.0.0.RELEASE.jar</li>
</ul>
</li>
</ul>
<blockquote>
<p>** å°† aop Schema æ·»åŠ åˆ° <beans> æ ¹å…ƒç´ ä¸­ã€‚ **<br>
è¦åœ¨ Spring IOC å®¹å™¨ä¸­å¯ç”¨ AspectJ æ³¨è§£æ”¯æŒ, åªè¦åœ¨ Spring é…ç½®æ–‡ä»¶ä¸­å®šä¹‰ä¸€ä¸ªç©ºçš„ XML å…ƒç´  &lt;aopï¼šaspectj-autoproxy/&gt;</beans></p>
</blockquote>
 <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- é…ç½®è‡ªåŠ¨ä¸ºåŒ¹é… aspectJ æ³¨è§£çš„ Java ç±»ç”Ÿæˆä»£ç†å¯¹è±¡ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:aspectj-autoproxy</span>&gt;</span><span class="tag">&lt;/<span class="name">aop:aspectj-autoproxy</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>** å½“Spring IOCå®¹å™¨ä¾¦æµ‹åˆ°Springé…ç½®æ–‡ä»¶ä¸­çš„&lt; aopï¼šaspectj-autoproxy /&gt;å…ƒç´ æ—¶, ä¼šè‡ªåŠ¨ä¸º AspectJ åˆ‡é¢åŒ¹é…çš„ Bean åˆ›å»ºä»£ç† **</p>
<hr>
<h2 id="ç”¨-aspectj-æ³¨è§£å£°æ˜åˆ‡é¢">ç”¨ AspectJ æ³¨è§£å£°æ˜åˆ‡é¢</h2>
<p>** è¦åœ¨ Spring ä¸­å£°æ˜ AspectJ åˆ‡é¢, åªéœ€è¦åœ¨ IOC å®¹å™¨ä¸­å°†åˆ‡é¢å£°æ˜ä¸º Bean å®ä¾‹ã€‚**</p>
<ul>
<li>@Aspect //å£°æ˜æ­¤ç±»æ˜¯ä¸€ä¸ªåˆ‡é¢å¯¹è±¡</li>
<li>@Component //å£°æ˜æ­¤ç±»æ˜¯ Spring å®¹å™¨ ç®¡ç†çš„ç»„ä»¶</li>
</ul>
<p>å½“åœ¨ Spring IOC å®¹å™¨ä¸­åˆå§‹åŒ– AspectJ åˆ‡é¢ä¹‹å, Spring IOC å®¹å™¨å°±ä¼šä¸ºé‚£äº›ä¸ AspectJ åˆ‡é¢ç›¸åŒ¹é…çš„ Bean åˆ›å»ºä»£ç†ã€‚<br>
åœ¨ AspectJ æ³¨è§£ä¸­, åˆ‡é¢åªæ˜¯ä¸€ä¸ªå¸¦æœ‰ @Aspect æ³¨è§£çš„ Java ç±».</p>
<p>** é€šçŸ¥æ˜¯æ ‡æ³¨æœ‰æŸç§æ³¨è§£çš„ç®€å•çš„ Java æ–¹æ³• **</p>
<ul>
<li>AspectJ æ”¯æŒ 5 ç§ç±»å‹çš„é€šçŸ¥æ³¨è§£ï¼š
<ul>
<li>** @Beforeï¼š** å‰ç½®é€šçŸ¥, åœ¨æ–¹æ³•æ‰§è¡Œä¹‹å‰æ‰§è¡Œ</li>
<li>** @Afterï¼š ** åç½®é€šçŸ¥, åœ¨æ–¹æ³•æ‰§è¡Œä¹‹åæ‰§è¡Œ</li>
<li>** @AfterRunningï¼š** è¿”å›é€šçŸ¥, åœ¨æ–¹æ³•è¿”å›ç»“æœä¹‹åæ‰§è¡Œ</li>
<li>** @AfterThrowingï¼š** å¼‚å¸¸é€šçŸ¥, åœ¨æ–¹æ³•æŠ›å‡ºå¼‚å¸¸ä¹‹å</li>
<li>** @Aroundï¼š** ç¯ç»•é€šçŸ¥, å›´ç»•ç€æ–¹æ³•æ‰§è¡Œ</li>
</ul>
</li>
</ul>
<h4 id="æŒ‡å®šåˆ‡é¢çš„ä¼˜å…ˆçº§">æŒ‡å®šåˆ‡é¢çš„ä¼˜å…ˆçº§</h4>
<p>** åœ¨åŒä¸€ä¸ªè¿æ¥ç‚¹ä¸Šåº”ç”¨ä¸æ­¢ä¸€ä¸ªåˆ‡é¢æ—¶, é™¤éæ˜ç¡®æŒ‡å®š, å¦åˆ™å®ƒä»¬çš„ä¼˜å…ˆçº§æ˜¯ä¸ç¡®å®šçš„ã€‚**</p>
<ul>
<li>åˆ‡é¢çš„ä¼˜å…ˆçº§å¯ä»¥é€šè¿‡å®ç° Ordered æ¥å£æˆ–åˆ©ç”¨ @Order æ³¨è§£æŒ‡å®šã€‚
<ul>
<li>å®ç° Ordered æ¥å£, getOrder() æ–¹æ³•çš„è¿”å›å€¼è¶Šå°, ä¼˜å…ˆçº§è¶Šé«˜ã€‚</li>
<li>** è‹¥ä½¿ç”¨ @Order æ³¨è§£, åºå·å‡ºç°åœ¨æ³¨è§£ä¸­ã€‚**</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.aspectj.lang.JoinPoint;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.ProceedingJoinPoint;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.After;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.AfterReturning;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.AfterThrowing;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Around;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Aspect;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Before;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Pointcut;</span><br><span class="line"><span class="keyword">import</span> org.springframework.core.annotation.Order;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¯ä»¥ä½¿ç”¨ <span class="doctag">@Order</span> æ³¨è§£æŒ‡å®šåˆ‡é¢çš„ä¼˜å…ˆçº§, å€¼è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Order</span>(<span class="number">1</span>)</span><br><span class="line"><span class="meta">@Aspect</span> <span class="comment">//å£°æ˜æ­¤ç±»æ˜¯ä¸€ä¸ªåˆ‡é¢å¯¹è±¡</span></span><br><span class="line"><span class="meta">@Component</span> <span class="comment">//å£°æ˜æ­¤ç±»æ˜¯ Spring å®¹å™¨ ç®¡ç†çš„ç»„ä»¶</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoggingAspect</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * å®šä¹‰ä¸€ä¸ªæ–¹æ³•, ç”¨äºå£°æ˜åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ï¼Œ ä¸€èˆ¬åœ°, è¯¥æ–¹æ³•ä¸­å†ä¸éœ€è¦æ·»å…¥å…¶ä»–çš„ä»£ç </span></span><br><span class="line"><span class="comment">	 * ä½¿ç”¨ <span class="doctag">@Pointcut</span> æ¥å£°æ˜åˆ‡å…¥ç‚¹è¡¨è¾¾å¼</span></span><br><span class="line"><span class="comment">	 * åé¢çš„å…¶ä»–é€šçŸ¥ç›´æ¥ä½¿ç”¨æ–¹æ³•åæ¥å¼•ç”¨å½“å‰çš„åˆ‡å…¥ç‚¹è¡¨è¾¾å¼</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Pointcut</span>(<span class="string">"execution(public int spring.aop.Calculator.*(..))"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">declareJointPointExpression</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * åœ¨ spring.aop.Calculator æ¥å£çš„æ¯ä¸€ä¸ªå®ç°ç±»çš„æ¯ä¸€ä¸ªæ–¹æ³•å¼€å§‹ä¹‹å‰æ‰§è¡Œä¸€æ®µä»£ç </span></span><br><span class="line"><span class="comment">	 * JoinPoint joinPoint è¿æ¥ç‚¹</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Before</span>(value=<span class="string">"declareJointPointExpression()"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">beforeMethod</span><span class="params">(JoinPoint joinPoint)</span></span>&#123;</span><br><span class="line">		String methodName = joinPoint.getSignature().getName();</span><br><span class="line">		Object [] args = joinPoint.getArgs();</span><br><span class="line">		System.out.println(<span class="string">"The method "</span> + methodName + <span class="string">" begins with "</span> + Arrays.asList(args));</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * åœ¨æ–¹æ³•æ‰§è¡Œä¹‹åæ‰§è¡Œçš„ä»£ç , æ— è®ºè¯¥æ–¹æ³•æ˜¯å¦å‡ºç°å¼‚å¸¸ éƒ½æ‰§è¡Œã€‚è®¿é—®ä¸åˆ°è¿”å›å€¼</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@After</span>(value=<span class="string">"declareJointPointExpression()"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterMethod</span><span class="params">(JoinPoint joinPoint)</span></span>&#123;</span><br><span class="line">		String methodName = joinPoint.getSignature().getName();</span><br><span class="line">		System.out.println(<span class="string">"The method "</span> + methodName + <span class="string">" ends"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * åœ¨æ–¹æ³•æ³•æ­£å¸¸ç»“æŸå—æ‰§è¡Œçš„ä»£ç ï¼Œå‡ºç°å¼‚å¸¸ä¸æ‰§è¡Œ</span></span><br><span class="line"><span class="comment">	 * è¿”å›é€šçŸ¥æ˜¯å¯ä»¥è®¿é—®åˆ°æ–¹æ³•çš„è¿”å›å€¼çš„!</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@AfterReturning</span>(value=<span class="string">"declareJointPointExpression()"</span>,returning=<span class="string">"result"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterReturning</span><span class="params">(JoinPoint joinPoint, Object result)</span></span>&#123;</span><br><span class="line">		String methodName = joinPoint.getSignature().getName();</span><br><span class="line">		System.out.println(<span class="string">"The method "</span> + methodName + <span class="string">" ends with "</span> + result);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * åœ¨ç›®æ ‡æ–¹æ³•å‡ºç°å¼‚å¸¸æ—¶ä¼šæ‰§è¡Œçš„ä»£ç </span></span><br><span class="line"><span class="comment">	 * å¯ä»¥è®¿é—®åˆ°å¼‚å¸¸å¯¹è±¡; ä¸”å¯ä»¥æŒ‡å®šåœ¨å‡ºç°ç‰¹å®šå¼‚å¸¸æ—¶åœ¨æ‰§è¡Œé€šçŸ¥ä»£ç </span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@AfterThrowing</span>(value=<span class="string">"declareJointPointExpression()"</span>,throwing=<span class="string">"e"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterThrowing</span><span class="params">(JoinPoint joinPoint, Exception e)</span></span>&#123;</span><br><span class="line">		String methodName = joinPoint.getSignature().getName();</span><br><span class="line">		System.out.println(<span class="string">"The method "</span> + methodName + <span class="string">" occurs excetion:"</span> + e);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç¯ç»•é€šçŸ¥éœ€è¦æºå¸¦ ProceedingJoinPoint ç±»å‹çš„å‚æ•°. </span></span><br><span class="line"><span class="comment"> * ç¯ç»•é€šçŸ¥ç±»ä¼¼äºåŠ¨æ€ä»£ç†çš„å…¨è¿‡ç¨‹: ProceedingJoinPoint ç±»å‹çš„å‚æ•°å¯ä»¥å†³å®šæ˜¯å¦æ‰§è¡Œç›®æ ‡æ–¹æ³•.</span></span><br><span class="line"><span class="comment"> * ä¸”ç¯ç»•é€šçŸ¥å¿…é¡»æœ‰è¿”å›å€¼, è¿”å›å€¼å³ä¸ºç›®æ ‡æ–¹æ³•çš„è¿”å›å€¼</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">	</span><br><span class="line"><span class="meta">@Around</span>(<span class="string">"execution(public int spring.aop.Calculator.*(..))"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">aroundMethod</span><span class="params">(ProceedingJoinPoint pjd)</span></span>&#123;</span><br><span class="line">		</span><br><span class="line">	Object result = <span class="keyword">null</span>;</span><br><span class="line">	String methodName = pjd.getSignature().getName();</span><br><span class="line">		</span><br><span class="line">	<span class="keyword">try</span> &#123;</span><br><span class="line">		<span class="comment">//å‰ç½®é€šçŸ¥</span></span><br><span class="line">		System.out.println(<span class="string">"The method "</span> + methodName + <span class="string">" begins with "</span> + Arrays.asList(pjd.getArgs()));</span><br><span class="line">		<span class="comment">//æ‰§è¡Œç›®æ ‡æ–¹æ³•</span></span><br><span class="line">		result = pjd.proceed();</span><br><span class="line">		<span class="comment">//è¿”å›é€šçŸ¥</span></span><br><span class="line">		System.out.println(<span class="string">"The method "</span> + methodName + <span class="string">" ends with "</span> + result);</span><br><span class="line">	&#125; <span class="keyword">catch</span> (Throwable e) &#123;</span><br><span class="line">		<span class="comment">//å¼‚å¸¸é€šçŸ¥</span></span><br><span class="line">		System.out.println(<span class="string">"The method "</span> + methodName + <span class="string">" occurs exception:"</span> + e);</span><br><span class="line">		<span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e);</span><br><span class="line">	&#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">		<span class="comment">//åç½®é€šçŸ¥</span></span><br><span class="line">		System.out.println(<span class="string">"The method "</span> + methodName + <span class="string">" ends"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h6 id="ä¸€ä¸ªåˆ‡é¢å¯ä»¥åŒ…æ‹¬ä¸€ä¸ªæˆ–è€…å¤šä¸ªé€šçŸ¥">ä¸€ä¸ªåˆ‡é¢å¯ä»¥åŒ…æ‹¬ä¸€ä¸ªæˆ–è€…å¤šä¸ªé€šçŸ¥ã€‚</h6>
<h5 id="å‰ç½®é€šçŸ¥åœ¨æ–¹æ³•æ‰§è¡Œä¹‹å‰æ‰§è¡Œçš„é€šçŸ¥">å‰ç½®é€šçŸ¥ï¼šåœ¨æ–¹æ³•æ‰§è¡Œä¹‹å‰æ‰§è¡Œçš„é€šçŸ¥</h5>
<ul>
<li>å‰ç½®é€šçŸ¥ä½¿ç”¨ @Before æ³¨è§£, å¹¶å°†åˆ‡å…¥ç‚¹è¡¨è¾¾å¼çš„å€¼ä½œä¸ºæ³¨è§£å€¼ã€‚</li>
<li>è®©é€šçŸ¥è®¿é—®å½“å‰è¿æ¥ç‚¹çš„ç»†èŠ‚</li>
<li>å¯ä»¥åœ¨é€šçŸ¥æ–¹æ³•ä¸­å£°æ˜ä¸€ä¸ªç±»å‹ä¸º JoinPoint çš„å‚æ•°ã€‚ç„¶åå°±èƒ½è®¿é—®é“¾æ¥ç»†èŠ‚, å¦‚æ–¹æ³•åç§°å’Œå‚æ•°å€¼ã€‚</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Before</span>(<span class="string">"execution(public int spring.aop.*(int, int))"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">beforeMethod</span><span class="params">(JoinPoint joinPoint)</span> </span>&#123;</span><br><span class="line">		String methodName = joinPoint.getSignature().getName();</span><br><span class="line">		Object[] args = joinPoint.getArgs();</span><br><span class="line"></span><br><span class="line">		System.out.println(<span class="string">"The method "</span> + methodName + <span class="string">" begins with "</span> + Arrays.asList(args));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h5 id="åç½®é€šçŸ¥åœ¨ç›®æ ‡æ–¹æ³•æ‰§è¡Œå-æ— è®ºæ˜¯å¦å‘ç”Ÿå¼‚å¸¸éƒ½æ‰§è¡Œçš„é€šçŸ¥">åç½®é€šçŸ¥ï¼šåœ¨ç›®æ ‡æ–¹æ³•æ‰§è¡Œå (æ— è®ºæ˜¯å¦å‘ç”Ÿå¼‚å¸¸),éƒ½æ‰§è¡Œçš„é€šçŸ¥</h5>
<ul>
<li>åç½®é€šçŸ¥æ˜¯åœ¨è¿æ¥ç‚¹å®Œæˆä¹‹åæ‰§è¡Œçš„, å³è¿æ¥ç‚¹è¿”å›ç»“æœæˆ–è€…æŠ›å‡ºå¼‚å¸¸çš„æ—¶å€™, ä¸‹é¢çš„åç½®é€šçŸ¥è®°å½•äº†æ–¹æ³•çš„ç»ˆæ­¢ã€‚</li>
<li>åœ¨åç½®é€šçŸ¥ä¸­è¿˜ä¸èƒ½è®¿é—®ç›®æ ‡æ–¹æ³•æ‰§è¡Œçš„ç»“æœã€‚</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@After</span>(<span class="string">"execution(public int spring.aop.*(int, int))"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterMethod</span><span class="params">(JoinPoint joinPoint)</span> </span>&#123;</span><br><span class="line">		String methodName = joinPoint.getSignature().getName();</span><br><span class="line">		System.out.println(<span class="string">"The method "</span> + methodName + <span class="string">" ends"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h5 id="è¿”å›é€šçŸ¥åœ¨æ–¹æ³•æ­£å¸¸ç»“æŸåæ‰§è¡Œçš„ä»£ç ">è¿”å›é€šçŸ¥ï¼šåœ¨æ–¹æ³•æ­£å¸¸ç»“æŸåæ‰§è¡Œçš„ä»£ç </h5>
<ul>
<li>è¿”å›é€šçŸ¥æ˜¯å¯ä»¥è®¿é—®åˆ°æ–¹æ³•çš„è¿”å›å€¼çš„ã€‚</li>
<li>æ— è®ºè¿æ¥ç‚¹æ˜¯æ­£å¸¸è¿”å›è¿˜æ˜¯æŠ›å‡ºå¼‚å¸¸, åç½®é€šçŸ¥éƒ½ä¼šæ‰§è¡Œã€‚</li>
<li>ä½†å¦‚æœåªæƒ³åœ¨è¿æ¥ç‚¹è¿”å›çš„æ—¶å€™è®°å½•æ—¥å¿—, åº”ä½¿ç”¨è¿”å›é€šçŸ¥ä»£æ›¿åç½®é€šçŸ¥ã€‚</li>
</ul>
<p>** åœ¨è¿”å›é€šçŸ¥ä¸­è®¿é—®è¿æ¥ç‚¹çš„è¿”å›å€¼ **</p>
<ul>
<li>åœ¨è¿”å›é€šçŸ¥ä¸­, åªè¦å°† ** returning ** å±æ€§æ·»åŠ åˆ° ** @AfterReturning ** æ³¨è§£ä¸­, å°±å¯ä»¥è®¿é—®è¿æ¥ç‚¹çš„è¿”å›å€¼ã€‚
<ul>
<li>è¯¥å±æ€§çš„å€¼å³ä¸ºç”¨æ¥ä¼ å…¥è¿”å›å€¼çš„å‚æ•°åç§°ã€‚</li>
<li>å¿…é¡»åœ¨é€šçŸ¥æ–¹æ³•çš„ç­¾åä¸­æ·»åŠ ä¸€ä¸ª** åŒå **å‚æ•°ã€‚returning=â€œresultâ€ ç­¾åå±æ€§ä¹Ÿä¸º result ã€‚åœ¨è¿è¡Œæ—¶, Spring AOP ä¼šé€šè¿‡è¿™ä¸ªå‚æ•°ä¼ é€’è¿”å›å€¼ã€‚</li>
<li>åŸå§‹çš„åˆ‡ç‚¹è¡¨è¾¾å¼éœ€è¦å‡ºç°åœ¨ pointcut å±æ€§ä¸­ã€‚</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@AfterReturning</span>(value=<span class="string">"execution(public int spring.aop.*(..))"</span>,returning=<span class="string">"result"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterReturning</span><span class="params">(JoinPoint joinPoint, Object result)</span></span>&#123;</span><br><span class="line">		String methodName = joinPoint.getSignature().getName();</span><br><span class="line">		System.out.println(<span class="string">"The method "</span> + methodName + <span class="string">" ends with "</span> + result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h5 id="å¼‚å¸¸é€šçŸ¥åœ¨ç›®æ ‡æ–¹æ³•å‡ºç°å¼‚å¸¸æ—¶ä¼šæ‰§è¡Œçš„ä»£ç ">å¼‚å¸¸é€šçŸ¥ï¼šåœ¨ç›®æ ‡æ–¹æ³•å‡ºç°å¼‚å¸¸æ—¶ä¼šæ‰§è¡Œçš„ä»£ç </h5>
<ul>
<li>å¯ä»¥è®¿é—®åˆ°å¼‚å¸¸å¯¹è±¡ï¼Œ ä¸”å¯ä»¥æŒ‡å®šåœ¨å‡ºç°ç‰¹å®šå¼‚å¸¸æ—¶åœ¨æ‰§è¡Œé€šçŸ¥ä»£ç ã€‚</li>
<li>åªåœ¨è¿æ¥ç‚¹æŠ›å‡ºå¼‚å¸¸æ—¶æ‰æ‰§è¡Œå¼‚å¸¸é€šçŸ¥</li>
</ul>
<p>** å°† throwing å±æ€§æ·»åŠ åˆ° @AfterThrowing æ³¨è§£ä¸­, å¯ä»¥è®¿é—®è¿æ¥ç‚¹æŠ›å‡ºçš„å¼‚å¸¸ã€‚**</p>
<ul>
<li>Throwable æ˜¯æ‰€æœ‰é”™è¯¯å’Œå¼‚å¸¸ç±»çš„è¶…ç±»ã€‚æ‰€ä»¥åœ¨å¼‚å¸¸é€šçŸ¥æ–¹æ³•å¯ä»¥æ•è·åˆ°ä»»ä½•é”™è¯¯å’Œå¼‚å¸¸ã€‚</li>
<li>å¦‚æœåªå¯¹æŸç§ç‰¹æ®Šçš„å¼‚å¸¸ç±»å‹æ„Ÿå…´è¶£, ** å¯ä»¥å°†å‚æ•°å£°æ˜ä¸ºå…¶ä»–å¼‚å¸¸çš„å‚æ•°ç±»å‹. ç„¶åé€šçŸ¥å°±åªåœ¨æŠ›å‡ºè¿™ä¸ªç±»å‹åŠå…¶å­ç±»çš„å¼‚å¸¸æ—¶æ‰è¢«æ‰§è¡Œã€‚**</li>
<li>æ¯”å¦‚è®²ä¸‹é¢ç­¾åå‚æ•°çš„ Exception æ¢æˆ NullPointerException åªæœ‰å‘ç”Ÿäº† NullPointerException æ‰ä¼šæ‰§è¡Œã€‚</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@AfterThrowing</span>(value=<span class="string">"execution(public int spring.aop.*(..))"</span>,throwing=<span class="string">"e"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterThrowing</span><span class="params">(JoinPoint joinPoint, Exception e)</span></span>&#123;</span><br><span class="line">		String methodName = joinPoint.getSignature().getName();</span><br><span class="line">		System.out.println(<span class="string">"The method "</span> + methodName + <span class="string">" occurs excetionï¼š"</span> + e);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h5 id="ç¯ç»•é€šçŸ¥">ç¯ç»•é€šçŸ¥</h5>
<ul>
<li>ç¯ç»•é€šçŸ¥æ˜¯æ‰€æœ‰é€šçŸ¥ç±»å‹ä¸­åŠŸèƒ½æœ€ä¸ºå¼ºå¤§çš„, èƒ½å¤Ÿå…¨é¢åœ°æ§åˆ¶è¿æ¥ç‚¹ã€‚ ç”šè‡³å¯ä»¥æ§åˆ¶æ˜¯å¦æ‰§è¡Œè¿æ¥ç‚¹ã€‚</li>
<li>å¯¹äºç¯ç»•é€šçŸ¥æ¥è¯´, ** è¿æ¥ç‚¹çš„å‚æ•°ç±»å‹å¿…é¡»æ˜¯ ProceedingJoinPointã€‚** å®ƒæ˜¯ JoinPoint çš„å­æ¥å£, å…è®¸æ§åˆ¶ä½•æ—¶æ‰§è¡Œ, æ˜¯å¦æ‰§è¡Œè¿æ¥ç‚¹ã€‚</li>
<li>** åœ¨ç¯ç»•é€šçŸ¥ä¸­éœ€è¦æ˜ç¡®è°ƒç”¨ ProceedingJoinPoint çš„ proceed() æ–¹æ³•æ¥æ‰§è¡Œè¢«ä»£ç†çš„æ–¹æ³•ã€‚**</li>
<li>å¦‚æœå¿˜è®°è¿™æ ·åšå°±ä¼šå¯¼è‡´é€šçŸ¥è¢«æ‰§è¡Œäº†, ä½†ç›®æ ‡æ–¹æ³•æ²¡æœ‰è¢«æ‰§è¡Œã€‚</li>
</ul>
<p>** æ³¨æ„ï¼š ç¯ç»•é€šçŸ¥çš„æ–¹æ³•éœ€è¦è¿”å›ç›®æ ‡æ–¹æ³•æ‰§è¡Œä¹‹åçš„ç»“æœ, å³è°ƒç”¨ proceedingJoinPoint.proceed() çš„è¿”å›å€¼, å¦åˆ™ä¼šå‡ºç°ç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚**</p>
<ul>
<li>ç¯ç»•é€šçŸ¥éœ€è¦æºå¸¦ ProceedingJoinPoint ç±»å‹çš„å‚æ•°ã€‚</li>
<li>** ç¯ç»•é€šçŸ¥ç±»ä¼¼äºåŠ¨æ€ä»£ç†çš„å…¨è¿‡ç¨‹ï¼š ProceedingJoinPoint ç±»å‹çš„å‚æ•°å¯ä»¥å†³å®šæ˜¯å¦æ‰§è¡Œç›®æ ‡æ–¹æ³•ã€‚**</li>
<li>** ä¸”ç¯ç»•é€šçŸ¥å¿…é¡»æœ‰è¿”å›å€¼, è¿”å›å€¼å³ä¸ºç›®æ ‡æ–¹æ³•çš„è¿”å›å€¼ã€‚**</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Around</span>(value=<span class="string">"execution(public int spring.aop.*(..))"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">aroundMethod</span><span class="params">(ProceedingJoinPoint proceedingJoinPoint)</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	Object result = <span class="keyword">null</span>;</span><br><span class="line">	String methodName = pjd.getSignature().getName();</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">try</span> &#123;</span><br><span class="line">		<span class="comment">//å‰ç½®é€šçŸ¥</span></span><br><span class="line">		System.out.println(<span class="string">"The method "</span> + methodName + <span class="string">" begins with "</span> + Arrays.asList(pjd.getArgs()));</span><br><span class="line">		<span class="comment">//æ‰§è¡Œç›®æ ‡æ–¹æ³•</span></span><br><span class="line">		result = proceedingJoinPoint.proceed();</span><br><span class="line">		<span class="comment">//è¿”å›é€šçŸ¥</span></span><br><span class="line">		System.out.println(<span class="string">"The method "</span> + methodName + <span class="string">" ends with "</span> + result);</span><br><span class="line">	&#125; <span class="keyword">catch</span> (Throwable e) &#123;</span><br><span class="line">		<span class="comment">//å¼‚å¸¸é€šçŸ¥</span></span><br><span class="line">		System.out.println(<span class="string">"The method "</span> + methodName + <span class="string">" occurs exceptionï¼š"</span> + e);</span><br><span class="line">		<span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e);</span><br><span class="line">	&#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">		<span class="comment">//åç½®é€šçŸ¥</span></span><br><span class="line">		System.out.println(<span class="string">"The method "</span> + methodName + <span class="string">" ends"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h4 id="é‡ç”¨åˆ‡å…¥ç‚¹å®šä¹‰">é‡ç”¨åˆ‡å…¥ç‚¹å®šä¹‰</h4>
<ul>
<li>åœ¨ç¼–å†™ AspectJ åˆ‡é¢æ—¶, å¯ä»¥ç›´æ¥åœ¨é€šçŸ¥æ³¨è§£ä¸­ä¹¦å†™åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ã€‚ ä½†åŒä¸€ä¸ªåˆ‡ç‚¹è¡¨è¾¾å¼å¯èƒ½ä¼šåœ¨å¤šä¸ªé€šçŸ¥ä¸­é‡å¤å‡ºç°ã€‚</li>
<li>** åœ¨ AspectJ åˆ‡é¢ä¸­, å¯ä»¥é€šè¿‡ @Pointcut æ³¨è§£å°†ä¸€ä¸ªåˆ‡å…¥ç‚¹å£°æ˜æˆç®€å•çš„æ–¹æ³•ã€‚**</li>
<li>åˆ‡å…¥ç‚¹çš„æ–¹æ³•ä½“é€šå¸¸æ˜¯ç©ºçš„, å› ä¸ºå°†åˆ‡å…¥ç‚¹å®šä¹‰ä¸åº”ç”¨ç¨‹åºé€»è¾‘æ··åœ¨ä¸€èµ·æ˜¯ä¸åˆç†çš„ã€‚</li>
<li>åˆ‡å…¥ç‚¹æ–¹æ³•çš„è®¿é—®æ§åˆ¶ç¬¦åŒæ—¶ä¹Ÿæ§åˆ¶ç€è¿™ä¸ªåˆ‡å…¥ç‚¹çš„å¯è§æ€§ã€‚</li>
<li>å¦‚æœåˆ‡å…¥ç‚¹è¦åœ¨å¤šä¸ªåˆ‡é¢ä¸­å…±ç”¨, æœ€å¥½å°†å®ƒä»¬é›†ä¸­åœ¨ä¸€ä¸ªå…¬å…±çš„ç±»ä¸­. åœ¨è¿™ç§æƒ…å†µä¸‹, å®ƒä»¬å¿…é¡»è¢«å£°æ˜ä¸º publicã€‚</li>
<li>** åœ¨å¼•å…¥è¿™ä¸ªåˆ‡å…¥ç‚¹æ—¶, å¿…é¡»å°†ç±»åä¹ŸåŒ…æ‹¬åœ¨å†…ã€‚** å¦‚æœç±»æ²¡æœ‰ä¸è¿™ä¸ªåˆ‡é¢æ”¾åœ¨åŒä¸€ä¸ªåŒ…ä¸­, è¿˜å¿…é¡»åŒ…å«åŒ…åã€‚</li>
<li>** å…¶ä»–é€šçŸ¥å¯ä»¥é€šè¿‡æ–¹æ³•åç§°å¼•å…¥è¯¥åˆ‡å…¥ç‚¹ã€‚**</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* å®šä¹‰ä¸€ä¸ªæ–¹æ³•, ç”¨äºå£°æ˜åˆ‡å…¥ç‚¹è¡¨è¾¾å¼. ä¸€èˆ¬åœ°, è¯¥æ–¹æ³•ä¸­å†ä¸éœ€è¦æ·»å…¥å…¶ä»–çš„ä»£ç . </span></span><br><span class="line"><span class="comment">* ä½¿ç”¨ <span class="doctag">@Pointcut</span> æ¥å£°æ˜åˆ‡å…¥ç‚¹è¡¨è¾¾å¼. </span></span><br><span class="line"><span class="comment">* åé¢çš„å…¶ä»–é€šçŸ¥ç›´æ¥ä½¿ç”¨æ–¹æ³•åæ¥å¼•ç”¨å½“å‰çš„åˆ‡å…¥ç‚¹è¡¨è¾¾å¼. </span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Pointcut</span>(<span class="string">"execution(public int spring.aop.Calculator.*(..))"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">declareJointPointExpression</span><span class="params">()</span></span>&#123;&#125;</span><br></pre></td></tr></table></figure>
<hr>
<p>** å¼•å…¥é€šçŸ¥ï¼ˆå¾ˆå°‘ä½¿ç”¨ï¼‰**</p>
<ul>
<li>å¼•å…¥é€šçŸ¥æ˜¯ä¸€ç§ç‰¹æ®Šçš„é€šçŸ¥ç±»å‹.</li>
<li>å®ƒé€šè¿‡ä¸ºæ¥å£æä¾›å®ç°ç±», å…è®¸å¯¹è±¡åŠ¨æ€åœ°å®ç°æ¥å£, å°±åƒå¯¹è±¡å·²ç»åœ¨è¿è¡Œæ—¶æ‰©å±•äº†å®ç°ç±»ä¸€æ ·.</li>
</ul>
<hr>
<h2 id="ç”¨åŸºäº-xml-çš„é…ç½®å£°æ˜åˆ‡é¢">ç”¨åŸºäº XML çš„é…ç½®å£°æ˜åˆ‡é¢</h2>
<ul>
<li>é™¤äº†ä½¿ç”¨ AspectJ æ³¨è§£å£°æ˜åˆ‡é¢, Spring ä¹Ÿæ”¯æŒåœ¨ Bean é…ç½®æ–‡ä»¶ä¸­å£°æ˜åˆ‡é¢ã€‚</li>
<li>è¿™ç§å£°æ˜æ˜¯é€šè¿‡ aop schema ä¸­çš„ XML å…ƒç´ å®Œæˆçš„ã€‚</li>
</ul>
<hr>
<p>** æ­£å¸¸æƒ…å†µä¸‹, åŸºäºæ³¨è§£çš„å£°æ˜è¦ä¼˜å…ˆäºåŸºäº XML çš„å£°æ˜ã€‚**</p>
<ul>
<li>é€šè¿‡ AspectJ æ³¨è§£, åˆ‡é¢å¯ä»¥ä¸ AspectJ å…¼å®¹, ** åŸºäº XML çš„é…ç½®åˆ™æ˜¯ Spring ä¸“æœ‰çš„ã€‚**</li>
<li>ç”±äº AspectJ å¾—åˆ°è¶Šæ¥è¶Šå¤šçš„ AOP æ¡†æ¶æ”¯æŒ, æ‰€ä»¥ä»¥æ³¨è§£é£æ ¼ç¼–å†™çš„åˆ‡é¢å°†ä¼šæœ‰æ›´å¤šé‡ç”¨çš„æœºä¼šã€‚</li>
</ul>
<hr>
<p>** åŸºäº XMLï¼šå£°æ˜åˆ‡é¢ **</p>
<ul>
<li>å½“ä½¿ç”¨ XML å£°æ˜åˆ‡é¢æ—¶, éœ€è¦åœ¨ <beans>  æ ¹å…ƒç´ ä¸­å¯¼å…¥ aopï¼šSchema</beans></li>
<li>åœ¨ Bean é…ç½®æ–‡ä»¶ä¸­, æ‰€æœ‰çš„ Spring AOP é…ç½®éƒ½å¿…é¡»å®šä¹‰åœ¨ &lt;aopï¼šconfig&gt; å…ƒç´ å†…éƒ¨ã€‚</li>
<li>å¯¹äºæ¯ä¸ªåˆ‡é¢è€Œè¨€, éƒ½è¦åˆ›å»ºä¸€ä¸ª &lt;aopï¼šaspect&gt; å…ƒç´ æ¥ä¸ºå…·ä½“çš„åˆ‡é¢å®ç°å¼•ç”¨åç«¯ Bean å®ä¾‹ã€‚</li>
<li>åˆ‡é¢ Bean å¿…é¡»æœ‰ä¸€ä¸ª id æ ‡ç¤ºç¬¦, ä¾› &lt;aopï¼šaspect&gt; å…ƒç´ å¼•ç”¨</li>
</ul>
<hr>
<p>** åŸºäº XMLï¼šå£°æ˜åˆ‡å…¥ç‚¹ **</p>
<ul>
<li>åˆ‡å…¥ç‚¹ä½¿ç”¨ &lt;aopï¼špointcut&gt; å…ƒç´ å£°æ˜</li>
<li>åˆ‡å…¥ç‚¹å¿…é¡»å®šä¹‰åœ¨
<ul>
<li>1ã€&lt;aopï¼šaspect&gt; å…ƒç´ ä¸‹ â€”â€”&gt; å®šä¹‰åœ¨ &lt;aopï¼šaspect&gt; å…ƒç´ ä¸‹ï¼š åªå¯¹å½“å‰åˆ‡é¢æœ‰æ•ˆã€‚</li>
<li>2ã€&lt;aopï¼šconfig&gt; å…ƒç´ ä¸‹ â€”â€”&gt; å®šä¹‰åœ¨ &lt;aopï¼šconfig&gt; å…ƒç´ ä¸‹ï¼š å¯¹æ‰€æœ‰åˆ‡é¢éƒ½æœ‰æ•ˆã€‚</li>
</ul>
</li>
<li>** åŸºäº XML çš„ AOP é…ç½®ä¸å…è®¸åœ¨åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ä¸­ç”¨åç§°å¼•ç”¨å…¶ä»–åˆ‡å…¥ç‚¹ã€‚**</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- é…ç½® bean --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"Calculator"</span> <span class="attr">class</span>=<span class="string">"spring.aop.xml.CalculatorImpl"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- é…ç½®åˆ‡é¢çš„ bean. --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"loggingAspect"</span> <span class="attr">class</span>=<span class="string">"spring.aop.xml.LoggingAspect"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"vlidationAspect"</span> <span class="attr">class</span>=<span class="string">"spring.aop.xml.VlidationAspect"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- é…ç½® AOP --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aopï¼šconfig</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- é…ç½®åˆ‡ç‚¹è¡¨è¾¾å¼ --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">aopï¼špointcut</span> <span class="attr">expression</span>=<span class="string">"execution(* spring.aop.xml.Calculator.*(int, int))"</span> <span class="attr">id</span>=<span class="string">"pointcut"</span>/&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- é…ç½®åˆ‡é¢åŠé€šçŸ¥ --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">aopï¼šaspect</span> <span class="attr">ref</span>=<span class="string">"loggingAspect"</span> <span class="attr">order</span>=<span class="string">"2"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">aopï¼šbefore</span> <span class="attr">method</span>=<span class="string">"beforeMethod"</span> <span class="attr">pointcut-ref</span>=<span class="string">"pointcut"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">aopï¼šafter</span> <span class="attr">method</span>=<span class="string">"afterMethod"</span> <span class="attr">pointcut-ref</span>=<span class="string">"pointcut"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">aopï¼šafter-throwing</span> <span class="attr">method</span>=<span class="string">"afterThrowing"</span> <span class="attr">pointcut-ref</span>=<span class="string">"pointcut"</span> <span class="attr">throwing</span>=<span class="string">"e"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">aopï¼šafter-returning</span> <span class="attr">method</span>=<span class="string">"afterReturning"</span> <span class="attr">pointcut-ref</span>=<span class="string">"pointcut"</span> <span class="attr">returning</span>=<span class="string">"result"</span>/&gt;</span></span><br><span class="line">		<span class="comment">&lt;!--  </span></span><br><span class="line"><span class="comment">		&lt;aopï¼šaround method="aroundMethod" pointcut-ref="pointcut"/&gt;</span></span><br><span class="line"><span class="comment">		--&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">aopï¼šaspect</span>&gt;</span>	</span><br><span class="line">	<span class="tag">&lt;<span class="name">aopï¼šaspect</span> <span class="attr">ref</span>=<span class="string">"vlidationAspect"</span> <span class="attr">order</span>=<span class="string">"1"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">aopï¼šbefore</span> <span class="attr">method</span>=<span class="string">"validateArgs"</span> <span class="attr">pointcut-ref</span>=<span class="string">"pointcut"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">aopï¼šaspect</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aopï¼šconfig</span>&gt;</span></span><br></pre></td></tr></table></figure>
<hr>
<img src="https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1551442650328&di=78dfb03450cc5fff5d31ea92de81ba1f&imgtype=0&src=http%3A%2F%2Fimg.mp.itc.cn%2Fupload%2F20160719%2F6ea36d17d5e94124ad1791eadd923554_th.jpg" width="150">
<h1 id="spring-ä¸­çš„äº‹åŠ¡ç®¡ç†">Spring ä¸­çš„äº‹åŠ¡ç®¡ç†</h1>
<p>** Spring æ—¢æ”¯æŒç¼–ç¨‹å¼äº‹åŠ¡ç®¡ç†, ä¹Ÿæ”¯æŒå£°æ˜å¼çš„äº‹åŠ¡ç®¡ç† **</p>
<p>1ã€ç¼–ç¨‹å¼äº‹åŠ¡ç®¡ç†ï¼šå°†äº‹åŠ¡ç®¡ç†ä»£ç åµŒå…¥åˆ°ä¸šåŠ¡æ–¹æ³•ä¸­æ¥æ§åˆ¶äº‹åŠ¡çš„æäº¤å’Œå›æ»šã€‚å¿…é¡»åœ¨æ¯ä¸ªäº‹åŠ¡æ“ä½œä¸­åŒ…å«é¢å¤–çš„äº‹åŠ¡ç®¡ç†ä»£ç ã€‚<br>
2ã€<strong>å£°æ˜å¼äº‹åŠ¡ç®¡ç†</strong>ï¼šå¤§å¤šæ•°æƒ…å†µä¸‹æ¯”ç¼–ç¨‹å¼äº‹åŠ¡ç®¡ç†æ›´å¥½ç”¨ã€‚å®ƒå°†äº‹åŠ¡ç®¡ç†ä»£ç ä»ä¸šåŠ¡æ–¹æ³•ä¸­åˆ†ç¦»å‡ºæ¥, ä»¥å£°æ˜çš„æ–¹å¼æ¥å®ç°äº‹åŠ¡ç®¡ç†ã€‚</p>
<blockquote>
<p>** äº‹åŠ¡ç®¡ç†ä½œä¸ºä¸€ç§æ¨ªåˆ‡å…³æ³¨ç‚¹, å¯ä»¥é€šè¿‡ AOP æ–¹æ³•æ¨¡å—åŒ–ã€‚ Spring é€šè¿‡ Spring AOP æ¡†æ¶æ”¯æŒå£°æ˜å¼äº‹åŠ¡ç®¡ç†ã€‚**</p>
</blockquote>
<ul>
<li>Spring ä»ä¸åŒçš„äº‹åŠ¡ç®¡ç† API ä¸­æŠ½è±¡äº†ä¸€æ•´å¥—çš„äº‹åŠ¡æœºåˆ¶ã€‚ å¼€å‘äººå‘˜ä¸å¿…äº†è§£åº•å±‚çš„äº‹åŠ¡ API, å°±å¯ä»¥åˆ©ç”¨è¿™äº›äº‹åŠ¡æœºåˆ¶ã€‚</li>
<li>æœ‰äº†è¿™äº›äº‹åŠ¡æœºåˆ¶, äº‹åŠ¡ç®¡ç†ä»£ç å°±èƒ½ç‹¬ç«‹äºç‰¹å®šçš„äº‹åŠ¡æŠ€æœ¯äº†ã€‚</li>
</ul>
<h2 id="ç”¨-transactional-æ³¨è§£-å£°æ˜å¼åœ°ç®¡ç†äº‹åŠ¡">ç”¨ @Transactional æ³¨è§£ å£°æ˜å¼åœ°ç®¡ç†äº‹åŠ¡</h2>
<p>1ã€** é…ç½®ä»¥ä¸‹ä¿¡æ¯ **</p>
<ul>
<li>** æ·»åŠ &lt;txï¼š&gt; å‘½åç©ºé—´ **</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 1ã€ é…ç½®äº‹åŠ¡ç®¡ç†å™¨ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"transactionManager"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DataSourceTransactionManager"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 2ã€æ³¨è§£é©±åŠ¨ å¯ç”¨äº‹åŠ¡æ³¨è§£ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">txï¼šannotation-driven</span> <span class="attr">transaction-manager</span>=<span class="string">"transactionManager"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<p>2ã€** åœ¨ç›¸åº”çš„æ–¹æ³•ä¸Šç”¨ @Transactional æ³¨è§£æ ‡æ³¨ **</p>
<hr>
<h2 id="ç”¨-xml-äº‹åŠ¡é€šçŸ¥-å£°æ˜å¼åœ°ç®¡ç†äº‹åŠ¡">ç”¨ XML äº‹åŠ¡é€šçŸ¥ å£°æ˜å¼åœ°ç®¡ç†äº‹åŠ¡</h2>
<p>** äº‹åŠ¡ç®¡ç†æ˜¯ä¸€ç§æ¨ªåˆ‡å…³æ³¨ç‚¹ **</p>
<blockquote>
<p>1ã€æ·»åŠ &lt;txï¼š&gt; å‘½åç©ºé—´	<br>
2ã€é…ç½®äº‹åŠ¡ç®¡ç†å™¨ transactionManager <code>hibernateTransactionManager mybatisTransactionManager</code><br>
3ã€é…ç½®å…ƒç´ å£°æ˜äº‹åŠ¡é€šçŸ¥ &lt;txï¼šadvice&gt;&lt;/txï¼šadvice&gt;<br>
4ã€é…ç½®äº‹åŠ¡åˆ‡å…¥ç‚¹ &lt;aopï¼šconfig&gt;<br>
5ã€åœ¨ &lt;aopï¼šconfig&gt; ä¸­é…ç½® &lt;aopï¼špointcut&gt; è¡¨è¾¾å¼<br>
6ã€åœ¨ &lt;aopï¼šconfig&gt; ä¸­å£°æ˜ä¸€ä¸ªå¢å¼ºå™¨é€šçŸ¥ä¸åˆ‡å…¥ç‚¹å…³è”èµ·æ¥<br>
&lt;aopï¼šadvisor advice-ref=â€œtxAdviceâ€ pointcut-ref=â€œtxPointCutâ€/&gt;</p>
</blockquote>
<p>** ç”±äº Spring AOP æ˜¯åŸºäºä»£ç†çš„æ–¹æ³•, æ‰€ä»¥åªèƒ½å¢å¼ºå…¬å…±æ–¹æ³•ã€‚å› æ­¤, åªæœ‰å…¬æœ‰æ–¹æ³•æ‰èƒ½é€šè¿‡ Spring AOP è¿›è¡Œäº‹åŠ¡ç®¡ç†ã€‚**</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 1. é…ç½®äº‹åŠ¡ç®¡ç†å™¨ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"transactionManager"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DataSourceTransactionManager"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 2. é…ç½®äº‹åŠ¡å±æ€§ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tx:advice</span> <span class="attr">id</span>=<span class="string">"txAdvice"</span> <span class="attr">transaction-manager</span>=<span class="string">"transactionManager"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- æ ¹æ®æ–¹æ³•åæŒ‡å®šäº‹åŠ¡çš„å±æ€§ ä¼ æ’­è¡Œä¸º --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"purchase"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRES_NEW"</span> <span class="attr">isolation</span>=<span class="string">"READ-COMMITTED"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"get*"</span> <span class="attr">read-only</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"find*"</span> <span class="attr">read-only</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tx:advice</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 3. é…ç½®äº‹åŠ¡åˆ‡å…¥ç‚¹, ä»¥åŠæŠŠäº‹åŠ¡åˆ‡å…¥ç‚¹å’Œäº‹åŠ¡å±æ€§å…³è”èµ·æ¥ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">expression</span>=<span class="string">"execution(* spring.tx.xml.service.*.*(..))"</span> <span class="attr">id</span>=<span class="string">"txPointCut"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">"txAdvice"</span> <span class="attr">pointcut-ref</span>=<span class="string">"txPointCut"</span>/&gt;</span>	</span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="äº‹åŠ¡ä¼ æ’­è¡Œä¸º-propagation-behavior">äº‹åŠ¡ä¼ æ’­è¡Œä¸º (propagation behavior)</h2>
<p>** å½“äº‹åŠ¡æ–¹æ³•è¢«å¦ä¸€ä¸ªäº‹åŠ¡æ–¹æ³•è°ƒç”¨æ—¶, å¿…é¡»æŒ‡å®šäº‹åŠ¡åº”è¯¥å¦‚ä½•ä¼ æ’­ **<br>
ä¾‹å¦‚ï¼š æ–¹æ³•å¯èƒ½ç»§ç»­åœ¨ç°æœ‰äº‹åŠ¡ä¸­è¿è¡Œ, ä¹Ÿå¯èƒ½å¼€å¯ä¸€ä¸ªæ–°äº‹åŠ¡, å¹¶åœ¨è‡ªå·±çš„äº‹åŠ¡ä¸­è¿è¡Œã€‚</p>
<p>** äº‹åŠ¡ä¼ æ’­å±æ€§å¯ä»¥åœ¨ @Transactional æ³¨è§£çš„ propagation å±æ€§ä¸­å®šä¹‰ (PROPAGATION_REQUIRED) é»˜è®¤ä¼ æ’­è¡Œä¸º **</p>
<hr>
<p>** äº‹åŠ¡çš„ä¼ æ’­è¡Œä¸ºå¯ä»¥ç”±ä¼ æ’­å±æ€§æŒ‡å®šã€‚ Spring å®šä¹‰äº† 7  ç§ç±»ä¼ æ’­è¡Œä¸º **</p>
<table>
<thead>
<tr>
<th>äº‹åŠ¡ä¼ æ’­è¡Œä¸ºç±»å‹</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>PROPAGATION_REQUIRED</strong> (é»˜è®¤)</td>
<td>å¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œå°±æ–°å»ºä¸€ä¸ªäº‹åŠ¡ï¼Œå¦‚æœå·²ç»å­˜åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­ï¼ŒåŠ å…¥åˆ°è¿™ä¸ªäº‹åŠ¡ä¸­ã€‚</td>
</tr>
<tr>
<td>PROPAGATION_SUPPORTS</td>
<td>æ”¯æŒå½“å‰äº‹åŠ¡ï¼Œå¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œå°±ä»¥éäº‹åŠ¡æ–¹å¼æ‰§è¡Œã€‚</td>
</tr>
<tr>
<td>PROPAGATION_MANDATORY</td>
<td>ä½¿ç”¨å½“å‰çš„äº‹åŠ¡ï¼Œå¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œå°±æŠ›å‡ºå¼‚å¸¸ã€‚</td>
</tr>
<tr>
<td><strong>PROPAGATION_REQUIRES_NEW</strong></td>
<td>æ–°å»ºäº‹åŠ¡ï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼ŒæŠŠå½“å‰äº‹åŠ¡æŒ‚èµ·ã€‚</td>
</tr>
<tr>
<td>PROPAGATION_NOT_SUPPORTED</td>
<td>ä»¥éäº‹åŠ¡æ–¹å¼æ‰§è¡Œæ“ä½œï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œå°±æŠŠå½“å‰äº‹åŠ¡æŒ‚èµ·ã€‚</td>
</tr>
<tr>
<td>PROPAGATION_NEVER</td>
<td>ä»¥éäº‹åŠ¡æ–¹å¼æ‰§è¡Œï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ã€‚</td>
</tr>
<tr>
<td>PROPAGATION_NESTED</td>
<td>å¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™åœ¨åµŒå¥—äº‹åŠ¡å†…æ‰§è¡Œã€‚å¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œåˆ™æ‰§è¡Œä¸PROPAGATION_REQUIREDç±»ä¼¼çš„æ“ä½œã€‚</td>
</tr>
</tbody>
</table>
<blockquote>
<p>** REQUIRED ä¼ æ’­è¡Œä¸º **</p>
</blockquote>
<ul>
<li>å¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œå°±æ–°å»ºä¸€ä¸ªäº‹åŠ¡ï¼Œå¦‚æœå·²ç»å­˜åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­ï¼ŒåŠ å…¥åˆ°è¿™ä¸ªäº‹åŠ¡ä¸­ã€‚</li>
</ul>
<img src="http://ww1.sinaimg.cn/large/006vWPzFly1g1geuy4y6tj30qy0890t6.jpg" width="700">
<hr>
<blockquote>
<p>** REQUIRES_NEW ä¼ æ’­è¡Œä¸º **</p>
</blockquote>
<ul>
<li>å®ƒè¡¨ç¤ºè¯¥æ–¹æ³•å¿…é¡»å¯åŠ¨ä¸€ä¸ªæ–°äº‹åŠ¡, å¹¶åœ¨è‡ªå·±çš„äº‹åŠ¡å†…è¿è¡Œã€‚ å¦‚æœæœ‰äº‹åŠ¡åœ¨è¿è¡Œ, å°±åº”è¯¥å…ˆæŒ‚èµ·å®ƒã€‚</li>
</ul>
<img src="http://ww1.sinaimg.cn/large/006vWPzFly1g1gesufobfj30q90a0dgw.jpg" width="700">
<h3 id="å¹¶å‘äº‹åŠ¡æ‰€å¯¼è‡´çš„é—®é¢˜">å¹¶å‘äº‹åŠ¡æ‰€å¯¼è‡´çš„é—®é¢˜</h3>
<ul>
<li>å½“åŒä¸€ä¸ªåº”ç”¨ç¨‹åºæˆ–è€…ä¸åŒåº”ç”¨ç¨‹åºä¸­çš„å¤šä¸ªäº‹åŠ¡åœ¨åŒä¸€ä¸ªæ•°æ®é›†ä¸Šå¹¶å‘æ‰§è¡Œæ—¶, å¦‚æœæ²¡æœ‰é‡‡å–å¿…è¦çš„éš”ç¦»æœºåˆ¶,å¯èƒ½ä¼šå‡ºç°è®¸å¤šæ„å¤–çš„é—®é¢˜</li>
</ul>
<p>** å¹¶å‘äº‹åŠ¡æ‰€å¯¼è‡´çš„é—®é¢˜å¯ä»¥åˆ†ä¸ºä¸‹é¢ä¸‰ç§ç±»å‹ï¼š**</p>
<ul>
<li>** è„è¯»ï¼š** å¯¹äºä¸¤ä¸ªäº‹åŠ¡ T1, T2, T1 è¯»å–äº†å·²ç»è¢« T2 æ›´æ–°ä½†è¿˜æ²¡æœ‰è¢«æäº¤çš„å­—æ®µ. ä¹‹å, è‹¥ T2 å›æ»š, T1è¯»å–çš„å†…å®¹å°±æ˜¯ä¸´æ—¶ä¸”æ— æ•ˆçš„ã€‚</li>
<li>** ä¸å¯é‡å¤è¯»ï¼š** å¯¹äºä¸¤ä¸ªäº‹åŠ¡ T1, T2, T1 è¯»å–äº†ä¸€ä¸ªå­—æ®µ, ç„¶å T2 æ›´æ–°äº†è¯¥å­—æ®µ. ä¹‹å, T1å†æ¬¡è¯»å–åŒä¸€ä¸ªå­—æ®µ, å€¼å°±ä¸åŒäº†ã€‚</li>
<li>** å¹»è¯»ï¼š ** å¯¹äºä¸¤ä¸ªäº‹åŠ¡ T1, T2, T1 ä»ä¸€ä¸ªè¡¨ä¸­è¯»å–äº†ä¸€ä¸ªå­—æ®µ, ç„¶å T2 åœ¨è¯¥è¡¨ä¸­æ’å…¥äº†ä¸€äº›æ–°çš„è¡Œ. ä¹‹å, å¦‚æœ T1 å†æ¬¡è¯»å–åŒä¸€ä¸ªè¡¨, å°±ä¼šå¤šå‡ºå‡ è¡Œã€‚</li>
</ul>
<hr>
<h2 id="äº‹åŠ¡çš„éš”ç¦»çº§åˆ«-isolation-level">äº‹åŠ¡çš„éš”ç¦»çº§åˆ« (Isolation level)</h2>
<p>** Spring æ”¯æŒçš„äº‹åŠ¡éš”ç¦»çº§åˆ« **<br>
** äº‹åŠ¡çš„éš”ç¦»çº§åˆ«è¦å¾—åˆ°åº•å±‚æ•°æ®åº“å¼•æ“çš„æ”¯æŒ, è€Œä¸æ˜¯åº”ç”¨ç¨‹åºæˆ–è€…æ¡†æ¶çš„æ”¯æŒã€‚**</p>
<table>
<thead>
<tr>
<th style="text-align:left">äº‹åŠ¡éš”ç¦»çº§åˆ«</th>
<th style="text-align:left">è„è¯»</th>
<th style="text-align:center">ä¸å¯é‡å¤è¯»</th>
<th style="text-align:left">å¹»è¯»</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">READ-UNCOMMITTED (è¯»æœªæäº¤)</td>
<td style="text-align:left">æ˜¯</td>
<td style="text-align:center">æ˜¯</td>
<td style="text-align:left">æ˜¯</td>
</tr>
<tr>
<td style="text-align:left">** READ-COMMITTED (è¯»å·²æäº¤æ•°æ®)**</td>
<td style="text-align:left">å¦</td>
<td style="text-align:center">æ˜¯</td>
<td style="text-align:left">æ˜¯</td>
</tr>
<tr>
<td style="text-align:left">REPEATABLE-READ (å¯é‡å¤è¯»)</td>
<td style="text-align:left">å¦</td>
<td style="text-align:center">å¦</td>
<td style="text-align:left">æ˜¯</td>
</tr>
<tr>
<td style="text-align:left">SERIALIZABLE (ä¸²è¡ŒåŒ–å¦)</td>
<td style="text-align:left">å¦</td>
<td style="text-align:center">å¦</td>
<td style="text-align:left">å¦</td>
</tr>
</tbody>
</table>
<hr>
<blockquote>
<p>** è®¾ç½®éš”ç¦»äº‹åŠ¡å±æ€§ **</p>
</blockquote>
<ul>
<li>ç”¨ @Transactional æ³¨è§£å£°æ˜å¼åœ°ç®¡ç†äº‹åŠ¡æ—¶å¯ä»¥åœ¨ @Transactional çš„ <code>isolation</code> å±æ€§ä¸­è®¾ç½®éš”ç¦»çº§åˆ«ã€‚</li>
<li>ç”¨ äº‹åŠ¡é€šçŸ¥ å£°æ˜å¼åœ°ç®¡ç†äº‹åŠ¡æ—¶å¯ä»¥åœ¨ &lt;txï¼šadvice&gt;&lt;txï¼šattributes&gt;&lt;txï¼šmethod isolation=&quot; &quot;&gt; å…ƒç´ ä¸­æŒ‡å®šéš”ç¦»çº§åˆ«ã€‚</li>
</ul>
<hr>
<h2 id="è®¾ç½®å›æ»šäº‹åŠ¡å±æ€§-rollback">è®¾ç½®å›æ»šäº‹åŠ¡å±æ€§ (rollback)</h2>
<p>** é»˜è®¤æƒ…å†µä¸‹åªæœ‰æœªæ£€æŸ¥å¼‚å¸¸(RuntimeExceptionå’ŒErrorç±»å‹çš„å¼‚å¸¸)ä¼šå¯¼è‡´äº‹åŠ¡å›æ»šã€‚è€Œå—æ£€æŸ¥å¼‚å¸¸ä¸ä¼šã€‚**</p>
<blockquote>
<p>æ³¨è§£å£°æ˜å¼åœ°ç®¡ç†äº‹åŠ¡ äº‹åŠ¡çš„å›æ»šè§„åˆ™å¯ä»¥é€šè¿‡ @Transactional æ³¨è§£çš„ <code>rollbackFor å’Œ noRollbackFor</code> å±æ€§æ¥å®šä¹‰ã€‚</p>
</blockquote>
<ul>
<li>è¿™ä¸¤ä¸ªå±æ€§è¢«å£°æ˜ä¸º Class[] ç±»å‹çš„, å› æ­¤å¯ä»¥ä¸ºè¿™ä¸¤ä¸ªå±æ€§æŒ‡å®šå¤šä¸ªå¼‚å¸¸ç±»ã€‚</li>
</ul>
<blockquote>
<p>äº‹åŠ¡é€šçŸ¥ å£°æ˜å¼åœ°ç®¡ç†äº‹åŠ¡æ—¶å¯ä»¥åœ¨ &lt;txï¼šadvice&gt;&lt;txï¼šattributes&gt;&lt;txï¼šmethod rollbackFor=&quot; &quot;&gt; å…ƒç´ ä¸­æŒ‡å®šå›æ»šè§„åˆ™ã€‚</p>
</blockquote>
<ul>
<li>å¦‚æœæœ‰ä¸æ­¢ä¸€ç§å¼‚å¸¸, ç”¨é€—å·åˆ†éš”ã€‚</li>
</ul>
<h2 id="è¶…æ—¶å’Œåªè¯»å±æ€§-timeout-read-only">è¶…æ—¶å’Œåªè¯»å±æ€§ (timeout read-only)</h2>
<p>** ç”±äºäº‹åŠ¡å¯ä»¥åœ¨è¡Œå’Œè¡¨ä¸Šè·å¾—é”,å› æ­¤é•¿äº‹åŠ¡ä¼šå ç”¨èµ„æº, å¹¶å¯¹æ•´ä½“æ€§èƒ½äº§ç”Ÿå½±å“ã€‚**</p>
<blockquote>
<p>å¦‚æœä¸€ä¸ªäº‹ç‰©åªè¯»å–æ•°æ®ä½†ä¸åšä¿®æ”¹, æ•°æ®åº“å¼•æ“å¯ä»¥å¯¹è¿™ä¸ªäº‹åŠ¡è¿›è¡Œä¼˜åŒ–ã€‚</p>
</blockquote>
<ul>
<li>** è¶…æ—¶äº‹åŠ¡å±æ€§ï¼š** äº‹åŠ¡åœ¨å¼ºåˆ¶å›æ»šä¹‹å‰å¯ä»¥ä¿æŒå¤šä¹…. è¿™æ ·å¯ä»¥é˜²æ­¢é•¿æœŸè¿è¡Œçš„äº‹åŠ¡å ç”¨èµ„æºã€‚</li>
<li>** åªè¯»äº‹åŠ¡å±æ€§ï¼š** è¡¨ç¤ºè¿™ä¸ªäº‹åŠ¡åªè¯»å–æ•°æ®ä½†ä¸æ›´æ–°æ•°æ®, è¿™æ ·å¯ä»¥å¸®åŠ©æ•°æ®åº“å¼•æ“ä¼˜åŒ–äº‹åŠ¡ã€‚</li>
</ul>
<blockquote>
<p>ç”¨ @Transactional æ³¨è§£å£°æ˜å¼åœ°ç®¡ç†äº‹åŠ¡æ—¶å¯ä»¥åœ¨ @Transactional çš„ <code>read-only timeout</code>(ç§’çº§åˆ«) å±æ€§ä¸­è®¾ç½®ã€‚<br>
ç”¨ äº‹åŠ¡é€šçŸ¥ å£°æ˜å¼åœ°ç®¡ç†äº‹åŠ¡æ—¶å¯ä»¥åœ¨&lt;txï¼šadvice&gt;&lt;txï¼šattributes&gt;&lt;txï¼šmethod read-only=&quot;&quot; timeout=&quot;&quot;&gt;å…ƒç´ ä¸­æŒ‡å®šã€‚</p>
</blockquote>
<h6 id="webé¡¹ç›®-webxml-é…ç½®å¯åŠ¨-spring-ioc-å®¹å™¨çš„-listener">webé¡¹ç›® web.xml é…ç½®å¯åŠ¨ Spring IOC å®¹å™¨çš„ Listener</h6>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- é…ç½®å¯åŠ¨ Spring IOC å®¹å™¨çš„ Listener --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- needed for ContextLoaderListener --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:applicationcontext.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- Bootstraps the root web application context before servlet initialization --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">listener</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>org.springframework.web.context.ContextLoaderListener<span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">listener</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springDispatcherServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:springmvc.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springDispatcherServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="jdbctemplate-ç®€ä»‹">JdbcTemplate ç®€ä»‹</h1>
<p>** ä¸ºäº†ä½¿ JDBC æ›´åŠ æ˜“äºä½¿ç”¨, Spring åœ¨ JDBC API ä¸Šå®šä¹‰äº†ä¸€ä¸ªæŠ½è±¡å±‚, ä»¥æ­¤å»ºç«‹ä¸€ä¸ª JDBC å­˜å–æ¡†æ¶ã€‚ **</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- é…ç½® Spirng çš„ JdbcTemplate --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"jdbcTemplate"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.core.JdbcTemplate"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>ä½¿ç”¨ SQL ä¸­åˆ—çš„åˆ«åå®Œæˆåˆ—åå’Œç±»çš„å±æ€§åçš„æ˜ å°„ã€‚ ä¾‹å¦‚ last_name lastName</li>
<li>ä¸æ”¯æŒçº§è”å±æ€§ JdbcTemplate æ˜¯ä¸€ä¸ª JDBC çš„å°å·¥å…·, è€Œä¸æ˜¯ ORM æ¡†æ¶ã€‚</li>
</ul>
<h1 id="æ„Ÿè°¢é˜…è¯»">æ„Ÿè°¢é˜…è¯»</h1>

                

                <hr>
                <!-- Pager -->
                <ul class="pager">
                    
                        <li class="previous">
                            <a href="/article/Hibernate/" data-toggle="tooltip" data-placement="top" title="Hibernate">&larr; Previous Post</a>
                        </li>
                    
                    
                        <li class="next">
                            <a href="/article/JDBC/" data-toggle="tooltip" data-placement="top" title="Java DataBase Connectivity">Next Post &rarr;</a>
                        </li>
                    
                </ul>

                <br>

                <!--æ‰“èµ-->
                
                    <div class="reward">
                        <div class="reward-button">èµ <span class="reward-code"> 
                            <span class="alipay-code"> <img class="alipay-img" src="http://ww1.sinaimg.cn/large/006vWPzFly1g0o77ru34uj30dz0drdhv.jpg"><b>æ”¯ä»˜å®æ‰“èµ</b></span> 
                            <span class="wechat-code"> <img class="wechat-img" src="http://ww1.sinaimg.cn/large/006vWPzFly1g0o740lhb9j30rb0ov77z.jpg"><b>å¾®ä¿¡æ‰“èµ</b> </span>
                            </span></div>
                        <p class="reward-notice">èµèµä¸€ä¸‹</p>
                    </div>
                
                <!--æ‰“èµ-->

                <br>
                <!--åˆ†äº«-->
                
                <!--åˆ†äº«-->
                <br>                       
                
                <!-- require APlayer -->
                

                <!-- duoshuo Share start -->
                
                <!-- å¤šè¯´ Share end-->

                <!-- å¤šè¯´è¯„è®ºæ¡† start -->
                
                <!-- å¤šè¯´è¯„è®ºæ¡† end -->

                <!-- disqus comment start -->
                
                <!-- disqus comment end -->

                

            </div>
            
            <!-- Tabe of Content -->
            <!-- Table of Contents -->

  
    <style>
      span.toc-nav-number{
        display: none
      }
    </style>
  
    
      <aside id="sidebar">
        <div id="toc" class="toc-article">
        <strong class="toc-title">Contents</strong>
        
          <ol class="toc-nav"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#å…·ä½“æè¿°"><span class="toc-nav-number">1.</span> <span class="toc-nav-text">&#x5177;&#x4F53;&#x63CF;&#x8FF0;&#xFF1A;</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#springåŸºçŸ³ä¹‹ä¸€-ioc-å’Œ-di"><span class="toc-nav-number"></span> <span class="toc-nav-text">Spring&#x57FA;&#x77F3;&#x4E4B;&#x4E00; &#xFF1A; IOC &#x548C; DI</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#applicationcontextxml-springé…ç½®æ–‡ä»¶"><span class="toc-nav-number">0.1.</span> <span class="toc-nav-text">applicationContext.xml Spring&#x914D;&#x7F6E;&#x6587;&#x4EF6;</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#spring-å®¹å™¨"><span class="toc-nav-number"></span> <span class="toc-nav-text">Spring &#x5BB9;&#x5668;</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#xml-é…ç½®é‡Œçš„-bean-è‡ªåŠ¨è£…é…"><span class="toc-nav-number">1.</span> <span class="toc-nav-text">XML &#x914D;&#x7F6E;&#x91CC;&#x7684; Bean &#x81EA;&#x52A8;&#x88C5;&#x914D;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#bean-çš„ä½œç”¨åŸŸ"><span class="toc-nav-number">2.</span> <span class="toc-nav-text">Bean &#x7684;&#x4F5C;&#x7528;&#x57DF;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#ioc-å®¹å™¨ä¸­-bean-çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•"><span class="toc-nav-number">3.</span> <span class="toc-nav-text">IOC &#x5BB9;&#x5668;&#x4E2D; Bean &#x7684;&#x751F;&#x547D;&#x5468;&#x671F;&#x65B9;&#x6CD5;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#åˆ›å»º-bean-åç½®å¤„ç†å™¨åçš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•-æ¯”è¾ƒä¸Šæ–¹ç”Ÿå‘½å‘¨æœŸ"><span class="toc-nav-number">4.</span> <span class="toc-nav-text">&#x521B;&#x5EFA; Bean &#x540E;&#x7F6E;&#x5904;&#x7406;&#x5668;&#x540E;&#x7684;&#x751F;&#x547D;&#x5468;&#x671F;&#x65B9;&#x6CD5;  &#x6BD4;&#x8F83;&#x4E0A;&#x65B9;&#x751F;&#x547D;&#x5468;&#x671F; &#x1F446;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#ä½¿ç”¨å¤–éƒ¨å±æ€§æ–‡ä»¶"><span class="toc-nav-number">5.</span> <span class="toc-nav-text">&#x4F7F;&#x7528;&#x5916;&#x90E8;&#x5C5E;&#x6027;&#x6587;&#x4EF6;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#é€šè¿‡è°ƒç”¨é™æ€å·¥å‚æ–¹æ³•åˆ›å»º-bean"><span class="toc-nav-number">6.</span> <span class="toc-nav-text">&#x901A;&#x8FC7;&#x8C03;&#x7528;&#x9759;&#x6001;&#x5DE5;&#x5382;&#x65B9;&#x6CD5;&#x521B;&#x5EFA; Bean</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#é€šè¿‡è°ƒç”¨å®ä¾‹å·¥å‚æ–¹æ³•åˆ›å»º-bean"><span class="toc-nav-number">7.</span> <span class="toc-nav-text">&#x901A;&#x8FC7;&#x8C03;&#x7528;&#x5B9E;&#x4F8B;&#x5DE5;&#x5382;&#x65B9;&#x6CD5;&#x521B;&#x5EFA; Bean</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#åœ¨-classpath-ä¸­æ‰«æç»„ä»¶"><span class="toc-nav-number">8.</span> <span class="toc-nav-text">&#x5728; classpath &#x4E2D;&#x626B;&#x63CF;&#x7EC4;&#x4EF6;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#ç»„ä»¶è£…é…-è‡ªåŠ¨æ³¨å…¥"><span class="toc-nav-number">9.</span> <span class="toc-nav-text">&#x7EC4;&#x4EF6;&#x88C5;&#x914D; &#x81EA;&#x52A8;&#x6CE8;&#x5165;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#springè¡¨è¾¾å¼è¯­è¨€spel"><span class="toc-nav-number">10.</span> <span class="toc-nav-text">Spring&#x8868;&#x8FBE;&#x5F0F;&#x8BED;&#x8A00;&#xFF1A;SpEL</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#springåŸºçŸ³ä¹‹ä¸€-aop-aspect-oriented-programming-é¢å‘åˆ‡é¢ç¼–ç¨‹"><span class="toc-nav-number"></span> <span class="toc-nav-text">Spring&#x57FA;&#x77F3;&#x4E4B;&#x4E00; &#xFF1A;AOP (Aspect-Oriented Programming, &#x9762;&#x5411;&#x5207;&#x9762;&#x7F16;&#x7A0B;)</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#åœ¨-spring-ä¸­å¯ç”¨-aspectj-æ³¨è§£æ”¯æŒ"><span class="toc-nav-number"></span> <span class="toc-nav-text">&#x5728; Spring &#x4E2D;&#x542F;&#x7528; AspectJ &#x6CE8;&#x89E3;&#x652F;&#x6301;</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#ç”¨-aspectj-æ³¨è§£å£°æ˜åˆ‡é¢"><span class="toc-nav-number"></span> <span class="toc-nav-text">&#x7528; AspectJ &#x6CE8;&#x89E3;&#x58F0;&#x660E;&#x5207;&#x9762;</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#æŒ‡å®šåˆ‡é¢çš„ä¼˜å…ˆçº§"><span class="toc-nav-number">0.1.</span> <span class="toc-nav-text">&#x6307;&#x5B9A;&#x5207;&#x9762;&#x7684;&#x4F18;&#x5148;&#x7EA7;</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-6"><a class="toc-nav-link" href="#ä¸€ä¸ªåˆ‡é¢å¯ä»¥åŒ…æ‹¬ä¸€ä¸ªæˆ–è€…å¤šä¸ªé€šçŸ¥"><span class="toc-nav-number">0.1.0.1.</span> <span class="toc-nav-text">&#x4E00;&#x4E2A;&#x5207;&#x9762;&#x53EF;&#x4EE5;&#x5305;&#x62EC;&#x4E00;&#x4E2A;&#x6216;&#x8005;&#x591A;&#x4E2A;&#x901A;&#x77E5;&#x3002;</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#å‰ç½®é€šçŸ¥åœ¨æ–¹æ³•æ‰§è¡Œä¹‹å‰æ‰§è¡Œçš„é€šçŸ¥"><span class="toc-nav-number">0.1.1.</span> <span class="toc-nav-text">&#x524D;&#x7F6E;&#x901A;&#x77E5;&#xFF1A;&#x5728;&#x65B9;&#x6CD5;&#x6267;&#x884C;&#x4E4B;&#x524D;&#x6267;&#x884C;&#x7684;&#x901A;&#x77E5;</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#åç½®é€šçŸ¥åœ¨ç›®æ ‡æ–¹æ³•æ‰§è¡Œå-æ— è®ºæ˜¯å¦å‘ç”Ÿå¼‚å¸¸éƒ½æ‰§è¡Œçš„é€šçŸ¥"><span class="toc-nav-number">0.1.2.</span> <span class="toc-nav-text">&#x540E;&#x7F6E;&#x901A;&#x77E5;&#xFF1A;&#x5728;&#x76EE;&#x6807;&#x65B9;&#x6CD5;&#x6267;&#x884C;&#x540E; (&#x65E0;&#x8BBA;&#x662F;&#x5426;&#x53D1;&#x751F;&#x5F02;&#x5E38;),&#x90FD;&#x6267;&#x884C;&#x7684;&#x901A;&#x77E5;</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#è¿”å›é€šçŸ¥åœ¨æ–¹æ³•æ­£å¸¸ç»“æŸåæ‰§è¡Œçš„ä»£ç "><span class="toc-nav-number">0.1.3.</span> <span class="toc-nav-text">&#x8FD4;&#x56DE;&#x901A;&#x77E5;&#xFF1A;&#x5728;&#x65B9;&#x6CD5;&#x6B63;&#x5E38;&#x7ED3;&#x675F;&#x540E;&#x6267;&#x884C;&#x7684;&#x4EE3;&#x7801;</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#å¼‚å¸¸é€šçŸ¥åœ¨ç›®æ ‡æ–¹æ³•å‡ºç°å¼‚å¸¸æ—¶ä¼šæ‰§è¡Œçš„ä»£ç "><span class="toc-nav-number">0.1.4.</span> <span class="toc-nav-text">&#x5F02;&#x5E38;&#x901A;&#x77E5;&#xFF1A;&#x5728;&#x76EE;&#x6807;&#x65B9;&#x6CD5;&#x51FA;&#x73B0;&#x5F02;&#x5E38;&#x65F6;&#x4F1A;&#x6267;&#x884C;&#x7684;&#x4EE3;&#x7801;</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#ç¯ç»•é€šçŸ¥"><span class="toc-nav-number">0.1.5.</span> <span class="toc-nav-text">&#x73AF;&#x7ED5;&#x901A;&#x77E5;</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#é‡ç”¨åˆ‡å…¥ç‚¹å®šä¹‰"><span class="toc-nav-number">0.2.</span> <span class="toc-nav-text">&#x91CD;&#x7528;&#x5207;&#x5165;&#x70B9;&#x5B9A;&#x4E49;</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#ç”¨åŸºäº-xml-çš„é…ç½®å£°æ˜åˆ‡é¢"><span class="toc-nav-number"></span> <span class="toc-nav-text">&#x7528;&#x57FA;&#x4E8E; XML &#x7684;&#x914D;&#x7F6E;&#x58F0;&#x660E;&#x5207;&#x9762;</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#spring-ä¸­çš„äº‹åŠ¡ç®¡ç†"><span class="toc-nav-number"></span> <span class="toc-nav-text">Spring &#x4E2D;&#x7684;&#x4E8B;&#x52A1;&#x7BA1;&#x7406;</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#ç”¨-transactional-æ³¨è§£-å£°æ˜å¼åœ°ç®¡ç†äº‹åŠ¡"><span class="toc-nav-number"></span> <span class="toc-nav-text">&#x7528; @Transactional &#x6CE8;&#x89E3; &#x58F0;&#x660E;&#x5F0F;&#x5730;&#x7BA1;&#x7406;&#x4E8B;&#x52A1;</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#ç”¨-xml-äº‹åŠ¡é€šçŸ¥-å£°æ˜å¼åœ°ç®¡ç†äº‹åŠ¡"><span class="toc-nav-number"></span> <span class="toc-nav-text">&#x7528; XML &#x4E8B;&#x52A1;&#x901A;&#x77E5; &#x58F0;&#x660E;&#x5F0F;&#x5730;&#x7BA1;&#x7406;&#x4E8B;&#x52A1;</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#äº‹åŠ¡ä¼ æ’­è¡Œä¸º-propagation-behavior"><span class="toc-nav-number"></span> <span class="toc-nav-text">&#x4E8B;&#x52A1;&#x4F20;&#x64AD;&#x884C;&#x4E3A; (propagation behavior)</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#å¹¶å‘äº‹åŠ¡æ‰€å¯¼è‡´çš„é—®é¢˜"><span class="toc-nav-number">1.</span> <span class="toc-nav-text">&#x5E76;&#x53D1;&#x4E8B;&#x52A1;&#x6240;&#x5BFC;&#x81F4;&#x7684;&#x95EE;&#x9898;</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#äº‹åŠ¡çš„éš”ç¦»çº§åˆ«-isolation-level"><span class="toc-nav-number"></span> <span class="toc-nav-text">&#x4E8B;&#x52A1;&#x7684;&#x9694;&#x79BB;&#x7EA7;&#x522B; (Isolation level)</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#è®¾ç½®å›æ»šäº‹åŠ¡å±æ€§-rollback"><span class="toc-nav-number"></span> <span class="toc-nav-text">&#x8BBE;&#x7F6E;&#x56DE;&#x6EDA;&#x4E8B;&#x52A1;&#x5C5E;&#x6027; (rollback)</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#è¶…æ—¶å’Œåªè¯»å±æ€§-timeout-read-only"><span class="toc-nav-number"></span> <span class="toc-nav-text">&#x8D85;&#x65F6;&#x548C;&#x53EA;&#x8BFB;&#x5C5E;&#x6027; (timeout read-only)</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-6"><a class="toc-nav-link" href="#webé¡¹ç›®-webxml-é…ç½®å¯åŠ¨-spring-ioc-å®¹å™¨çš„-listener"><span class="toc-nav-number">0.0.0.1.</span> <span class="toc-nav-text">web&#x9879;&#x76EE; web.xml &#x914D;&#x7F6E;&#x542F;&#x52A8; Spring IOC &#x5BB9;&#x5668;&#x7684; Listener</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#jdbctemplate-ç®€ä»‹"><span class="toc-nav-number"></span> <span class="toc-nav-text">JdbcTemplate &#x7B80;&#x4ECB;</span></a></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#æ„Ÿè°¢é˜…è¯»"><span class="toc-nav-number"></span> <span class="toc-nav-text">&#x611F;&#x8C22;&#x9605;&#x8BFB;</span></a>
        
        </div>
      </aside>
    

                
            <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                
                <section>
                    <!-- no hr -->
                    <h5><a href="/tags/">FEATURED TAGS</a></h5>
                    <div class="tags">
                       
                          <a class="tag" href="/tags/#Springå…¨å®¶æ¡¶" title="Springå…¨å®¶æ¡¶">Springå…¨å®¶æ¡¶</a>
                        
                    </div>
                </section>
                

                <!-- Friends Blog -->
                
                <hr>
                <h5>FRIENDS</h5>
                <ul class="list-inline">

                    
                        <li><a href="https://github.com/GitHub-yuteng" target="_blank">GitHub</a></li>
                    
                        <li><a href="https://weibo.com/u/5968884687" target="_blank">å¾®åš</a></li>
                    
                </ul>
                
            </div>
        </div>
    </div>
</article>








<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("https://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'hover',
          placement: 'left',
          icon: 'â„¬'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>



    <!-- Footer -->
    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                
                
                

                

                

                
                    <li>
                        <a target="_blank"  href="https://github.com/GitHub-yuteng">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                

                </ul>
                <p class="copyright text-muted">
                    Copyright &copy; äºè…¾ 2019 
                    <br>
                    Theme by <a href="http://beantech.org">BeanTech</a> 
                    <span style="display: inline-block; margin: 0 5px;">
                        <i class="fa fa-heart"></i>
                    </span> 
                    re-Ported by <a href="http://www.huweihuang.com">èƒ¡ä¼Ÿç…Œ</a> | 
                    <iframe
                        style="margin-left: 2px; margin-bottom:-5px;"
                        frameborder="0" scrolling="0" width="91px" height="20px"
                        src="https://ghbtns.com/github-btn.html?user=huweihuang&repo=hexo-theme-huweihuang&type=star&count=true" >
                    </iframe>
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js"></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js"></script>

<!-- Custom Theme JavaScript -->
<script src="/js/hux-blog.min.js"></script>


<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!-- 
     Because of the native support for backtick-style fenced code blocks 
     right within the Markdown is landed in Github Pages, 
     From V1.6, There is no need for Highlight.js, 
     so Huxblog drops it officially.

     - https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0  
     - https://help.github.com/articles/creating-and-highlighting-code-blocks/    
-->
<!--
    <script>
        async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
            hljs.initHighlightingOnLoad();
        })
    </script>
    <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">
-->


<!-- jquery.tagcloud.js -->
<script>
    // only load tagcloud.js in tag.html
    if($('#tag_cloud').length !== 0){
        async("https://github-yuteng.github.io/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                //size: {start: 1, end: 1, unit: 'em'},
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>

<!--fastClick.js -->
<script>
    async("https://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->


<script>
    // dynamic User by Hux
    var _gaId = 'UA-XXXXXXXX-X';
    var _gaDomain = 'yoursite';

    // Originial
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', _gaId, _gaDomain);
    ga('send', 'pageview');
</script>




<!-- Baidu Tongji -->

<script>
    // dynamic User by Hux
    var _baId = 'xxx';

    // Originial
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?" + _baId;
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
</script>






	<a id="rocket" href="#top" class=""></a>
	<script type="text/javascript" src="/js/totop.js?v=1.0.0" async=""></script>
    <script type="text/javascript" src="/js/toc.js?v=1.0.0" async=""></script>
<!-- Image to hack wechat -->
<img src="https://github-yuteng.github.io/img/icon_wechat.png" width="0" height="0" />
<!-- Migrate from head to bottom, no longer block render and still work -->

</body>

</html>
