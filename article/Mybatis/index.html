<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="keyword"  content="">
    <link rel="shortcut icon" href="/img/ironman-draw.png">
    <!-- Place this tag in your head or just before your close body tag. -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <title>
        
          Mybatis - äºè…¾ | Blog
        
    </title>

    <link rel="canonical" href="https://github-yuteng.github.io/article/Mybatis/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS --> 
    <link rel="stylesheet" href="/css/beantech.min.css">

    <link rel="stylesheet" href="/css/donate.css">
    
    <!-- Pygments Highlight CSS -->
    <link rel="stylesheet" href="/css/highlight.css">

    <link rel="stylesheet" href="/css/widget.css">

    <link rel="stylesheet" href="/css/rocket.css">

    <link rel="stylesheet" href="/css/signature.css">

    <link rel="stylesheet" href="/css/toc.css">

    <!-- Custom Fonts -->
    <!-- <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <!-- Hux change font-awesome CDN to qiniu -->
    <link href="https://cdn.staticfile.org/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">


    <!-- Hux Delete, sad but pending in China
    <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/
    css'>
    -->


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- ga & ba script hoook -->
    <script></script>
</head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">
	<!-- Modified by Yu-Hsuan Yen -->
<!-- Post Header -->
<style type="text/css">
    header.intro-header{
        
            background-image: url('/img/article_header/article_bg.jpg')
            /*post*/
        
    }
    
</style>

<header class="intro-header" >
    <!-- Signature -->
    <div id="signature">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                
                    <div class="post-heading">
                        <div class="tags">
                            
                              <a class="tag" href="/tags/#ORM æ¡†æ¶" title="ORM æ¡†æ¶">ORM æ¡†æ¶</a>
                            
                        </div>
                        <h1>Mybatis</h1>
                        <h2 class="subheading"></h2>
                        <span class="meta">
                            Posted by äºè…¾ on
                            2019-04-03
                        </span>
                    </div>
                


                </div>
            </div>
        </div>
    </div>
</header>

	
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">æ‰€çˆ±éš”å±±æµ·</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <!-- Known Issue, found by Hux:
            <nav>'s height woule be hold on by its content.
            so, when navbar scale out, the <nav> will cover tags.
            also mask any touch event of tags, unfortunately.
        -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>

                    

                        
                    

                        
                        <li>
                            <a href="/about/">å…³äºæˆ‘</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/tags/">Tags</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/archive/">Archives</a>
                        </li>
                        
                    
                    
                </ul>
            </div>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        // CLOSE
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        // OPEN
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>


    <!-- Main Content -->
    <!-- Modify by Yu-Hsuan Yen -->

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                <h2 id="mybatisæ‰‹å†Œå…¥å£ä»å…¥é—¨åˆ°æ”¾å¼ƒ"><a href="http://www.mybatis.org/mybatis-3/zh/getting-started.html" target="_blank" rel="noopener">MyBatisæ‰‹å†Œå…¥å£â€”â€”ä»å…¥é—¨åˆ°æ”¾å¼ƒ</a></h2>
<p><strong>æ¡†æ¶ï¼šæ•´ä½“è§£å†³æ–¹æ¡ˆ</strong></p>
<ul>
<li>JDBC Dbutils(QueryRunner) JdbcTemplateï¼šéƒ½ä»…ä»…æ˜¯å·¥å…·</li>
</ul>
<p><strong>ç¼–å†™sql -&gt; é¢„ç¼–è¯‘ -&gt; è®¾ç½®å‚æ•° -&gt; æ‰§è¡Œsql-&gt; å°è£…ç»“æœ -&gt; DbRecords</strong></p>
<ul>
<li>
<p><strong>Hibernateï¼šå…¨è‡ªåŠ¨å…¨æ˜ å°„ORMï¼ˆObject Relation Mappingï¼‰æ¡†æ¶ï¼›ä½¿ç”¨HQL(æ”¯æŒå®šåˆ¶SQL)</strong></p>
</li>
<li>
<p><strong>MyBatis ï¼šåŠè‡ªåŠ¨ï¼Œè½»é‡çº§çš„æ¡†æ¶ã€‚Sqlä¸javaç¼–ç åˆ†ç¦»ï¼Œå¯ä»¥å®šåˆ¶ä¼˜åŒ–SQL ä¸å¤±å»çµæ´»æ€§ã€‚</strong></p>
<ul>
<li><code>æŠŠç¼–å†™sqlè¯­å¥ çš„åŠŸèƒ½æŠ½å‡ºäº¤ç»™é…ç½®æ–‡ä»¶æ¥å®Œæˆã€‚</code></li>
<li><code>åŠŸèƒ½è¾¹ç•Œæ¸…æ™°ï¼Œä¸€ä¸ªä¸“æ³¨ä¸šåŠ¡ï¼Œä¸€ä¸ªä¸“æ³¨æ•°æ®ã€‚</code></li>
</ul>
</li>
</ul>
<a id="more"></a>
<h2 id="ä¸€-ä»-xml-ä¸­æ„å»º-sqlsessionfactory">ä¸€ã€ä» XML ä¸­æ„å»º SqlSessionFactory</h2>
<ul>
<li><strong>åŸºæœ¬ jaråŒ…</strong>
<ul>
<li>log4j.jar</li>
<li>mybatis-3.4.1.jar</li>
<li>mysql-connector-java-5.1.37-bin.jar</li>
</ul>
</li>
</ul>
<p><strong>åˆ›å»º mybatis-config.xml é…ç½®æ–‡ä»¶</strong></p>
<ul>
<li>XML é…ç½®æ–‡ä»¶ä¸­åŒ…å«äº†å¯¹ MyBatis ç³»ç»Ÿçš„æ ¸å¿ƒè®¾ç½®</li>
<li>åŒ…å«è·å–æ•°æ®åº“è¿æ¥å®ä¾‹çš„æ•°æ®æºï¼ˆDataSourceï¼‰å’Œå†³å®šäº‹åŠ¡ä½œç”¨åŸŸå’Œæ§åˆ¶æ–¹å¼çš„äº‹åŠ¡ç®¡ç†å™¨ï¼ˆTransactionManagerï¼‰ï¼Œä½†æ˜¯æ•´åˆSpring ä¹‹å é‡Œé¢çš„å¤§éƒ¨åˆ†é…ç½®äº¤ç»™Springå¤„ç†ã€‚</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span><br><span class="line"><span class="meta">&lt;!DOCTYPE configuration PUBLIC "-//mybatis.org//DTD Config 3.0//EN" "http://mybatis.org/dtd/mybatis-3-config.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span> /&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"POOLED"</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span> /&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/mybatis"</span> /&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span> /&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"root"</span> /&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- å°†æˆ‘ä»¬å†™å¥½çš„sqlæ˜ å°„æ–‡ä»¶ï¼ˆBlogMapper.xmlï¼‰ä¸€å®šè¦æ³¨å†Œåˆ°å…¨å±€é…ç½®æ–‡ä»¶ï¼ˆmybatis-config.xmlï¼‰ä¸­ --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"Blog.xml"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>è¦æ³¨æ„ XML å¤´éƒ¨çš„å£°æ˜ï¼Œå®ƒç”¨æ¥éªŒè¯ XML æ–‡æ¡£æ­£ç¡®æ€§ã€‚</li>
<li>environment å…ƒç´ ä½“ä¸­åŒ…å«äº†äº‹åŠ¡ç®¡ç†å’Œè¿æ¥æ± çš„é…ç½®ã€‚</li>
<li>mappers å…ƒç´ åˆ™æ˜¯åŒ…å«ä¸€ç»„æ˜ å°„å™¨ï¼ˆmapperï¼‰ï¼Œè¿™äº›æ˜ å°„å™¨çš„ XML æ˜ å°„æ–‡ä»¶åŒ…å«äº† SQL ä»£ç å’Œæ˜ å°„å®šä¹‰ä¿¡æ¯ã€‚</li>
</ul>
<hr>
<hr>
<ul>
<li>
<p><strong>æ¯ä¸ªåŸºäºMyBatisçš„åº”ç”¨éƒ½æ˜¯ä»¥ä¸€ä¸ª SqlSessionFactory çš„å®ä¾‹ä¸ºæ ¸å¿ƒçš„ã€‚</strong></p>
</li>
<li>
<p><strong>SqlSessionFactoryå®ä¾‹å¯ä»¥é€šè¿‡ SqlSessionFactoryBuilder è·å¾—ã€‚</strong></p>
<ul>
<li>è€Œ SqlSessionFactoryBuilder åˆ™å¯ä»¥ä» XML é…ç½®æ–‡ä»¶æˆ–ä¸€ä¸ªé¢„å…ˆå®šåˆ¶çš„ Configuration çš„å®ä¾‹æ„å»ºå‡º SqlSessionFactory çš„å®ä¾‹ã€‚</li>
</ul>
</li>
<li>
<p><strong>SqlSessionFactoryBuilder è¿™ä¸ªç±»å¯ä»¥è¢«å®ä¾‹åŒ–ã€ä½¿ç”¨å’Œä¸¢å¼ƒï¼Œä¸€æ—¦åˆ›å»ºäº† SqlSessionFactoryï¼Œå°±ä¸å†éœ€è¦å®ƒäº†ã€‚</strong></p>
<ul>
<li>SqlSessionFactoryBuilder å®ä¾‹çš„æœ€ä½³ä½œç”¨åŸŸæ˜¯æ–¹æ³•ä½œç”¨åŸŸï¼ˆä¹Ÿå°±æ˜¯<strong>å±€éƒ¨æ–¹æ³•å˜é‡</strong>ï¼‰ã€‚</li>
</ul>
</li>
<li>
<p><strong>SqlSessionFactory ä¸€æ—¦è¢«åˆ›å»ºå°±åº”è¯¥åœ¨åº”ç”¨çš„è¿è¡ŒæœŸé—´ä¸€ç›´å­˜åœ¨ æ²¡æœ‰ä»»ä½•ç†ç”±ä¸¢å¼ƒå®ƒæˆ–é‡æ–°åˆ›å»ºå¦ä¸€ä¸ªå®ä¾‹</strong></p>
<ul>
<li>æœ€ä½³å®è·µæ˜¯åœ¨åº”ç”¨è¿è¡ŒæœŸé—´ä¸è¦é‡å¤åˆ›å»ºå¤šæ¬¡ æœ€ä½³ä½œç”¨åŸŸæ˜¯<strong>åº”ç”¨ä½œç”¨åŸŸ</strong> (ä½¿ç”¨å•ä¾‹æ¨¡å¼æˆ–è€…é™æ€å•ä¾‹æ¨¡å¼)</li>
</ul>
</li>
<li>
<p><strong>SqlSession æ¯ä¸ªçº¿ç¨‹éƒ½åº”è¯¥æœ‰å®ƒè‡ªå·±çš„ SqlSession å®ä¾‹ã€‚SqlSession çš„å®ä¾‹ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå› æ­¤æ˜¯ä¸èƒ½è¢«å…±äº«çš„æœ€ä½³çš„ä½œç”¨åŸŸæ˜¯è¯·æ±‚æˆ–æ–¹æ³•ä½œç”¨åŸŸ</strong>ã€‚</p>
</li>
<li>
<p><strong>æ˜ å°„å™¨å®ä¾‹ æ˜ å°„å™¨æ˜¯ä¸€äº›ç”±ä½ åˆ›å»ºçš„ã€ç»‘å®šä½ æ˜ å°„çš„è¯­å¥çš„æ¥å£ã€‚æ˜ å°„å™¨æ¥å£çš„å®ä¾‹æ˜¯ä» SqlSession ä¸­è·å¾—çš„ã€‚æœ€å¤§ä½œç”¨åŸŸæ˜¯å’Œè¯·æ±‚å®ƒä»¬çš„ SqlSession ç›¸åŒçš„ ä½†æœ€å¥½æ–¹æ³•ä½œç”¨åŸŸ</strong>ã€‚</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBatisTest</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> SqlSessionFactory <span class="title">getSqlSessionFactory</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		String resource = <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">		InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<hr>
<h2 id="äºŒ-è·å–-sqlsession">äºŒã€è·å– SqlSession</h2>
<p><strong>ä» SqlSessionFactory ä¸­è·å– SqlSession</strong></p>
<ul>
<li>SqlSession å®Œå…¨åŒ…å«äº†é¢å‘æ•°æ®åº“æ‰§è¡Œ SQL å‘½ä»¤æ‰€éœ€çš„æ‰€æœ‰æ–¹æ³•ã€‚è·å–sqlSessionå®ä¾‹ï¼Œèƒ½ç›´æ¥æ‰§è¡Œå·²ç»æ˜ å°„çš„sqlè¯­å¥ã€‚</li>
<li><strong>ä¸€ä¸ªsqlSessionå°±æ˜¯ä»£è¡¨å’Œæ•°æ®åº“çš„ä¸€æ¬¡ä¼šè¯ï¼Œç”¨å®Œå…³é—­ã€‚</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">SqlSessionFactory sqlSessionFactory = getSqlSessionFactory();</span><br><span class="line">SqlSession session = sqlSessionFactory.openSession();</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">   Blog blog = (Blog) session.selectOne(<span class="string">"org.mybatis.example.BlogMapper.selectBlog"</span>, <span class="number">101</span>);</span><br><span class="line"><span class="comment">//å»ºè®®å‘½åç©ºé—´åŠ å”¯ä¸€æ ‡è¯†ç¬¦id </span></span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">   session.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ğŸ‘† æ­¤æ—¶ <strong>selectOne ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ğŸ‘‡ XML æ–‡ä»¶çš„ namespace + idï¼Œæ¥è¿›è¡ŒæŸ¥è¯¢</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span><br><span class="line"><span class="meta">&lt;!DOCTYPE mapper  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"org.mybatis.example.BlogMapper"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectBlog"</span> <span class="attr">resultType</span>=<span class="string">"Blog"</span>&gt;</span></span><br><span class="line">		select * from Blog where id = #&#123;id&#125;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<hr>
<hr>
<h3 id="æ¥å£å¼ç¼–ç¨‹-xxxmapperclass-æ˜ å°„å™¨">æ¥å£å¼ç¼–ç¨‹ XxxMapper.class æ˜ å°„å™¨</h3>
<ul>
<li>sqlæ˜ å°„æ–‡ä»¶ï¼šé…ç½®äº†æ¯ä¸€ä¸ªsqlï¼Œä»¥åŠsqlçš„å°è£…è§„åˆ™ç­‰ã€‚å°†sqlæ˜ å°„æ–‡ä»¶æ³¨å†Œåœ¨å…¨å±€é…ç½®æ–‡ä»¶ä¸­</li>
</ul>
<p><strong>æ¥å£å¼ç¼–ç¨‹ï¼š</strong></p>
<ul>
<li>åŸç”Ÿï¼š		Dao		====&gt;  DaoImpl</li>
<li>Mybatisï¼š	Mapper	====&gt;  XxxMapper.xml</li>
</ul>
<p><strong>ä½¿ç”¨ XxxMapper.class æ˜ å°„å™¨çš„å¥½å¤„</strong></p>
<ul>
<li><strong>ä½¿ç”¨æ­£ç¡®æè¿°æ¯ä¸ªè¯­å¥çš„å‚æ•°å’Œè¿”å›å€¼çš„æ¥å£ï¼ˆæ¯”å¦‚ BlogMapper.classï¼‰ï¼Œä¸ä»…å¯ä»¥æ‰§è¡Œæ›´æ¸…æ™°å’Œç±»å‹å®‰å…¨çš„ä»£ç ï¼Œè€Œä¸”è¿˜ä¸ç”¨æ‹…å¿ƒæ˜“é”™çš„å­—ç¬¦ä¸²å­—é¢å€¼ä»¥åŠå¼ºåˆ¶ç±»å‹è½¬æ¢ã€‚</strong></li>
</ul>
<hr>
<p><strong>SqlSession å’Œ connectionä¸€æ · éƒ½æ˜¯éçº¿ç¨‹å®‰å…¨ã€‚æ¯æ¬¡ä½¿ç”¨éƒ½åº”è¯¥å»è·å–æ–°çš„å¯¹è±¡ã€‚</strong></p>
<ul>
<li><strong>ä¸€ä¸ªsqlSessionå°±æ˜¯ä»£è¡¨å’Œæ•°æ®åº“çš„ä¸€æ¬¡ä¼šè¯ï¼Œç”¨å®Œå…³é—­ã€‚</strong></li>
<li><strong>mapperæ¥å£æ²¡æœ‰å®ç°ç±»ï¼Œä½†æ˜¯Mybatisä¼šä¸ºè¿™ä¸ªæ¥å£ç”Ÿæˆä¸€ä¸ªä»£ç†å¯¹è±¡ã€‚å»æ‰§è¡Œå¢åˆ æ”¹æŸ¥æ–¹æ³•</strong></li>
<li><strong><code>Mybatiså°†æ¥å£å’Œxmlè¿›è¡Œç»‘å®š</code></strong></li>
</ul>
<hr>
<p><strong>ä¸¤ä¸ªé‡è¦çš„é…ç½®æ–‡ä»¶ï¼š</strong></p>
<ul>
<li>mybatisçš„å…¨å±€é…ç½®æ–‡ä»¶ï¼šåŒ…å«æ•°æ®åº“è¿æ¥æ± ä¿¡æ¯ï¼Œäº‹åŠ¡ç®¡ç†å™¨ä¿¡æ¯â€¦ç³»ç»Ÿè¿è¡Œç¯å¢ƒä¿¡æ¯</li>
<li>sqlæ˜ å°„æ–‡ä»¶ï¼šä¿å­˜äº†æ¯ä¸€ä¸ªsqlè¯­å¥çš„æ˜ å°„ä¿¡æ¯ã€å°†sqlæŠ½å–å‡ºæ¥ã€‚</li>
</ul>
<p><strong>æ˜ å°„å™¨ XxxMapper.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span><br><span class="line"><span class="meta">&lt;!DOCTYPE mapper  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"org.mybatis.example.BlogMapper"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectBlog"</span> <span class="attr">resultType</span>=<span class="string">"Blog"</span>&gt;</span></span><br><span class="line">		select * from Blog where id = #&#123;id&#125;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>namespaceï¼šåç§°ç©ºé—´ï¼ŒæŒ‡å®šä¸ºæ¥å£çš„å…¨ç±»å</li>
<li>idï¼šå”¯ä¸€æ ‡è¯†ç¬¦ã€‚ä½¿ç”¨sqlçš„å”¯ä¸€æ ‡å¿—æ¥å‘Šè¯‰MyBatisæ‰§è¡Œå“ªä¸ªsqlã€‚æ¥å£ä¸­çš„æ–¹æ³•åç§°</li>
<li>resultTypeï¼šè¿”å›å€¼ç±»å‹ã€‚</li>
<li>#{id}ï¼šä»ä¼ é€’è¿‡æ¥çš„å‚æ•°ä¸­å–å‡ºidå€¼ã€‚</li>
<li>SQLè¯­å¥ å¯ä»¥èµ·åˆ«å æ¯”å¦‚ last_name lastName</li>
</ul>
<p><strong>ç¤ºä¾‹</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">BlogMapper</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Blog <span class="title">getEmpById</span><span class="params">(Integer id)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">SqlSession session = sqlSessionFactory.openSession();</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">	<span class="comment">//è·å–æ¥å£çš„å®ç°ç±»å¯¹è±¡</span></span><br><span class="line">	<span class="comment">//ä¼šä¸ºæ¥å£è‡ªåŠ¨çš„åˆ›å»ºä¸€ä¸ªä»£ç†å¯¹è±¡ï¼Œä»£ç†å¯¹è±¡å»æ‰§è¡Œå¢åˆ æ”¹æŸ¥æ–¹æ³•</span></span><br><span class="line">	BlogMapper mapper = session.getMapper(BlogMapper.class);</span><br><span class="line">	Blog blog = mapper.selectBlog(<span class="number">101</span>);</span><br><span class="line">	System.out.println(mapper.getClass());</span><br><span class="line">	System.out.println(blog);</span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;	</span><br><span class="line">	session.close();<span class="comment">//ä¸€å®šè¦å…³é—­</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<hr>
<p><strong>Java æ³¨è§£æ–¹å¼</strong></p>
<ul>
<li>å¦‚æœä½ éœ€è¦å®Œæˆå¾ˆå¤æ‚çš„äº‹æƒ…ï¼Œé‚£ä¹ˆæœ€å¥½ä½¿ç”¨ XML æ¥æ˜ å°„è¯­å¥ã€‚</li>
<li>åŸºäºæ³¨è§£å’Œ XML çš„è¯­å¥æ˜ å°„æ–¹å¼é—´è‡ªç”±ç§»æ¤å’Œåˆ‡æ¢ã€‚</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.mybatis.example;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">BlogMapper</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Select</span>(<span class="string">"SELECT * FROM blog WHERE id = #&#123;id&#125;"</span>)</span><br><span class="line">	<span class="function">Blog <span class="title">selectBlog</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<hr>
<h2 id="ä¸‰-mybatis-configxml-é…ç½®æ–‡ä»¶">ä¸‰ã€mybatis-config.xml é…ç½®æ–‡ä»¶</h2>
<p><a href="http://www.mybatis.org/mybatis-3/zh/configuration.html" target="_blank" rel="noopener">MyBatis é…ç½®æ–‡ä»¶</a></p>
<ul>
<li><strong>æ ‡ç­¾ä½¿ç”¨æ˜¯æœ‰é¡ºåºçš„</strong>
<ul>
<li>properties?, settings?, typeAliases?, typeHandlers?, objectFactory?, objectWrapperFactory?, reflectorFactory?, plugins?, environments?, databaseIdProvider?, mappers?</li>
</ul>
</li>
</ul>
<h3 id="å±æ€§properties">å±æ€§ï¼ˆpropertiesï¼‰</h3>
<ul>
<li><strong>mybatis å¯ä»¥ä½¿ç”¨ &lt;properties&gt; æ¥å¼•å…¥å¤–éƒ¨ properties é…ç½®æ–‡ä»¶çš„å†…å®¹</strong>
<ul>
<li>resourceï¼šå¼•å…¥ç±»è·¯å¾„ä¸‹çš„èµ„æº</li>
<li>urlï¼šå¼•å…¥ç½‘ç»œè·¯å¾„æˆ–è€…ç£ç›˜è·¯å¾„ä¸‹çš„èµ„æº</li>
</ul>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">"dbconfig.properties"</span>&gt;</span><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"dev_mysql"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span>&gt;</span><span class="tag">&lt;/<span class="name">transactionManager</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"POOLED"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.driver&#125;"</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.url&#125;"</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.username&#125;"</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.password&#125;"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br></pre></td></tr></table></figure>
<hr>
<hr>
<h3 id="è®¾ç½®settings">è®¾ç½®ï¼ˆsettingsï¼‰</h3>
<ul>
<li><strong>settingsåŒ…å«å¾ˆå¤šé‡è¦çš„è®¾ç½®é¡¹</strong>
<ul>
<li>settingï¼šç”¨æ¥è®¾ç½®æ¯ä¸€ä¸ªè®¾ç½®é¡¹</li>
<li>nameï¼šè®¾ç½®é¡¹å</li>
<li>valueï¼šè®¾ç½®é¡¹å–å€¼</li>
</ul>
</li>
</ul>
<p><strong>ä¸€ä¸ªé…ç½®å®Œæ•´çš„ settings (å¸¸ç”¨)å…ƒç´ çš„ç¤ºä¾‹å¦‚ä¸‹(å®˜æ–¹æ–‡æ¡£ç¤ºä¾‹)ï¼š</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--æ˜¾ç¤ºçš„æŒ‡å®šæ¯ä¸ªæˆ‘ä»¬éœ€è¦æ›´æ”¹çš„é…ç½®çš„å€¼ï¼Œå³ä½¿ä»–æ˜¯é»˜è®¤çš„ã€‚é˜²æ­¢ç‰ˆæœ¬æ›´æ–°å¸¦æ¥çš„é—®é¢˜  --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"mapUnderscoreToCamelCase"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span>//ä½¿ç”¨é©¼å³°å‘½å</span><br><span class="line">  <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"lazyLoadingEnabled"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span>//æ‡’åŠ è½½</span><br><span class="line">  <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"aggressiveLazyLoading"</span> <span class="attr">value</span>=<span class="string">"false"</span>/&gt;</span>// false æŒ‰éœ€åŠ è½½</span><br><span class="line">  <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"cacheEnabled"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span>//å¼€å¯ç¼“å­˜</span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure>
<hr>
<hr>
<h3 id="ç±»å‹åˆ«åtypealiases">ç±»å‹åˆ«åï¼ˆtypeAliasesï¼‰</h3>
<ul>
<li><strong>ç±»å‹åˆ«åæ˜¯ä¸º Java ç±»å‹è®¾ç½®ä¸€ä¸ªçŸ­çš„åå­—ã€‚ å®ƒåªå’Œ XML é…ç½®æœ‰å…³ï¼Œå­˜åœ¨çš„æ„ä¹‰ä»…åœ¨äºç”¨æ¥å‡å°‘ç±»å®Œå…¨é™å®šåçš„å†—ä½™ã€‚é»˜è®¤åˆ«åå°±æ˜¯ç±»åå°å†™ blog å’Œ select resultType=â€œblogâ€ é…åˆä½¿ç”¨ (åˆ«åä¸åŒºåˆ†å¤§å°å†™)</strong></li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">typeAlias</span> <span class="attr">alias</span>=<span class="string">"Blog"</span> <span class="attr">type</span>=<span class="string">"domain.blog.Blog"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>packageï¼šä¸ºæŸä¸ªåŒ…ä¸‹çš„æ‰€æœ‰ç±»æ‰¹é‡èµ·åˆ«åã€‚</strong>
<ul>
<li>nameï¼šæŒ‡å®šåŒ…åã€‚ä¸ºå½“å‰åŒ…ä»¥åŠå­ä»£æ‰€æœ‰åŒ…çš„æ¯ä¸€ä¸ªç±»éƒ½èµ·ä¸€ä¸ªé»˜è®¤åˆ«åï¼ˆç±»åå°å†™ï¼‰</li>
<li>é˜²æ­¢åˆ«åå†²çª ç”¨æ³¨è§£æ–¹å¼è§£å†³ @Alias <code>(è‹¥æœ‰æ³¨è§£ï¼Œåˆ™åˆ«åä¸ºå…¶æ³¨è§£å€¼)</code></li>
</ul>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"domain.blog"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Alias</span>(<span class="string">"blog"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Blog</span> </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<hr>
<h3 id="ç±»å‹å¤„ç†å™¨typehandlers">ç±»å‹å¤„ç†å™¨ï¼ˆtypeHandlersï¼‰</h3>
<ul>
<li>æ— è®ºæ˜¯ MyBatis åœ¨é¢„å¤„ç†è¯­å¥ä¸­è®¾ç½®ä¸€ä¸ªå‚æ•°æ—¶ï¼Œè¿˜æ˜¯ä»ç»“æœé›†ä¸­å–å‡ºä¸€ä¸ªå€¼æ—¶éƒ½ä¼šç”¨ç±»å‹å¤„ç†å™¨å°†è·å–çš„å€¼ä»¥åˆé€‚çš„æ–¹å¼è½¬æ¢æˆ Java ç±»å‹ã€‚</li>
<li>ä» 3.4.5 å¼€å§‹ï¼ŒMyBatis é»˜è®¤æ”¯æŒ JSR-310ï¼ˆæ—¥æœŸå’Œæ—¶é—´ APIï¼‰ è‡ªåŠ¨æ³¨å†Œå¤„ç†å™¨ã€‚</li>
</ul>
<hr>
<hr>
<h3 id="æ’ä»¶plugins">æ’ä»¶ï¼ˆpluginsï¼‰</h3>
<p><strong>MyBatis å…è®¸ä½ åœ¨å·²æ˜ å°„è¯­å¥æ‰§è¡Œè¿‡ç¨‹ä¸­çš„æŸä¸€ç‚¹è¿›è¡Œæ‹¦æˆªè°ƒç”¨ã€‚</strong></p>
<ul>
<li>é»˜è®¤æƒ…å†µä¸‹ï¼ŒMyBatis å…è®¸ä½¿ç”¨æ’ä»¶æ¥æ‹¦æˆªçš„æ–¹æ³•è°ƒç”¨åŒ…æ‹¬ï¼š</li>
<li><strong>æ‹¦æˆªçš„å››å¤§å¯¹è±¡</strong>
<ul>
<li>Executor (update, query, flushStatements, commit, rollback, getTransaction, closeâ€¦)</li>
<li>ParameterHandler (getParameterObject, setParameters)</li>
<li>ResultSetHandler (handleResultSets, handleOutputParameters)</li>
<li>StatementHandler (prepare, parameterize, batch, update, query)</li>
</ul>
</li>
</ul>
<hr>
<hr>
<h3 id="ç¯å¢ƒé…ç½®environments">ç¯å¢ƒé…ç½®ï¼ˆenvironmentsï¼‰</h3>
<ul>
<li><strong>environmentsï¼šmybatiså¯ä»¥é…ç½®å¤šç§ç¯å¢ƒ ,defaultæŒ‡å®šä½¿ç”¨æŸç§ç¯å¢ƒã€‚å¯ä»¥å¿«é€Ÿåˆ‡æ¢ç¯å¢ƒã€‚</strong></li>
<li><strong>å°½ç®¡å¯ä»¥é…ç½®å¤šä¸ªç¯å¢ƒï¼Œä½†æ¯ä¸ª SqlSessionFactory å®ä¾‹åªèƒ½é€‰æ‹©ä¸€ç§ç¯å¢ƒã€‚</strong>
<ul>
<li>æ¯ä¸ªæ•°æ®åº“å¯¹åº”ä¸€ä¸ª SqlSessionFactory å®ä¾‹ã€‚</li>
</ul>
</li>
</ul>
<ul>
<li>environmentï¼šé…ç½®ä¸€ä¸ªå…·ä½“çš„ç¯å¢ƒä¿¡æ¯ idä»£è¡¨å½“å‰ç¯å¢ƒçš„å”¯ä¸€æ ‡è¯†ï¼›
<ul>
<li><strong>å¿…é¡»æœ‰ä¸¤ä¸ªæ ‡ç­¾</strong>
<ul>
<li>transactionManagerï¼šäº‹åŠ¡ç®¡ç†å™¨ï¼›
<ul>
<li>å¦‚æœæ­£åœ¨ä½¿ç”¨ Spring + MyBatisï¼Œåˆ™æ²¡æœ‰å¿…è¦é…ç½®äº‹åŠ¡ç®¡ç†å™¨ã€‚å› ä¸º Spring æ¨¡å—ä¼šä½¿ç”¨è‡ªå¸¦çš„ç®¡ç†å™¨æ¥è¦†ç›–é…ç½®ã€‚</li>
<li>typeï¼šäº‹åŠ¡ç®¡ç†å™¨çš„ç±»å‹ã€JDBC(JdbcTransactionFactory)|MANAGED(ManagedTransactionFactory)</li>
<li>è‡ªå®šä¹‰äº‹åŠ¡ç®¡ç†å™¨ï¼šå®ç°TransactionFactoryæ¥å£ã€‚typeæŒ‡å®šä¸ºå…¨ç±»å</li>
</ul>
</li>
<li>dataSourceï¼šæ•°æ®æºï¼›
<ul>
<li>typeï¼›æ•°æ®æºç±»å‹ï¼› UNPOOLED(UnpooledDataSourceFactory)|POOLED(PooledDataSourceFactory)|JNDI(JndiDataSourceFactory)</li>
<li>è‡ªå®šä¹‰æ•°æ®æºï¼šå®ç°DataSourceFactoryæ¥å£ï¼Œtypeæ˜¯å…¨ç±»å</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<hr>
<hr>
<h3 id="æ•°æ®åº“å‚å•†æ ‡è¯†dbidprovider">æ•°æ®åº“å‚å•†æ ‡è¯†ï¼ˆDBIdProviderï¼‰</h3>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">//ä½œç”¨å°±æ˜¯å¾—åˆ°æ•°æ®åº“å‚å•†çš„æ ‡è¯†(é©±åŠ¨getDatabaseProductName())ï¼ŒMybatiså°±èƒ½æ ¹æ®æ•°æ®åº“å‚å•†æ ‡è¯†æ¥æ‰§è¡Œä¸åŒçš„sql;</span><br><span class="line"><span class="tag">&lt;<span class="name">databaseIdProvider</span> <span class="attr">type</span>=<span class="string">"DB_VENDOR"</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- ä¸ºä¸åŒçš„æ•°æ®åº“å‚å•†èµ·åˆ«å --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"MySQL"</span> <span class="attr">value</span>=<span class="string">"mysql"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"Oracle"</span> <span class="attr">value</span>=<span class="string">"oracle"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"SQL Server"</span> <span class="attr">value</span>=<span class="string">"sqlserver"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">databaseIdProvider</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>ç”¨ databaseId=&quot;&quot; ç¡®å®šæ•°æ®åº“ä½¿ç”¨é‚£ä¸ªSQLè¯­å¥</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getEmpById"</span> <span class="attr">resultType</span>=<span class="string">"Employee"</span> <span class="attr">databaseId</span>=<span class="string">"mysql"</span>&gt;</span></span><br><span class="line">	select * from tbl_employee where id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<hr>
<hr>
<h3 id="æ˜ å°„å™¨mappers">æ˜ å°„å™¨ï¼ˆmappersï¼‰</h3>
<ul>
<li>mappersï¼šå°†sqlæ˜ å°„æ³¨å†Œåˆ°å…¨å±€é…ç½®ä¸­ã€‚</li>
<li>æ³¨å†Œé…ç½®æ–‡ä»¶</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- ä½¿ç”¨ç›¸å¯¹äºç±»è·¯å¾„çš„èµ„æºå¼•ç”¨ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"org/mybatis/builder/BlogMapper.xml"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- ä½¿ç”¨å®Œå…¨é™å®šèµ„æºå®šä½ç¬¦ï¼ˆURLï¼‰å¼•ç”¨ç½‘ç»œæˆ–è€…ç£ç›˜ä¸‹æ–‡ä»¶ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">mapper</span> <span class="attr">url</span>=<span class="string">"file:///var/mappers/BlogMapper.xml"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>æ³¨å†Œæ¥å£æ–¹å¼</strong></p>
<ul>
<li>
<p>classï¼šå¼•ç”¨ï¼ˆæ³¨å†Œï¼‰æ¥å£ï¼Œ<br>
1ã€æœ‰sqlæ˜ å°„æ–‡ä»¶ï¼ŒXxxMapper.xml æ–‡ä»¶åå¿…é¡»å’Œæ¥å£åŒåï¼Œå¹¶ä¸”æ”¾åœ¨ä¸æ¥å£åŒä¸€ç›®å½•ä¸‹ï¼›<br>
2ã€æ²¡æœ‰sqlæ˜ å°„æ–‡ä»¶ï¼Œæ‰€æœ‰çš„sqléƒ½æ˜¯åˆ©ç”¨æ³¨è§£å†™åœ¨æ¥å£æ–¹æ³•ä¸Šï¼›</p>
</li>
<li>
<p><strong>æ¨èï¼š</strong></p>
<ul>
<li>æ¯”è¾ƒé‡è¦çš„ï¼Œå¤æ‚çš„Daoæ¥å£æˆ‘ä»¬æ¥å†™sqlæ˜ å°„æ–‡ä»¶ã€‚</li>
<li>ä¸é‡è¦ï¼Œç®€å•çš„Daoæ¥å£ä¸ºäº†å¼€å‘å¿«é€Ÿå¯ä»¥ä½¿ç”¨æ³¨è§£ï¼›</li>
</ul>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- ä½¿ç”¨æ˜ å°„å™¨æ¥å£å®ç°ç±»çš„å®Œå…¨é™å®šç±»å --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">mapper</span> <span class="attr">class</span>=<span class="string">"org.mybatis.builder.BlogMapper"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>é…ç½®æ–‡ä»¶çš„ åŒ…åç§°å’Œæ–‡ä»¶åç§°éƒ½ä¸æ¥å£ç›¸åŒ æ­¤æ—¶å°±å¯ä»¥åˆ†å¼€ã€‚</li>
<li>æ”¾åœ¨confæ–‡ä»¶ä¸‹ è§†è§‰æ•ˆæœåˆ†å¼€ å®é™…ä¸Šè¿˜åœ¨ä¸€èµ·</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- å°†åŒ…å†…çš„æ˜ å°„å™¨æ¥å£å®ç°å…¨éƒ¨æ³¨å†Œä¸ºæ˜ å°„å™¨ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"org.mybatis.builder"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></table></figure>
<hr>
<p><strong>å¯¹è±¡å·¥å‚ï¼ˆobjectFactoryï¼‰ï¼š</strong> ç”¨é»˜è®¤çš„å¯¹è±¡å·¥å‚ï¼ˆobjectFactoryï¼‰</p>
<hr>
<h2 id="å››-mybatis-xml-æ˜ å°„æ–‡ä»¶">å››ã€MyBatis XML æ˜ å°„æ–‡ä»¶</h2>
<p><a href="http://www.mybatis.org/mybatis-3/zh/sqlmap-xml.html" target="_blank" rel="noopener">MyBatis æ˜ å°„æ–‡ä»¶</a></p>
<h3 id="xxxmapperxml-è¯¦è§£">XxxMapper.xml è¯¦è§£</h3>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectPerson"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span> <span class="attr">resultType</span>=<span class="string">"hashmap"</span>&gt;</span></span><br><span class="line">  SELECT * FROM PERSON WHERE ID = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>
<p><strong>parameterTypeï¼š</strong> å‚æ•°ç±»å‹ã€‚å¯ä»¥ä¸ä¼ ï¼ŒMybatisä¼šæ ¹æ®TypeHandlerè‡ªåŠ¨æ¨æ–­ç±»å‹ã€‚</p>
</li>
<li>
<p><strong>resultTypeï¼š</strong> è¿”å›å€¼ç±»å‹(è‡ªåŠ¨å°è£…ç±»å‹)ã€‚å¦‚æœè¿”å›æ˜¯é›†åˆï¼Œå®šä¹‰é›†åˆå…ƒç´ çš„ç±»å‹ã€‚ä¸èƒ½åŒæ—¶å’Œ ResultMap åŒæ—¶ä½¿ç”¨ã€‚</p>
</li>
<li>
<p><strong>å•ä¸ªå‚æ•°ï¼šmybatisä¸ä¼šåšç‰¹æ®Šå¤„ç†ã€‚</strong></p>
<ul>
<li>#{å‚æ•°å/ä»»æ„å}ï¼šå–å‡ºå‚æ•°å€¼ã€‚</li>
</ul>
</li>
<li>
<p><strong>å¤šä¸ªå‚æ•°ï¼šmybatisä¼šåšç‰¹æ®Šå¤„ç†ã€‚</strong></p>
<ul>
<li>å¤šä¸ªå‚æ•°ä¼šè¢«å°è£…æˆ ä¸€ä¸ªmapï¼Œkeyï¼šparam1â€¦paramN,æˆ–è€…å‚æ•°çš„ç´¢å¼•ä¹Ÿå¯ä»¥ valueï¼šä¼ å…¥çš„å‚æ•°å€¼ã€‚</li>
<li>#{param1}ï¼šå°±æ˜¯ä»mapä¸­è·å–æŒ‡å®šçš„keyçš„å€¼ã€‚</li>
<li>å‚æ•°å¤šæ—¶ä¼šå°è£…mapï¼Œä¸ºäº†ä¸æ··ä¹±ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨@Paramæ¥æŒ‡å®šå°è£…æ—¶ä½¿ç”¨çš„keyï¼›</li>
<li>(@Param(â€œidâ€)Integer id,@Param(â€œlastNameâ€)String lastName)</li>
<li><strong>#{id}å°±å¯ä»¥å–å‡ºmapä¸­çš„å€¼</strong></li>
</ul>
</li>
<li>
<p><strong>POJOï¼šå¦‚æœå¤šä¸ªå‚æ•°æ­£å¥½æ˜¯æˆ‘ä»¬ä¸šåŠ¡é€»è¾‘çš„æ•°æ®æ¨¡å‹ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥ä¼ å…¥pojoã€‚</strong></p>
<ul>
<li>#{å±æ€§å}ï¼šå–å‡ºä¼ å…¥çš„pojoçš„å±æ€§å€¼ã€‚</li>
</ul>
</li>
<li>
<p><strong>Mapï¼šå¦‚æœå¤šä¸ªå‚æ•°ä¸æ˜¯ä¸šåŠ¡æ¨¡å‹ä¸­çš„æ•°æ®ï¼Œæ²¡æœ‰å¯¹åº”çš„pojoï¼Œä¸ç»å¸¸ä½¿ç”¨ï¼Œä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä¼ å…¥mapã€‚</strong></p>
<ul>
<li>#{key}ï¼šå–å‡ºmapä¸­å¯¹åº”çš„å€¼ã€‚</li>
</ul>
</li>
<li>
<p><strong>ç‰¹åˆ«æ³¨æ„ï¼š</strong></p>
<ul>
<li>å¦‚æœæ˜¯Collectionï¼ˆListã€Setï¼‰ç±»å‹æˆ–è€…æ˜¯æ•°ç»„ï¼Œä¹Ÿä¼šç‰¹æ®Šå¤„ç†ã€‚ä¹Ÿæ˜¯æŠŠä¼ å…¥çš„listæˆ–è€…æ•°ç»„å°è£…åœ¨mapä¸­ã€‚</li>
</ul>
</li>
<li>
<p><strong>keyï¼šCollectionï¼ˆcollectionï¼‰,å¦‚æœæ˜¯Listè¿˜å¯ä»¥ä½¿ç”¨è¿™ä¸ªkey(list)ã€æ•°ç»„(array)</strong></p>
<ul>
<li>public Employee getEmpById(List<integer> ids)</integer></li>
<li>å–å€¼ï¼šå–å‡ºç¬¬ä¸€ä¸ªidçš„å€¼ï¼š#{list[0]}</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li><strong>#{}ï¼š</strong> å¯ä»¥è·å–mapä¸­çš„å€¼æˆ–è€…pojoå¯¹è±¡å±æ€§çš„å€¼ï¼›</li>
<li><strong>${}ï¼š</strong> å¯ä»¥è·å–mapä¸­çš„å€¼æˆ–è€…pojoå¯¹è±¡å±æ€§çš„å€¼ï¼›</li>
<li>select * from tbl_employee where id=<strong>${id}</strong> and last_name=<strong>#{lastName}</strong></li>
<li>Preparingï¼šselect * from tbl_employee where id=2 and last_name=?</li>
<li><strong>åŒºåˆ«ï¼š</strong>
<ul>
<li><strong>#{}ï¼š</strong> æ˜¯ä»¥é¢„ç¼–è¯‘çš„å½¢å¼ï¼Œå°†å‚æ•°è®¾ç½®åˆ°sqlè¯­å¥ä¸­ï¼›PreparedStatementã€é˜²æ­¢sqlæ³¨å…¥ã€‚</li>
<li><strong>${}ï¼š</strong> å–å‡ºçš„å€¼ç›´æ¥æ‹¼è£…åœ¨sqlè¯­å¥ä¸­ï¼›ä¼šæœ‰å®‰å…¨é—®é¢˜ã€‚åŸç”Ÿjdbcä¸æ”¯æŒå ä½ç¬¦çš„åœ°æ–¹æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ ${} è¿›è¡Œå–å€¼ã€‚</li>
</ul>
</li>
</ul>
<hr>
<p><strong>#{} æ›´ä¸°å¯Œçš„ç”¨æ³•</strong></p>
<ul>
<li>è§„å®šå‚æ•°çš„ä¸€äº›è§„åˆ™ï¼š
<ul>
<li>javaTypeã€jdbcTypeã€modeï¼ˆå­˜å‚¨è¿‡ç¨‹ï¼‰ã€numericScaleã€</li>
<li>resultMapã€typeHandlerã€jdbcTypeNameã€expressionï¼ˆæœªæ¥å‡†å¤‡æ”¯æŒçš„åŠŸèƒ½ï¼‰ï¼›</li>
</ul>
</li>
<li><strong>jdbcTypeé€šå¸¸éœ€è¦åœ¨æŸç§ç‰¹å®šçš„æ¡ä»¶ä¸‹è¢«è®¾ç½®ï¼š</strong>
<ul>
<li>åœ¨æˆ‘ä»¬æ•°æ®ä¸ºnullçš„æ—¶å€™ï¼Œæœ‰äº›æ•°æ®åº“å¯èƒ½ä¸èƒ½è¯†åˆ«mybatiså¯¹nullçš„é»˜è®¤å¤„ç†ã€‚æ¯”å¦‚Oracleï¼ˆæŠ¥é”™ï¼‰</li>
<li>JdbcType OTHERï¼šæ— æ•ˆçš„ç±»å‹ï¼›å› ä¸ºmybatiså¯¹æ‰€æœ‰çš„nulléƒ½æ˜ å°„çš„æ˜¯åŸç”ŸJdbcçš„OTHERç±»å‹ï¼Œoracleä¸èƒ½æ­£ç¡®å¤„ç†;</li>
<li><strong>ç”±äºå…¨å±€é…ç½®ä¸­ï¼šjdbcTypeForNull=OTHERï¼›oracleä¸æ”¯æŒï¼›</strong></li>
<li>ä¸¤ç§åŠæ³•
<ul>
<li>1ã€#{email,jdbcType=OTHER};</li>
<li>2ã€jdbcTypeForNull=NULL</li>
<li>&lt; setting name=â€œjdbcTypeForNullâ€ value=â€œNULLâ€/&gt;</li>
</ul>
</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li><strong>è¿”å›é›†åˆç±»å‹</strong></li>
<li>resultTypeï¼šå¦‚æœè¿”å›çš„æ˜¯ä¸€ä¸ªé›†åˆï¼Œè¦å†™é›†åˆä¸­å…ƒç´ çš„ç±»å‹</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Employee&gt; <span class="title">getEmpsByLastNameLike</span><span class="params">(String lastName)</span></span>;</span><br><span class="line"></span><br><span class="line">&lt;select id=<span class="string">"getEmpsByLastNameLike"</span> resultType=<span class="string">"Employee"</span>&gt;</span><br><span class="line">	select * from tbl_employee where last_name like #&#123;lastName&#125;</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure>
<hr>
<hr>
<ul>
<li><strong>è¿”å›Mapç±»å‹</strong>
<ul>
<li>è¿”å›å•æ¡è®°å½•çš„å°è£… Map</li>
</ul>
</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title">getEmpByIdReturnMap</span><span class="params">(Integer id)</span></span>;</span><br><span class="line"></span><br><span class="line">&lt;select id=<span class="string">"getEmpByIdReturnMap"</span> resultType=<span class="string">"map"</span>&gt;</span><br><span class="line">	select * from tbl_employee where id=#&#123;id&#125;</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>å¤šæ¡è®°å½•å°è£…ä¸€ä¸ªMapï¼š</strong> Map&lt;Integer,Employee&gt;ï¼šé”®æ˜¯è¿™æ¡è®°å½•çš„ä¸»é”®ï¼Œå€¼æ˜¯è®°å½•å°è£…åçš„javaBean</li>
<li><strong>@MapKeyï¼š</strong> å‘Šè¯‰mybatiså°è£…è¿™ä¸ªmapçš„æ—¶å€™ä½¿ç”¨å“ªä¸ªå±æ€§ä½œä¸ºmapçš„key</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@MapKey</span>(<span class="string">"lastName"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> Map&lt;String, Employee&gt; <span class="title">getEmpByLastNameLikeReturnMap</span><span class="params">(String lastName)</span></span>;</span><br><span class="line"></span><br><span class="line">&lt;select id=<span class="string">"getEmpByLastNameLikeReturnMap"</span> resultType=<span class="string">"Employee"</span>&gt;</span><br><span class="line">	select * from tbl_employee where last_name like #&#123;lastName&#125;</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure>
<hr>
<hr>
<h3 id="è‡ªå®šä¹‰-resultmapå®ç°ç»“æœé›†æ˜ å°„">è‡ªå®šä¹‰ ResultMapï¼Œå®ç°ç»“æœé›†æ˜ å°„</h3>
<ul>
<li><strong>è‡ªå®šä¹‰æŸä¸ªjavaBeançš„å°è£…è§„åˆ™</strong>
<ul>
<li>typeï¼šè‡ªå®šä¹‰è§„åˆ™çš„Javaç±»å‹</li>
<li>idï¼šå”¯ä¸€idæ–¹ä¾¿å¼•ç”¨</li>
</ul>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"Employee"</span> <span class="attr">id</span>=<span class="string">"MySimpleEmp"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- æŒ‡å®šä¸»é”®åˆ—çš„å°è£…è§„åˆ™ --&gt;</span>	</span><br><span class="line">	<span class="comment">&lt;!-- id æ ‡ç­¾å®šä¹‰ä¸»é”® åº•å±‚æœ‰ä¼˜åŒ– --&gt;</span>	</span><br><span class="line">	<span class="comment">&lt;!-- columnï¼šæŒ‡å®šå“ªä¸€åˆ— --&gt;</span>	</span><br><span class="line">	<span class="comment">&lt;!-- propertyï¼šæŒ‡å®šå¯¹åº”çš„javaBeanå±æ€§ --&gt;</span>	</span><br><span class="line">	<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"id"</span> <span class="attr">property</span>=<span class="string">"id"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- å®šä¹‰æ™®é€šåˆ—å°è£…è§„åˆ™ --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"last_name"</span> <span class="attr">property</span>=<span class="string">"lastName"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- å…¶ä»–ä¸æŒ‡å®šçš„åˆ—ä¼šè‡ªåŠ¨å°è£…ï¼šæˆ‘ä»¬åªè¦å†™resultMapå°±æŠŠå…¨éƒ¨çš„æ˜ å°„è§„åˆ™éƒ½å†™ä¸Šã€‚ --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"email"</span> <span class="attr">property</span>=<span class="string">"email"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"gender"</span> <span class="attr">property</span>=<span class="string">"gender"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getEmpById"</span>  <span class="attr">resultMap</span>=<span class="string">"MySimpleEmp"</span>&gt;</span></span><br><span class="line">	select * from tbl_employee where id=#&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<hr>
<h3 id="ä¸€å¯¹ä¸€-resultmap">ä¸€å¯¹ä¸€ resultMap</h3>
<p><strong>è”åˆæŸ¥è¯¢ï¼šçº§è”å±æ€§å°è£…ç»“æœé›†</strong></p>
<ul>
<li>æŸ¥è¯¢Employeeçš„åŒæ—¶æŸ¥è¯¢å‘˜å·¥å¯¹åº”çš„éƒ¨é—¨</li>
<li>Employee â€”â€” Department</li>
<li>ä¸€ä¸ªå‘˜å·¥æœ‰ä¸ä¹‹å¯¹åº”çš„éƒ¨é—¨ä¿¡æ¯</li>
<li>id  ã€last_name  ã€gender  ã€d_id  ã€did  ã€dept_name (private Department dept)</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"Employee"</span> <span class="attr">id</span>=<span class="string">"MyDifEmp"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"id"</span> <span class="attr">property</span>=<span class="string">"id"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"last_name"</span> <span class="attr">property</span>=<span class="string">"lastName"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"gender"</span> <span class="attr">property</span>=<span class="string">"gender"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"did"</span> <span class="attr">property</span>=<span class="string">"dept.id"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"dept_name"</span> <span class="attr">property</span>=<span class="string">"dept.departmentName"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getEmpAndDept"</span> <span class="attr">resultMap</span>=<span class="string">"MyDifEmp"</span>&gt;</span></span><br><span class="line">	SELECT e.id id,e.last_name last_name,e.gender gender,e.d_id d_id,</span><br><span class="line">	d.id did,d.dept_name dept_name FROM tbl_employee e,tbl_dept d</span><br><span class="line">	WHERE e.d_id=d.id AND e.id=#&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<hr>
<p><strong>ä½¿ç”¨ association å®šä¹‰å…³è”çš„å•ä¸ªå¯¹è±¡çš„å°è£…è§„åˆ™</strong></p>
<ul>
<li>associationå¯ä»¥æŒ‡å®šè”åˆçš„javaBeanå¯¹è±¡</li>
<li>property=â€œdeptâ€ï¼šæŒ‡å®šå“ªä¸ªå±æ€§æ˜¯è”åˆçš„å¯¹è±¡</li>
<li>javaTypeï¼šæŒ‡å®šè¿™ä¸ªå±æ€§å¯¹è±¡çš„ç±»å‹[ä¸èƒ½çœç•¥]</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"Employee"</span> <span class="attr">id</span>=<span class="string">"MyDifEmp2"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"id"</span> <span class="attr">property</span>=<span class="string">"id"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"last_name"</span> <span class="attr">property</span>=<span class="string">"lastName"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"gender"</span> <span class="attr">property</span>=<span class="string">"gender"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">"dept"</span> <span class="attr">javaType</span>=<span class="string">"Department"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"did"</span> <span class="attr">property</span>=<span class="string">"id"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"dept_name"</span> <span class="attr">property</span>=<span class="string">"departmentName"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">association</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getEmpAndDept"</span> <span class="attr">resultMap</span>=<span class="string">"MyDifEmp"</span>&gt;</span></span><br><span class="line">	SELECT e.id id,e.last_name last_name,e.gender gender,e.d_id d_id,</span><br><span class="line">	d.id did,d.dept_name dept_name FROM tbl_employee e,tbl_dept d</span><br><span class="line">	WHERE e.d_id=d.id AND e.id=#&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<hr>
<p><strong>ä½¿ç”¨associationè¿›è¡Œåˆ†æ­¥æŸ¥è¯¢ï¼š</strong></p>
<ul>
<li>1ã€å…ˆæŒ‰ç…§å‘˜å·¥idæŸ¥è¯¢å‘˜å·¥ä¿¡æ¯ã€‚</li>
<li>2ã€æ ¹æ®æŸ¥è¯¢å‘˜å·¥ä¿¡æ¯ä¸­çš„d_idå€¼å»éƒ¨é—¨è¡¨æŸ¥å‡ºéƒ¨é—¨ä¿¡æ¯</li>
<li>3ã€éƒ¨é—¨è®¾ç½®åˆ°å‘˜å·¥ä¸­ï¼›</li>
<li>id  ã€last_name  ã€email  ã€gender  ã€d_id ã€(private Department dept)</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"Employee"</span> <span class="attr">id</span>=<span class="string">"MyEmpByStep"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"id"</span> <span class="attr">property</span>=<span class="string">"id"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"last_name"</span> <span class="attr">property</span>=<span class="string">"lastName"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"email"</span> <span class="attr">property</span>=<span class="string">"email"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"gender"</span> <span class="attr">property</span>=<span class="string">"gender"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- associationå®šä¹‰å…³è”å¯¹è±¡çš„å°è£…è§„åˆ™ --&gt;</span></span><br><span class="line">	<span class="comment">&lt;!--select:è¡¨æ˜å½“å‰å±æ€§æ˜¯è°ƒç”¨selectæŒ‡å®šçš„æ–¹æ³•æŸ¥å‡ºçš„ç»“æœ --&gt;</span></span><br><span class="line">	<span class="comment">&lt;!--column:æŒ‡å®šå°†å“ªä¸€åˆ—çš„å€¼ä¼ ç»™è¿™ä¸ªæ–¹æ³• --&gt;</span></span><br><span class="line">	<span class="comment">&lt;!--æµç¨‹ï¼šä½¿ç”¨selectæŒ‡å®šçš„æ–¹æ³•ï¼ˆä¼ å…¥columnæŒ‡å®šçš„è¿™åˆ—å‚æ•°çš„å€¼ï¼‰æŸ¥å‡ºå¯¹è±¡ï¼Œå¹¶å°è£…ç»™propertyæŒ‡å®šçš„å±æ€§ --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">"dept"</span> <span class="attr">select</span>=<span class="string">"DepartmentMapper.getDeptById"</span> <span class="attr">column</span>=<span class="string">"d_id"</span>&gt;</span><span class="tag">&lt;/<span class="name">association</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--  public Employee getEmpByIdStep(Integer id);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getEmpByIdStep"</span> <span class="attr">resultMap</span>=<span class="string">"MyEmpByStep"</span>&gt;</span></span><br><span class="line">	select * from tbl_employee where id=#&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<hr>
<p><strong>å¯ä»¥ä½¿ç”¨å»¶è¿ŸåŠ è½½æ‡’åŠ è½½ã€(æŒ‰éœ€åŠ è½½)</strong></p>
<ul>
<li>é…ç½®ä¸¤ä¸ªå‚æ•° å³å¯</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--æ˜¾ç¤ºçš„æŒ‡å®šæ¯ä¸ªæˆ‘ä»¬éœ€è¦æ›´æ”¹çš„é…ç½®çš„å€¼ï¼Œå³ä½¿ä»–æ˜¯é»˜è®¤çš„ã€‚é˜²æ­¢ç‰ˆæœ¬æ›´æ–°å¸¦æ¥çš„é—®é¢˜  --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"lazyLoadingEnabled"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span>//æ‡’åŠ è½½</span><br><span class="line">  <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"aggressiveLazyLoading"</span> <span class="attr">value</span>=<span class="string">"false"</span>/&gt;</span>// false æŒ‰éœ€åŠ è½½</span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Employee&gt; <span class="title">getEmpsByDeptId</span><span class="params">(Integer deptId)</span></span>;</span><br><span class="line"></span><br><span class="line"> &lt;select id=<span class="string">"getEmpByIdStep"</span> resultMap=<span class="string">"MyEmpByStep"</span>&gt;</span><br><span class="line"> 	select * from tbl_employee where id=#&#123;id&#125;</span><br><span class="line"> &lt;/select&gt;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="ä¸€å¯¹å¤š-resultmap">ä¸€å¯¹å¤š resultMap</h3>
<ul>
<li>æŸ¥è¯¢éƒ¨é—¨çš„æ—¶å€™å°†éƒ¨é—¨å¯¹åº”çš„æ‰€æœ‰å‘˜å·¥ä¿¡æ¯ä¹ŸæŸ¥è¯¢å‡ºæ¥</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public class Department &#123;</span><br><span class="line">  private Integer id;</span><br><span class="line">  private String departmentName;</span><br><span class="line">  private List&lt;Employee&gt; emps;</span><br><span class="line"></span><br><span class="line">did  dept_name  ||  eid  last_name  email   gender</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--åµŒå¥—ç»“æœé›†çš„æ–¹å¼ï¼Œä½¿ç”¨collectionæ ‡ç­¾å®šä¹‰å…³è”çš„é›†åˆç±»å‹çš„å±æ€§å°è£…è§„åˆ™  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"Department"</span> <span class="attr">id</span>=<span class="string">"MyDept"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"did"</span> <span class="attr">property</span>=<span class="string">"id"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"dept_name"</span> <span class="attr">property</span>=<span class="string">"departmentName"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">		collectionå®šä¹‰å…³è”é›†åˆç±»å‹çš„å±æ€§çš„å°è£…è§„åˆ™ </span></span><br><span class="line"><span class="comment">		ofType:æŒ‡å®šé›†åˆé‡Œé¢å…ƒç´ çš„ç±»å‹</span></span><br><span class="line"><span class="comment">	--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"emps"</span> <span class="attr">ofType</span>=<span class="string">"Employee"</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- å®šä¹‰è¿™ä¸ªé›†åˆä¸­å…ƒç´ çš„å°è£…è§„åˆ™ --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"eid"</span> <span class="attr">property</span>=<span class="string">"id"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"last_name"</span> <span class="attr">property</span>=<span class="string">"lastName"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"email"</span> <span class="attr">property</span>=<span class="string">"email"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"gender"</span> <span class="attr">property</span>=<span class="string">"gender"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- public Department getDeptByIdPlus(Integer id); --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getDeptById"</span> <span class="attr">resultMap</span>=<span class="string">"MyDept"</span>&gt;</span></span><br><span class="line">	SELECT d.id did,d.dept_name dept_name,</span><br><span class="line">			e.id eid,e.last_name last_name,e.email email,e.gender gender</span><br><span class="line">	FROM tbl_dept d</span><br><span class="line">	LEFT JOIN tbl_employee e</span><br><span class="line">	ON d.id=e.d_id</span><br><span class="line">	WHERE d.id=#&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<hr>
<p><strong>collectionï¼šåˆ†æ­¥æŸ¥è¯¢</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"Department"</span> <span class="attr">id</span>=<span class="string">"MyDeptStep"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"id"</span> <span class="attr">property</span>=<span class="string">"id"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"dept_name"</span> <span class="attr">property</span>=<span class="string">"departmentName"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"emps"</span> <span class="attr">select</span>=<span class="string">"DepartmentMapper.getEmpsByDeptId"</span> <span class="attr">column</span>=<span class="string">"&#123;deptId=id&#125;"</span> <span class="attr">fetchType</span>=<span class="string">"lazy"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line">public Department getDeptByIdStep(Integer id);</span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getDeptByIdStep"</span> <span class="attr">resultMap</span>=<span class="string">"MyDeptStep"</span>&gt;</span></span><br><span class="line">	select id,dept_name from tbl_dept where id=#&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">public List<span class="tag">&lt;<span class="name">Employee</span>&gt;</span> getEmpsByDeptId(Integer deptId);</span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getEmpsByDeptId"</span> <span class="attr">resultType</span>=<span class="string">"Employee"</span>&gt;</span></span><br><span class="line">	select * from tbl_employee where d_id=#&#123;deptId&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>æ‰©å±•ï¼šå¤šåˆ—çš„å€¼ä¼ é€’è¿‡å»</strong></p>
<ul>
<li><strong>å°†å¤šåˆ—çš„å€¼å°è£…mapä¼ é€’</strong>
<ul>
<li>column=&quot;{key1=column1,key2=column2}&quot;</li>
<li>fetchType=â€œlazyâ€ï¼šè¡¨ç¤ºä½¿ç”¨å»¶è¿ŸåŠ è½½ï¼›
<ul>
<li>lazyï¼šå»¶è¿Ÿ</li>
<li>eagerï¼šç«‹å³</li>
</ul>
</li>
</ul>
</li>
</ul>
<hr>
<p><strong>&lt; discriminator javaType=&quot;&quot;&gt; é‰´åˆ«å™¨</strong></p>
<ul>
<li>é‰´åˆ«å™¨ï¼šMybatiså¯ä»¥ä½¿ç”¨discriminatoråˆ¤æ–­æŸåˆ—çš„å€¼ï¼Œç„¶åæ ¹æ®æŸåˆ—çš„å€¼æ”¹å˜å°è£…è¡Œä¸º
<ul>
<li><strong>å°è£…Employeeï¼š</strong>
<ul>
<li>å¦‚æœæŸ¥å‡ºçš„æ˜¯å¥³ç”Ÿï¼šå°±æŠŠéƒ¨é—¨ä¿¡æ¯æŸ¥è¯¢å‡ºæ¥ï¼Œå¦åˆ™ä¸æŸ¥è¯¢ï¼›</li>
<li>å¦‚æœæ˜¯ç”·ç”Ÿï¼ŒæŠŠlast_nameè¿™ä¸€åˆ—çš„å€¼èµ‹å€¼ç»™email;</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"Employee"</span> <span class="attr">id</span>=<span class="string">"MyEmpDis"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"id"</span> <span class="attr">property</span>=<span class="string">"id"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"last_name"</span> <span class="attr">property</span>=<span class="string">"lastName"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"email"</span> <span class="attr">property</span>=<span class="string">"email"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"gender"</span> <span class="attr">property</span>=<span class="string">"gender"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- columnï¼šæŒ‡å®šåˆ¤å®šçš„åˆ—å --&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- javaTypeï¼šåˆ—å€¼å¯¹åº”çš„javaç±»å‹  --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">discriminator</span> <span class="attr">column</span>=<span class="string">"gender"</span> <span class="attr">javaType</span>=<span class="string">"string"</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!--å¥³ç”Ÿ  resultType:æŒ‡å®šå°è£…çš„ç»“æœç±»å‹ï¼›ä¸èƒ½ç¼ºå°‘ã€‚æˆ–è€… resultMap--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">case</span> <span class="attr">value</span>=<span class="string">"0"</span> <span class="attr">resultType</span>=<span class="string">"Employee"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">"dept"</span> <span class="attr">select</span>=<span class="string">"DepartmentMapper.getDeptById"</span> <span class="attr">column</span>=<span class="string">"d_id"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">association</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">case</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!--ç”·ç”Ÿ ;å¦‚æœæ˜¯ç”·ç”Ÿï¼ŒæŠŠlast_nameè¿™ä¸€åˆ—çš„å€¼èµ‹å€¼ç»™email; --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">case</span> <span class="attr">value</span>=<span class="string">"1"</span> <span class="attr">resultType</span>=<span class="string">"Employee"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"id"</span> <span class="attr">property</span>=<span class="string">"id"</span>/&gt;</span></span><br><span class="line">		 	<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"last_name"</span> <span class="attr">property</span>=<span class="string">"lastName"</span>/&gt;</span></span><br><span class="line">		 	<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"last_name"</span> <span class="attr">property</span>=<span class="string">"email"</span>/&gt;</span></span><br><span class="line">		 	<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"gender"</span> <span class="attr">property</span>=<span class="string">"gender"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">case</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">discriminator</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br></pre></td></tr></table></figure>
<hr>
<hr>
<h2 id="äº”-åŠ¨æ€sql">äº”ã€åŠ¨æ€SQL</h2>
<ul>
<li><strong>MyBatis çš„å¼ºå¤§ç‰¹æ€§ä¹‹ä¸€ä¾¿æ˜¯å®ƒçš„åŠ¨æ€ SQLã€‚</strong>
<ul>
<li><strong>if</strong></li>
<li><strong>trim</strong> (where, set)</li>
<li><strong>choose</strong> (when, otherwise)</li>
<li><strong>foreach</strong></li>
</ul>
</li>
</ul>
<hr>
<hr>
<h3 id="if">if</h3>
<ul>
<li>
<p>æŸ¥è¯¢å‘˜å·¥ï¼Œè¦æ±‚ï¼Œæºå¸¦äº†å“ªä¸ªå­—æ®µæŸ¥è¯¢æ¡ä»¶å°±å¸¦ä¸Šè¿™ä¸ªå­—æ®µçš„å€¼</p>
</li>
<li>
<p><strong>testï¼šåˆ¤æ–­è¡¨è¾¾å¼ï¼ˆOGNLï¼‰</strong></p>
<ul>
<li>if test=&quot;&quot;ï¼šä»å‚æ•°ä¸­å–å€¼è¿›è¡Œåˆ¤æ–­ã€‚</li>
<li>&amp;&amp;ï¼š&amp;amp ;&amp;amp ; é‡è§ç‰¹æ®Šç¬¦å·åº”è¯¥å»å†™è½¬ä¹‰å­—ç¬¦ã€‚</li>
<li>â€ï¼š&amp;quot ;&amp;quot ;</li>
</ul>
</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Employee&gt; <span class="title">getEmpsByConditionIf</span><span class="params">(Employee employee)</span></span>;</span><br><span class="line"></span><br><span class="line">&lt;select id=<span class="string">"getEmpsByConditionIf"</span> resultType=<span class="string">"Employee"</span>&gt;</span><br><span class="line">	select * from tbl_employee</span><br><span class="line">	&lt;!-- where --&gt;</span><br><span class="line">	&lt;where&gt;</span><br><span class="line"> 	&lt;<span class="keyword">if</span> test=<span class="string">"id!=null"</span>&gt;</span><br><span class="line"> 		id=#&#123;id&#125;</span><br><span class="line"> 	&lt;/if&gt;</span><br><span class="line"> 	&lt;<span class="keyword">if</span> test=<span class="string">"lastName!=null &amp;amp;&amp;amp; lastName!=&amp;quot;&amp;quot;"</span>&gt;</span><br><span class="line"> 		and last_name like #&#123;lastName&#125;</span><br><span class="line"> 	&lt;/if&gt;</span><br><span class="line"> 	&lt;<span class="keyword">if</span> test=<span class="string">"email!=null and email.trim()!=&amp;quot;&amp;quot;"</span>&gt;</span><br><span class="line"> 		and email=#&#123;email&#125;</span><br><span class="line"> 	&lt;/if&gt; </span><br><span class="line"> 	&lt;!-- OGNL ä¼šè¿›è¡Œå­—ç¬¦ä¸²ä¸æ•°å­—çš„è½¬æ¢åˆ¤æ–­ <span class="string">"0"</span>==<span class="number">0</span> --&gt;</span><br><span class="line"> 	&lt;<span class="keyword">if</span> test=<span class="string">"gender==0 or gender==1"</span>&gt;</span><br><span class="line"> 	 	and gender=#&#123;gender&#125;</span><br><span class="line"> 	&lt;/if&gt;</span><br><span class="line">	&lt;/where&gt;</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure>
<hr>
<hr>
<h3 id="trim-where-set">trim (where, set)</h3>
<ul>
<li>
<p><strong>trim æ ‡ç­¾ä½“ä¸­æ˜¯æ•´ä¸ªå­—ç¬¦ä¸²æ‹¼ä¸²åçš„ç»“æœ</strong></p>
</li>
<li>
<p><strong>and å†™åœ¨æ¡ä»¶å</strong></p>
<ul>
<li><strong>prefix=&quot;&quot;ï¼š</strong> å‰ç¼€ prefixç»™æ‹¼ä¸²åçš„æ•´ä¸ªå­—ç¬¦ä¸²åŠ ä¸€ä¸ªå‰ç¼€ ã€‚</li>
<li><strong>prefixOverrides=&quot;&quot;ï¼š</strong> å‰ç¼€è¦†ç›– å»æ‰æ•´ä¸ªå­—ç¬¦ä¸²å‰é¢å¤šä½™çš„å­—ç¬¦ã€‚</li>
<li><strong>suffix=&quot;&quot;ï¼š</strong> åç¼€ suffixç»™æ‹¼ä¸²åçš„æ•´ä¸ªå­—ç¬¦ä¸²åŠ ä¸€ä¸ªåç¼€ ã€‚</li>
<li><strong>suffixOverrides=&quot;&quot;ï¼š</strong> åç¼€è¦†ç›– å»æ‰æ•´ä¸ªå­—ç¬¦ä¸²åé¢å¤šä½™çš„å­—ç¬¦ã€‚</li>
</ul>
</li>
</ul>
<h3 id="where">where</h3>
<ul>
<li><strong>æŸ¥è¯¢çš„æ—¶å€™å¦‚æœæŸäº›æ¡ä»¶æ²¡å¸¦å¯èƒ½sqlæ‹¼è£…ä¼šæœ‰é—®é¢˜</strong>ï¼Œæ¯”å¦‚ç¬¬ä¸€ä¸ªæ¡ä»¶ä¸ç¬¦åˆä¼šå‡ºç° where and
<ul>
<li>1ã€ç»™whereåé¢åŠ ä¸Š1=1ï¼Œä»¥åçš„æ¡ä»¶éƒ½and xxx</li>
<li>2ã€Mybatisä½¿ç”¨ <strong>where</strong>æ ‡ç­¾æ¥å°†æ‰€æœ‰çš„æŸ¥è¯¢æ¡ä»¶åŒ…æ‹¬åœ¨å†…ã€‚Mybatis å°±ä¼šå°† where æ ‡ç­¾ä¸­æ‹¼è£…çš„sqlï¼Œå¤šå‡ºæ¥çš„andæˆ–è€…orå»æ‰ã€‚
<ul>
<li><strong>whereåªä¼šå»æ‰ç¬¬ä¸€ä¸ªå¤šå‡ºæ¥çš„andæˆ–è€…or (å»ºè®® and å†™åœ¨åœ¨æ¡ä»¶å‰é¢)ï¼Œåé¢å¤šå‡ºçš„andæˆ–è€…or whereæ ‡ç­¾ä¸èƒ½è§£å†³ã€‚</strong></li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="trim-where-å°è£…æŸ¥è¯¢æ¡ä»¶">trim where (å°è£…æŸ¥è¯¢æ¡ä»¶)</h4>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- è‡ªå®šä¹‰å­—ç¬¦ä¸²çš„æˆªå–è§„åˆ™ --&gt;</span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Employee&gt; <span class="title">getEmpsByConditionTrim</span><span class="params">(Employee employee)</span></span>;</span><br><span class="line"></span><br><span class="line">&lt;trim prefix=<span class="string">"where"</span> suffixOverrides=<span class="string">"and"</span>&gt;</span><br><span class="line">	&lt;<span class="keyword">if</span> test=<span class="string">"id!=null"</span>&gt;</span><br><span class="line">		id=#&#123;id&#125; and</span><br><span class="line">	&lt;/if&gt;</span><br><span class="line">	&lt;<span class="keyword">if</span> test=<span class="string">"lastName!=null &amp;amp;&amp;amp; lastName!=&amp;quot;&amp;quot;"</span>&gt;</span><br><span class="line">		last_name like #&#123;lastName&#125; and</span><br><span class="line">	&lt;/if&gt;</span><br><span class="line">	&lt;<span class="keyword">if</span> test=<span class="string">"email!=null and email.trim()!=&amp;quot;&amp;quot;"</span>&gt;</span><br><span class="line">		email=#&#123;email&#125; and</span><br><span class="line">	&lt;/if&gt; </span><br><span class="line">	&lt;<span class="keyword">if</span> test=<span class="string">"gender==0 or gender==1"</span>&gt;</span><br><span class="line">	 	gender=#&#123;gender&#125;</span><br><span class="line">	&lt;/if&gt;</span><br><span class="line">&lt;/trim&gt;</span><br></pre></td></tr></table></figure>
<h4 id="set-å°è£…ä¿®æ”¹æ¡ä»¶">set (å°è£…ä¿®æ”¹æ¡ä»¶)</h4>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateEmp</span><span class="params">(Employee employee)</span></span>;</span><br><span class="line"></span><br><span class="line">&lt;update id=<span class="string">"updateEmp"</span>&gt;</span><br><span class="line">	&lt;!-- Setæ ‡ç­¾çš„ä½¿ç”¨ --&gt;</span><br><span class="line">	update tbl_employee </span><br><span class="line">	&lt;set&gt;</span><br><span class="line">		&lt;<span class="keyword">if</span> test=<span class="string">"lastName!=null"</span>&gt;</span><br><span class="line">			last_name=#&#123;lastName&#125;,</span><br><span class="line">		&lt;/if&gt;</span><br><span class="line">		&lt;<span class="keyword">if</span> test=<span class="string">"email!=null"</span>&gt;</span><br><span class="line">			email=#&#123;email&#125;,</span><br><span class="line">		&lt;/if&gt;</span><br><span class="line">		&lt;<span class="keyword">if</span> test=<span class="string">"gender!=null"</span>&gt;</span><br><span class="line">			gender=#&#123;gender&#125;</span><br><span class="line">		&lt;/if&gt;</span><br><span class="line">	&lt;/set&gt;</span><br><span class="line">	where id=#&#123;id&#125; </span><br><span class="line">&lt;/update&gt;</span><br></pre></td></tr></table></figure>
<hr>
<h4 id="trim-set-æ›´æ–°æ‹¼ä¸²">trim set ï¼ˆæ›´æ–°æ‹¼ä¸²ï¼‰</h4>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateEmp</span><span class="params">(Employee employee)</span></span>;</span><br><span class="line"></span><br><span class="line">&lt;update id=<span class="string">"updateEmp"</span>&gt;</span><br><span class="line">	&lt;!-- trimæ ‡ç­¾çš„ä½¿ç”¨ --&gt;</span><br><span class="line">	update tbl_employee </span><br><span class="line">	&lt;trim prefix=<span class="string">"set"</span> suffixOverrides=<span class="string">","</span>&gt;</span><br><span class="line">		&lt;<span class="keyword">if</span> test=<span class="string">"lastName!=null"</span>&gt;</span><br><span class="line">			last_name=#&#123;lastName&#125;,</span><br><span class="line">		&lt;/if&gt;</span><br><span class="line">		&lt;<span class="keyword">if</span> test=<span class="string">"email!=null"</span>&gt;</span><br><span class="line">			email=#&#123;email&#125;,</span><br><span class="line">		&lt;/if&gt;</span><br><span class="line">		&lt;<span class="keyword">if</span> test=<span class="string">"gender!=null"</span>&gt;</span><br><span class="line">			gender=#&#123;gender&#125;</span><br><span class="line">		&lt;/if&gt;</span><br><span class="line">	&lt;/trim&gt;</span><br><span class="line">	where id=#&#123;id&#125; </span><br><span class="line">&lt;/update&gt;</span><br></pre></td></tr></table></figure>
<hr>
<hr>
<h4 id="choose-when-otherwise-åˆ†æ”¯é€‰æ‹©">choose (when, otherwise) åˆ†æ”¯é€‰æ‹©</h4>
<ul>
<li>åƒå¸¦äº†breakçš„swtich-case</li>
<li>å¦‚æœå¸¦äº† id å°±ç”¨ id æŸ¥ï¼Œå¦‚æœå¸¦äº† lastName å°±ç”¨ lastName æŸ¥ï¼›åªä¼šè¿›å…¥å…¶ä¸­ä¸€ä¸ª</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Employee&gt; <span class="title">getEmpsByConditionChoose</span><span class="params">(Employee employee)</span></span>;</span><br><span class="line"></span><br><span class="line">&lt;select id=<span class="string">"getEmpsByConditionChoose"</span> resultType=<span class="string">"Employee"</span>&gt;</span><br><span class="line">	select * from tbl_employee </span><br><span class="line">	&lt;where&gt;</span><br><span class="line">		&lt;!-- å¦‚æœå¸¦äº†idå°±ç”¨idæŸ¥ï¼Œå¦‚æœå¸¦äº†lastNameå°±ç”¨lastNameæŸ¥;åªä¼šè¿›å…¥å…¶ä¸­ä¸€ä¸ª --&gt;</span><br><span class="line">		&lt;choose&gt;</span><br><span class="line">			&lt;when test=<span class="string">"id!=null"</span>&gt;</span><br><span class="line">				id=#&#123;id&#125;</span><br><span class="line">			&lt;/when&gt;</span><br><span class="line">			&lt;when test=<span class="string">"lastName!=null"</span>&gt;</span><br><span class="line">				last_name like #&#123;lastName&#125;</span><br><span class="line">			&lt;/when&gt;</span><br><span class="line">			&lt;when test=<span class="string">"email!=null"</span>&gt;</span><br><span class="line">				email = #&#123;email&#125;</span><br><span class="line">			&lt;/when&gt;</span><br><span class="line">			&lt;otherwise&gt;</span><br><span class="line">				gender = <span class="number">0</span></span><br><span class="line">			&lt;/otherwise&gt;</span><br><span class="line">		&lt;/choose&gt;</span><br><span class="line">	&lt;/where&gt;</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure>
<hr>
<hr>
<h4 id="foreach">foreach</h4>
<ul>
<li><strong>collectionï¼š</strong> æŒ‡å®šè¦éå†çš„é›†åˆã€‚listç±»å‹çš„å‚æ•°ä¼šç‰¹æ®Šå¤„ç†å°è£…åœ¨mapä¸­ï¼Œmapçš„keyå°±å«list</li>
<li><strong>itemï¼š</strong> å°†å½“å‰éå†å‡ºçš„å…ƒç´ èµ‹å€¼ç»™æŒ‡å®šçš„å˜é‡</li>
<li><strong>separatorï¼š</strong> æ¯ä¸ªå…ƒç´ ä¹‹é—´çš„åˆ†éš”ç¬¦</li>
<li><strong>openï¼š</strong> éå†å‡ºæ‰€æœ‰ç»“æœæ‹¼æ¥ä¸€ä¸ªå¼€å§‹çš„å­—ç¬¦</li>
<li><strong>closeï¼š</strong> éå†å‡ºæ‰€æœ‰ç»“æœæ‹¼æ¥ä¸€ä¸ªç»“æŸçš„å­—ç¬¦</li>
<li><strong>indexï¼š</strong> ç´¢å¼•ã€‚
<ul>
<li>éå†listçš„æ—¶å€™æ˜¯indexå°±æ˜¯ç´¢å¼•ï¼Œitemå°±æ˜¯å½“å‰å€¼ã€‚</li>
<li>éå†mapçš„æ—¶å€™indexè¡¨ç¤ºçš„å°±æ˜¯mapçš„keyï¼Œitemå°±æ˜¯mapçš„å€¼ã€‚</li>
</ul>
</li>
<li><strong>#{å˜é‡å}</strong> å°±èƒ½å–å‡ºå˜é‡çš„å€¼ä¹Ÿå°±æ˜¯å½“å‰éå†å‡ºçš„å…ƒç´ </li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Employee&gt; <span class="title">getEmpsByConditionForeach</span><span class="params">(List&lt;Integer&gt; ids)</span></span>;</span><br><span class="line"></span><br><span class="line">&lt;select id=<span class="string">"getEmpsByConditionForeach"</span> resultType=<span class="string">"Employee"</span>&gt;</span><br><span class="line">	select * from tbl_employee</span><br><span class="line">	&lt;foreach collection=<span class="string">"ids"</span> item=<span class="string">"item_id"</span> separator=<span class="string">","</span> open=<span class="string">"where id in("</span> close=<span class="string">")"</span>&gt;</span><br><span class="line">		#&#123;item_id&#125;</span><br><span class="line">	&lt;/foreach&gt;</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure>
<hr>
<hr>
<ul>
<li>
<p><strong>foreachæ‰¹é‡ä¿å­˜</strong></p>
</li>
<li>
<p>MySQLä¸‹æ‰¹é‡ä¿å­˜ï¼šå¯ä»¥foreachéå†ï¼ŒMysqlæ”¯æŒvalues(),(),()è¯­æ³•ã€‚Oracleä¸æ”¯æŒvalues(),(),()è¯­æ³•</p>
</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addEmps</span><span class="params">(@Param(<span class="string">"emps"</span>)</span>List&lt;Employee&gt; emps)</span>;</span><br><span class="line"></span><br><span class="line">&lt;!-- &lt;include refid=<span class="string">"insertColumn"</span>/&gt; å¼•ç”¨å¤–éƒ¨å®šä¹‰sqlç‰‡æ®µ --&gt;</span><br><span class="line">&lt;insert id=<span class="string">"addEmps"</span>&gt;</span><br><span class="line">	<span class="function">insert into <span class="title">tbl_employee</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">		&lt;include refid=<span class="string">"insertColumn"</span>&gt;&lt;/include&gt;</span></span></span><br><span class="line"><span class="function"><span class="params">	)</span> </span></span><br><span class="line"><span class="function">	values</span></span><br><span class="line"><span class="function">	&lt;foreach collection</span>=<span class="string">"emps"</span> item=<span class="string">"emp"</span> separator=<span class="string">","</span>&gt;</span><br><span class="line">		(#&#123;emp.lastName&#125;,#&#123;emp.email&#125;,#&#123;emp.gender&#125;,#&#123;emp.dept.id&#125;)</span><br><span class="line">	&lt;/foreach&gt;</span><br><span class="line">&lt;/insert&gt;</span><br></pre></td></tr></table></figure>
<hr>
<ul>
<li>è¿™ç§æ–¹å¼éœ€è¦æ•°æ®åº“è¿æ¥å±æ€§ allowMultiQueries=trueï¼›</li>
<li>è¿™ç§åˆ†å·åˆ†éš”å¤šä¸ªsqlå¯ä»¥ç”¨äºå…¶ä»–çš„æ‰¹é‡æ“ä½œï¼ˆåˆ é™¤ï¼Œä¿®æ”¹ï¼‰</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"addEmps"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">"emps"</span> <span class="attr">item</span>=<span class="string">"emp"</span> <span class="attr">separator</span>=<span class="string">";"</span>&gt;</span></span><br><span class="line">		insert into tbl_employee(last_name,email,gender,d_id)</span><br><span class="line">		values(#&#123;emp.lastName&#125;,#&#123;emp.email&#125;,#&#123;emp.gender&#125;,#&#123;emp.dept.id&#125;)</span><br><span class="line">	<span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>
<hr>
<hr>
<h3 id="ä¸¤ä¸ªå†…ç½®å‚æ•°">ä¸¤ä¸ªå†…ç½®å‚æ•°</h3>
<ul>
<li>ä¸åªæ˜¯æ–¹æ³•ä¼ é€’è¿‡æ¥çš„å‚æ•°å¯ä»¥è¢«ç”¨æ¥åˆ¤æ–­ï¼Œå–å€¼ã€‚</li>
<li><strong>mybatisé»˜è®¤è¿˜æœ‰ä¸¤ä¸ªå†…ç½®å‚æ•°ï¼š</strong>
<ul>
<li><strong>_parameterï¼š</strong> ä»£è¡¨æ•´ä¸ªå‚æ•°ã€‚
<ul>
<li>å•ä¸ªå‚æ•°ï¼š_parameterå°±æ˜¯è¿™ä¸ªå‚æ•°ã€‚</li>
<li>å¤šä¸ªå‚æ•°ï¼šå‚æ•°ä¼šè¢«å°è£…ä¸ºä¸€ä¸ªmapï¼›<strong>_parameter å°±æ˜¯ä»£è¡¨è¿™ä¸ªmapã€‚</strong></li>
</ul>
</li>
<li><strong>_databaseIdï¼š</strong> å¦‚æœé…ç½®äº†databaseIdProvideræ ‡ç­¾ã€‚
<ul>
<li>_databaseIdå°±æ˜¯ä»£è¡¨å½“å‰æ•°æ®åº“çš„åˆ«å oracle | mysqlã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Employee&gt; <span class="title">getEmpsTestInnerParameter</span><span class="params">(Employee employee)</span></span>;</span><br><span class="line"></span><br><span class="line">&lt;select id=<span class="string">"getEmpsTestInnerParameter"</span> resultType=<span class="string">"Employee"</span>&gt;</span><br><span class="line">	&lt;!-- bindï¼šå¯ä»¥å°†OGNLè¡¨è¾¾å¼çš„å€¼ç»‘å®šåˆ°ä¸€ä¸ªå˜é‡ä¸­ï¼Œæ–¹ä¾¿åæ¥å¼•ç”¨è¿™ä¸ªå˜é‡çš„å€¼ --&gt;</span><br><span class="line">	&lt;bind name=<span class="string">"_lastName"</span> value=<span class="string">"'%'+lastName+'%'"</span>/&gt;</span><br><span class="line">	&lt;<span class="keyword">if</span> test=<span class="string">"_databaseId=='mysql'"</span>&gt;</span><br><span class="line">		select * from tbl_employee</span><br><span class="line">		&lt;<span class="keyword">if</span> test=<span class="string">"_parameter!=null"</span>&gt;</span><br><span class="line">			where last_name like #&#123;lastName&#125;</span><br><span class="line">		&lt;/if&gt;</span><br><span class="line">	&lt;/if&gt;</span><br><span class="line">	&lt;<span class="keyword">if</span> test=<span class="string">"_databaseId=='oracle'"</span>&gt;</span><br><span class="line">		select * from employees</span><br><span class="line">		&lt;<span class="keyword">if</span> test=<span class="string">"_parameter!=null"</span>&gt;</span><br><span class="line">			where last_name like #&#123;_parameter.lastName&#125;</span><br><span class="line">		&lt;/if&gt;</span><br><span class="line">	&lt;/if&gt;</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure>
<hr>
<p><strong>sql</strong> æ ‡ç­¾</p>
<ul>
<li>
<p>æŠ½å–å¯é‡ç”¨çš„sqlç‰‡æ®µï¼Œæ–¹ä¾¿åé¢å¼•ç”¨</p>
</li>
<li>
<p>sqlæŠ½å– ç»å¸¸å°†è¦æŸ¥è¯¢çš„åˆ—åï¼Œæˆ–è€…æ’å…¥ç”¨çš„åˆ—åæŠ½å–å‡ºæ¥æ–¹ä¾¿å¼•ç”¨</p>
<ul>
<li>include æ ‡ç­¾æ¥å¼•ç”¨å·²ç»æŠ½å–çš„sqlï¼š
<ul>
<li>idï¼šå”¯ä¸€idæ–¹ä¾¿å¼•ç”¨ï¼›</li>
</ul>
</li>
<li>include è¿˜å¯ä»¥è‡ªå®šä¹‰ä¸€äº›propertyï¼Œsqlæ ‡ç­¾å†…éƒ¨å°±èƒ½ä½¿ç”¨è‡ªå®šä¹‰çš„å±æ€§
<ul>
<li>include-propertyï¼šå–å€¼çš„æ­£ç¡®æ–¹å¼ ${prop}</li>
<li>#{ä¸èƒ½ä½¿ç”¨è¿™ç§æ–¹å¼}</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">sql</span> <span class="attr">id</span>=<span class="string">"insertColumn"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"_databaseId=='mysql'"</span>&gt;</span></span><br><span class="line">		last_name,email,gender,d_id</span><br><span class="line">	<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"_databaseId=='oracle'"</span>&gt;</span></span><br><span class="line">		employee_id,last_name,email,$&#123;prop&#125;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">sql</span>&gt;</span></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="å…­-mybatis-ç¼“å­˜">å…­ã€Mybatis ç¼“å­˜</h2>
<p><strong>MyBatis ç³»ç»Ÿä¸­é»˜è®¤å®šä¹‰äº†ä¸¤çº§ç¼“å­˜ã€‚</strong></p>
<h3 id="ä¸€çº§ç¼“å­˜-æœ¬åœ°ç¼“å­˜">ä¸€çº§ç¼“å­˜ (æœ¬åœ°ç¼“å­˜)</h3>
<ul>
<li>é»˜è®¤æƒ…å†µä¸‹ï¼Œåªæœ‰ä¸€çº§ç¼“å­˜( SqlSessionçº§åˆ«çš„ç¼“å­˜ Map) <strong>é»˜è®¤å¼€å¯</strong>ã€‚</li>
<li>ä¸€çº§ç¼“å­˜å¤±æ•ˆæƒ…å†µï¼ˆæ²¡æœ‰ä½¿ç”¨åˆ°å½“å‰ä¸€çº§ç¼“å­˜çš„æƒ…å†µï¼Œæ•ˆæœå°±æ˜¯è¿˜éœ€è¦å†å‘æ•°æ®åº“å‘å‡ºæŸ¥è¯¢ï¼‰
<ul>
<li>1ã€sqlSessionä¸åŒï¼Œä¸€çº§ç¼“å­˜ä¸åŒã€‚</li>
<li>2ã€sqlSessionç›¸åŒï¼ŒæŸ¥è¯¢æ¡ä»¶ä¸åŒã€‚(å½“å‰ä¸€çº§ç¼“å­˜ä¸­è¿˜æ²¡æœ‰è¿™ä¸ªæ•°æ®)</li>
<li>3ã€sqlSessionç›¸åŒï¼Œä¸¤æ¬¡æŸ¥è¯¢ä¹‹é—´æ‰§è¡Œäº†å¢åˆ æ”¹æ“ä½œ(è¿™æ¬¡å¢åˆ æ”¹å¯èƒ½å¯¹å½“å‰æ•°æ®æœ‰å½±å“)</li>
<li>4ã€sqlSessionç›¸åŒï¼Œæ‰‹åŠ¨æ¸…é™¤äº†ä¸€çº§ç¼“å­˜ openSession.clearCache();ï¼ˆç¼“å­˜æ¸…ç©ºï¼‰</li>
</ul>
</li>
</ul>
<hr>
<hr>
<h3 id="äºŒçº§ç¼“å­˜-å…¨å±€ç¼“å­˜">äºŒçº§ç¼“å­˜ (å…¨å±€ç¼“å­˜)</h3>
<ul>
<li>äºŒçº§ç¼“å­˜éœ€è¦æ‰‹åŠ¨å¼€å¯å’Œé…ç½®ï¼Œä»–æ˜¯åŸºäº namespace çº§åˆ«çš„ç¼“å­˜ã€‚</li>
<li>åªæœ‰ XxxMapper.xml ä½¿ç”¨äº† <strong>&lt; cache&gt;&lt; /cache&gt;</strong>ï¼Œæ‰ä¼šå¼€å¯äºŒçº§ç¼“å­˜ã€‚</li>
</ul>
<hr>
<p><strong>å·¥ä½œæœºåˆ¶ï¼š</strong></p>
<ul>
<li>1ã€ä¸€ä¸ªä¼šè¯ï¼ŒæŸ¥è¯¢ä¸€æ¡æ•°æ®ï¼Œè¿™ä¸ªæ•°æ®å°±ä¼šè¢«æ”¾åœ¨å½“å‰ä¼šè¯çš„ä¸€çº§ç¼“å­˜ä¸­ï¼›</li>
<li>2ã€<strong>å¼€å¯äºŒçº§ç¼“å­˜åã€‚</strong></li>
<li>3ã€<strong>åªæœ‰ä¼šè¯å…³é—­ï¼›ä¸€çº§ç¼“å­˜ä¸­çš„æ•°æ®ä¼šè¢«ä¿å­˜åˆ°äºŒçº§ç¼“å­˜ä¸­ï¼›æ–°çš„ä¼šè¯æŸ¥è¯¢ä¿¡æ¯ï¼Œå°±å¯ä»¥å‚ç…§äºŒçº§ç¼“å­˜ä¸­çš„å†…å®¹ï¼›</strong></li>
<li>4ã€ä¸åŒ namespace æŸ¥å‡ºçš„æ•°æ®ä¼šæ”¾åœ¨è‡ªå·±å¯¹åº”çš„ç¼“å­˜ä¸­(Map)ï¼›</li>
<li><strong>ä¸€ä¸ª namespace å¯¹åº”ä¸€ä¸ªäºŒçº§ç¼“å­˜ã€‚</strong></li>
</ul>
<hr>
<p><strong>ä½¿ç”¨ï¼š</strong></p>
<ul>
<li><strong>1ã€<strong>å¼€å¯å…¨å±€äºŒçº§ç¼“å­˜é…ç½®ï¼š</strong> &lt; setting name=â€œcacheEnabledâ€ value=â€œtrueâ€/&gt;</strong></li>
<li><strong>2ã€<strong>å»</strong> mapper.xml</strong> ä¸­é…ç½®ä½¿ç”¨äºŒçº§ç¼“å­˜ï¼š<strong>&lt; cache&gt;&lt; /cache&gt;</strong>
<ul>
<li><strong>evictionï¼š</strong> ç¼“å­˜çš„å›æ”¶ç­–ç•¥
<ul>
<li>LRU â€“ æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„ï¼šç§»é™¤æœ€é•¿æ—¶é—´ä¸è¢«ä½¿ç”¨çš„å¯¹è±¡ã€‚</li>
<li>FIFO â€“ å…ˆè¿›å…ˆå‡ºï¼šæŒ‰å¯¹è±¡è¿›å…¥ç¼“å­˜çš„é¡ºåºæ¥ç§»é™¤å®ƒä»¬ã€‚</li>
<li>SOFT â€“ è½¯å¼•ç”¨ï¼šç§»é™¤åŸºäºåƒåœ¾å›æ”¶å™¨çŠ¶æ€å’Œè½¯å¼•ç”¨è§„åˆ™çš„å¯¹è±¡ã€‚</li>
<li>WEAK â€“ å¼±å¼•ç”¨ï¼šæ›´ç§¯æåœ°ç§»é™¤åŸºäºåƒåœ¾æ”¶é›†å™¨çŠ¶æ€å’Œå¼±å¼•ç”¨è§„åˆ™çš„å¯¹è±¡ã€‚</li>
<li>é»˜è®¤çš„æ˜¯ LRUã€‚</li>
</ul>
</li>
<li><strong>flushIntervalï¼š</strong> ç¼“å­˜åˆ·æ–°é—´éš” ã€‚ç¼“å­˜å¤šé•¿æ—¶é—´æ¸…ç©ºä¸€æ¬¡ï¼Œé»˜è®¤ä¸æ¸…ç©ºï¼Œè®¾ç½®ä¸€ä¸ªæ¯«ç§’å€¼ã€‚</li>
<li><strong>readOnlyï¼š</strong> æ˜¯å¦åªè¯»ã€‚
<ul>
<li><strong>trueï¼šåªè¯»</strong> Mybatisè®¤ä¸ºæ‰€æœ‰ä»ç¼“å­˜ä¸­è·å–æ•°æ®çš„æ“ä½œéƒ½æ˜¯åªè¯»æ“ä½œä¸ä¼šä¿®æ”¹æ•°æ®ã€‚
<ul>
<li>ä¸ºäº†åŠ å¿«è·å–é€Ÿåº¦ï¼Œç›´æ¥å°±å°†æ•°æ®åœ¨ç¼“å­˜ä¸­çš„å¼•ç”¨äº¤ç»™ç”¨æˆ·ã€‚ä¸å®‰å…¨ï¼Œé€Ÿåº¦å¿«</li>
</ul>
</li>
<li><strong>falseï¼šéåªè¯»</strong> Mybatisè§‰å¾—è·å–çš„æ•°æ®å¯èƒ½ä¼šè¢«ä¿®æ”¹ã€‚
<ul>
<li>ä¼šåˆ©ç”¨åºåˆ—åŒ– &amp; ååºåˆ—çš„æŠ€æœ¯å…‹éš†ä¸€ä»½æ–°çš„æ•°æ®ç»™ä½ ã€‚å®‰å…¨ï¼Œé€Ÿåº¦æ…¢ã€‚</li>
</ul>
</li>
</ul>
</li>
<li><strong>sizeï¼š</strong> ç¼“å­˜å­˜æ”¾å¤šå°‘å…ƒç´ ã€‚</li>
<li><strong>type=&quot;&quot;ï¼š</strong> æŒ‡å®šè‡ªå®šä¹‰ç¼“å­˜çš„å…¨ç±»åï¼›å®ç° Cache æ¥å£å³å¯ã€‚</li>
</ul>
</li>
<li><strong>3ã€ POJOéœ€è¦å®ç°åºåˆ—åŒ–æ¥å£ã€‚</strong></li>
</ul>
<hr>
<p><strong>æ•ˆæœï¼š</strong></p>
<ul>
<li>æ•°æ®ä¼šä»äºŒçº§ç¼“å­˜ä¸­è·å– æŸ¥å‡ºçš„æ•°æ®éƒ½ä¼šè¢«é»˜è®¤å…ˆæ”¾åœ¨ä¸€çº§ç¼“å­˜ä¸­ã€‚</li>
<li>åªæœ‰ä¼šè¯æäº¤æˆ–è€…å…³é—­ä»¥åï¼Œä¸€çº§ç¼“å­˜ä¸­çš„æ•°æ®æ‰ä¼šè½¬ç§»åˆ°äºŒçº§ç¼“å­˜ä¸­ã€‚</li>
</ul>
<hr>
<p><strong>å’Œç¼“å­˜æœ‰å…³çš„è®¾ç½®(å±æ€§)ï¼š</strong></p>
<ul>
<li><strong>cacheEnabled = true|falseï¼š</strong> å…³é—­ç¼“å­˜ï¼ˆäºŒçº§ç¼“å­˜å…³é—­ï¼‰(ä¸€çº§ç¼“å­˜ä¸€ç›´å¯ç”¨)</li>
<li><strong>æ¯ä¸ªselectæ ‡ç­¾éƒ½æœ‰ useCache=â€œtrueâ€ã€‚</strong> falseï¼šä¸ä½¿ç”¨ç¼“å­˜ï¼ˆä¸€çº§ç¼“å­˜ä¾ç„¶ä½¿ç”¨ï¼ŒäºŒçº§ç¼“å­˜å…³é—­ï¼‰</li>
<li><strong>æ¯ä¸ª å¢ åˆ  æ”¹ æ ‡ç­¾éƒ½æœ‰ï¼šflushCache=â€œtrueâ€ï¼š</strong>
<ul>
<li><code>ï¼ˆä¸€çº§äºŒçº§éƒ½ä¼šæ¸…é™¤ï¼‰å¢åˆ æ”¹æ‰§è¡Œå®Œæˆåå°±ä¼šæ¸…é™¤ç¼“å­˜ï¼›</code></li>
<li>æµ‹è¯•ï¼šflushCache=â€œtrueâ€ï¼šä¸€çº§ç¼“å­˜æ¸…é™¤ï¼›äºŒçº§ä¹Ÿä¼šè¢«æ¸…é™¤ï¼›</li>
<li>æŸ¥è¯¢æ ‡ç­¾é»˜è®¤ï¼šflushCache=â€œfalseâ€ï¼š å¦‚æœæŸ¥è¯¢æ ‡ç­¾ flushCache=true; æ¯æ¬¡æŸ¥è¯¢ä¹‹åéƒ½ä¼šæ¸…ç©ºç¼“å­˜ï¼›ç¼“å­˜æ˜¯æ²¡æœ‰è¢«ä½¿ç”¨çš„ï¼›</li>
</ul>
</li>
<li><strong>sqlSession.clearCache();</strong> åªæ˜¯æ¸…é™¤ å½“å‰ Session çš„ä¸€çº§ç¼“å­˜ï¼›</li>
<li><strong>localCacheScopeï¼šæœ¬åœ°ç¼“å­˜ä½œç”¨åŸŸï¼ˆä¸€çº§ç¼“å­˜SESSIONï¼‰ï¼›</strong> å½“å‰ä¼šè¯çš„æ‰€æœ‰æ•°æ®ä¿å­˜åœ¨ä¼šè¯ç¼“å­˜ä¸­ï¼›STATEMENTï¼šå¯ä»¥ç¦ç”¨ä¸€çº§ç¼“å­˜ï¼›</li>
</ul>
<hr>
<p><strong>ä¸ºäº†æé«˜æ‰©å±•æ€§ã€‚MyBatiså®šä¹‰äº†ç¼“å­˜æ¥å£Cacheã€‚å¯ä»¥é€šè¿‡å®ç°Cacheæ¥å£æ¥è‡ªå®šä¹‰äºŒçº§ç¼“å­˜ã€‚</strong></p>
<p><a href="https://github.com/mybatis" target="_blank" rel="noopener">æ•´åˆ èµ„æº</a></p>
<ul>
<li>
<p><strong>ç¬¬ä¸‰æ–¹ç¼“å­˜æ•´åˆï¼š</strong></p>
<ul>
<li>å¯¼å…¥ç¬¬ä¸‰æ–¹ç¼“å­˜åŒ…å³å¯ï¼›</li>
<li>å¯¼å…¥ä¸ç¬¬ä¸‰æ–¹ç¼“å­˜æ•´åˆçš„é€‚é…åŒ…ï¼›
<ul>
<li>mybatis-ehcache-1.0.3.jar</li>
<li>ehcache-core-2.6.8.jar</li>
<li>slf4j-api-1.6.1.jar</li>
<li>slf4j-log4j12-1.6.2.jar</li>
</ul>
</li>
<li>mapper.xmlä¸­ä½¿ç”¨è‡ªå®šä¹‰ç¼“å­˜ &lt; cache type=â€œorg.mybatis.caches.ehcache.EhcacheCacheâ€&gt;</li>
</ul>
</li>
<li>
<p><strong>ehcache.xml</strong></p>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">ehcache</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag"> <span class="attr">xsi:noNamespaceSchemaLocation</span>=<span class="string">"../config/ehcache.xsd"</span>&gt;</span></span><br><span class="line"> <span class="comment">&lt;!-- ç£ç›˜ä¿å­˜è·¯å¾„ --&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">diskStore</span> <span class="attr">path</span>=<span class="string">"D:\ehcache"</span> /&gt;</span></span><br><span class="line"> </span><br><span class="line"> <span class="tag">&lt;<span class="name">defaultCache</span> </span></span><br><span class="line"><span class="tag">   <span class="attr">maxElementsInMemory</span>=<span class="string">"10000"</span> </span></span><br><span class="line"><span class="tag">   <span class="attr">maxElementsOnDisk</span>=<span class="string">"10000000"</span></span></span><br><span class="line"><span class="tag">   <span class="attr">eternal</span>=<span class="string">"false"</span> </span></span><br><span class="line"><span class="tag">   <span class="attr">overflowToDisk</span>=<span class="string">"true"</span> </span></span><br><span class="line"><span class="tag">   <span class="attr">timeToIdleSeconds</span>=<span class="string">"120"</span></span></span><br><span class="line"><span class="tag">   <span class="attr">timeToLiveSeconds</span>=<span class="string">"120"</span> </span></span><br><span class="line"><span class="tag">   <span class="attr">diskExpiryThreadIntervalSeconds</span>=<span class="string">"120"</span></span></span><br><span class="line"><span class="tag">   <span class="attr">memoryStoreEvictionPolicy</span>=<span class="string">"LRU"</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">defaultCache</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ehcache</span>&gt;</span></span><br></pre></td></tr></table></figure>
<img src="http://ww1.sinaimg.cn/large/006vWPzFly1g1sstg81e2j31130l0got.jpg" width="900">
<hr>
<h2 id="ä¸ƒ-é€†å‘å·¥ç¨‹-mbg">ä¸ƒã€é€†å‘å·¥ç¨‹ (MBG)</h2>
<p><a href="https://github.com/mybatis/generator" target="_blank" rel="noopener">GitHub generator æ–‡æ¡£</a></p>
<p><strong>éœ€è¦ Jar åŒ…</strong></p>
<ul>
<li><strong>mybatis-generator-core-1.3.7.jar</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.generator.api.MyBatisGenerator;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.generator.config.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.generator.config.xml.ConfigurationParser;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.generator.internal.DefaultShellCallback;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBatisTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> SqlSessionFactory <span class="title">getSqlSessionFactory</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		String resource = <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">		InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testMbg</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		List&lt;String&gt; warnings = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">		<span class="keyword">boolean</span> overwrite = <span class="keyword">true</span>;</span><br><span class="line">		File configFile = <span class="keyword">new</span> File(<span class="string">"mbg.xml"</span>);</span><br><span class="line">		ConfigurationParser cp = <span class="keyword">new</span> ConfigurationParser(warnings);</span><br><span class="line">		Configuration config = cp.parseConfiguration(configFile);</span><br><span class="line">		DefaultShellCallback callback = <span class="keyword">new</span> DefaultShellCallback(overwrite);</span><br><span class="line">		MyBatisGenerator myBatisGenerator = <span class="keyword">new</span> MyBatisGenerator(config,</span><br><span class="line">				callback, warnings);</span><br><span class="line">		myBatisGenerator.generate(<span class="keyword">null</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="meta">&lt;!DOCTYPE generatorConfiguration PUBLIC "-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN"</span></span><br><span class="line"><span class="meta">  "http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd"&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">generatorConfiguration</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">context</span> <span class="attr">id</span>=<span class="string">"DB2Tables"</span> <span class="attr">targetRuntime</span>=<span class="string">"MyBatis3"</span>&gt;</span></span><br><span class="line">  	<span class="comment">&lt;!-- jdbcConnectionï¼šæŒ‡å®šå¦‚ä½•è¿æ¥åˆ°ç›®æ ‡æ•°æ®åº“ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">jdbcConnection</span> </span></span><br><span class="line"><span class="tag">    	<span class="attr">driverClass</span>=<span class="string">"com.mysql.jdbc.Driver"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">connectionURL</span>=<span class="string">"jdbc:mysql://localhost:3306/mybatis?allowMultiQueries=true"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">userId</span>=<span class="string">"root"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">password</span>=<span class="string">"root"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">jdbcConnection</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- é»˜è®¤ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">javaTypeResolver</span> &gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"forceBigDecimals"</span> <span class="attr">value</span>=<span class="string">"false"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">javaTypeResolver</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">	javaModelGeneratorï¼šæŒ‡å®šjavaBeançš„ç”Ÿæˆç­–ç•¥ </span></span><br><span class="line"><span class="comment">	targetPackage="test.model"ï¼šç›®æ ‡åŒ…å</span></span><br><span class="line"><span class="comment">	targetProject="\MBGTestProject\src"ï¼šç›®æ ‡å·¥ç¨‹</span></span><br><span class="line"><span class="comment">	--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">javaModelGenerator</span> <span class="attr">targetPackage</span>=<span class="string">"mybatis.bean"</span> <span class="attr">targetProject</span>=<span class="string">".\src"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"enableSubPackages"</span> <span class="attr">value</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"trimStrings"</span> <span class="attr">value</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">javaModelGenerator</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- sqlMapGeneratorï¼šsqlæ˜ å°„ç”Ÿæˆç­–ç•¥ï¼š --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">sqlMapGenerator</span> <span class="attr">targetPackage</span>=<span class="string">"mybatis.dao"</span> <span class="attr">targetProject</span>=<span class="string">".\conf"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"enableSubPackages"</span> <span class="attr">value</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">sqlMapGenerator</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- javaClientGenerator:æŒ‡å®šmapperæ¥å£æ‰€åœ¨çš„ä½ç½® --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">javaClientGenerator</span> <span class="attr">type</span>=<span class="string">"XMLMAPPER"</span> <span class="attr">targetPackage</span>=<span class="string">"mybatis.dao"</span> <span class="attr">targetProject</span>=<span class="string">".\src"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"enableSubPackages"</span> <span class="attr">value</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">javaClientGenerator</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- æŒ‡å®šè¦é€†å‘åˆ†æå“ªäº›è¡¨ï¼šæ ¹æ®è¡¨è¦åˆ›å»ºjavaBean --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">"tbl_employee"</span> <span class="attr">domainObjectName</span>=<span class="string">"Employee"</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">context</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">generatorConfiguration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>æŒ‰ç…§æ¡ä»¶æŸ¥è¯¢(QBCæŸ¥è¯¢)</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">EmployeeMapper mapper = openSession.getMapper(EmployeeMapper.class);</span><br><span class="line">EmployeeExample example = <span class="keyword">new</span> EmployeeExample();</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ‰€æœ‰çš„ and æ”¾åœ¨ç¬¬ä¸€ä¸ª criteria é‡Œé¢</span></span><br><span class="line">Criteria criteria = example.createCriteria();</span><br><span class="line">criteria.andLastNameLike(<span class="string">"%e%"</span>);</span><br><span class="line">criteria.andGenderEqualTo(<span class="string">"1"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//éœ€è¦ or çš„æ”¾åœ¨ç¬¬äºŒä¸ª criteria é‡Œé¢</span></span><br><span class="line">Criteria criteria2 = example.createCriteria();</span><br><span class="line">criteria2.andEmailLike(<span class="string">"%e%"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//æœ€å or é“¾æ¥ä¸¤ä¸ªæ¡ä»¶</span></span><br><span class="line">example.or(criteria2);</span><br><span class="line"></span><br><span class="line">List&lt;Employee&gt; list = mapper.selectByExample(example);</span><br><span class="line"><span class="keyword">for</span> (Employee employee : list) &#123;</span><br><span class="line">	System.out.println(employee.getId());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="å…«-spring-æ•´åˆ-mybatis">å…«ã€Spring æ•´åˆ Mybatis</h2>
<p><a href="https://github.com/mybatis/jpetstore-6" target="_blank" rel="noopener">GitHub æ•´åˆç¤ºä¾‹ jpetstore-6</a><br>
<strong>ç›®çš„ï¼š</strong></p>
<ul>
<li>1ã€Spring ç®¡ç†æ‰€æœ‰ç»„ä»¶ã€‚mapperçš„å®ç°ç±»ã€‚service==&gt;Dao  @Autowired:è‡ªåŠ¨æ³¨å…¥mapperï¼›</li>
<li>2ã€Spring ç”¨æ¥ç®¡ç†äº‹åŠ¡ï¼Œspringå£°æ˜å¼äº‹åŠ¡ã€‚</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--åˆ›å»ºå‡ºSqlSessionFactoryå¯¹è±¡  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"sqlSessionFactoryBean"</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.SqlSessionFactoryBean"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- configLocationæŒ‡å®šå…¨å±€é…ç½®æ–‡ä»¶çš„ä½ç½® --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"configLocation"</span> <span class="attr">value</span>=<span class="string">"classpath:mybatis-config.xml"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!--mapperLocations: æŒ‡å®šmapperæ–‡ä»¶çš„ä½ç½® å¦‚æœä¸å’Œæ¥å£åŒ…åŒåï¼Œéœ€è¦é…ç½®--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"mapperLocations"</span> <span class="attr">value</span>=<span class="string">"classpath:mybatis/mapper/*.xml"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- æ‰«ææ‰€æœ‰çš„mapperæ¥å£çš„å®ç°ï¼Œè®©è¿™äº›mapperèƒ½å¤Ÿè‡ªåŠ¨æ³¨å…¥ï¼›base-packageï¼šæŒ‡å®šmapperæ¥å£çš„åŒ…å --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mybatis-spring:scan</span> <span class="attr">base-package</span>=<span class="string">"mybatis.dao"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- åŠŸèƒ½ åŒä¸Š</span></span><br><span class="line"><span class="comment">&lt;bean class="org.mybatis.spring.mapper.MapperScannerConfigurer"&gt;</span></span><br><span class="line"><span class="comment">	&lt;property name="basePackage" value="mybatis.dao"&gt;&lt;/property&gt;</span></span><br><span class="line"><span class="comment">&lt;/bean&gt;</span></span><br><span class="line"><span class="comment"> --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- é…ç½®ä¸€ä¸ªå¯ä»¥è¿›è¡Œæ‰¹é‡æ‰§è¡Œçš„sqlSession  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"sqlSession"</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.SqlSessionTemplate"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">"sqlSessionFactory"</span> <span class="attr">ref</span>=<span class="string">"sqlSessionFactoryBean"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">"executorType"</span> <span class="attr">value</span>=<span class="string">"BATCH"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<hr>
<hr>
<h2 id="ä¹-mybatis-å·¥ä½œåŸç†">ä¹ã€Mybatis å·¥ä½œåŸç†</h2>
<p><strong>åˆ†å±‚æ¡†æ¶</strong><br>
<img src="http://ww1.sinaimg.cn/large/006vWPzFly1g1swzcw9ioj30s20k8wim.jpg" width="800"></p>
<p><strong>ä»¥åè¡¥å……</strong></p>
<p>â€¦</p>
<h2 id="æ’ä»¶å¼€å‘">æ’ä»¶å¼€å‘</h2>
<p>â€¦</p>
<p><strong>PageHelper</strong></p>
<p><a href="https://github.com/pagehelper/Mybatis-PageHelper/blob/master/wikis/zh/HowToUse.md" target="_blank" rel="noopener">åˆ†é¡µæ’ä»¶ ä½¿ç”¨æ–¹æ³•</a></p>
<ul>
<li>
<p><strong>jaråŒ…</strong></p>
<ul>
<li>jsqlparser-0.9.5.jar</li>
<li>pagehelper-5.0.0-rc.jar</li>
</ul>
</li>
<li>
<p>mybatis-config.xml é…ç½®æ’ä»¶</p>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">plugin</span> <span class="attr">interceptor</span>=<span class="string">"com.github.pagehelper.PageInterceptor"</span>&gt;</span><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br></pre></td></tr></table></figure>
<hr>
<p><strong>ä½¿ç”¨æ–¹æ³•</strong></p>
<ul>
<li>Mapperæ¥å£æ–¹å¼çš„è°ƒç”¨ï¼Œæ¨èè¿™ç§ä½¿ç”¨æ–¹å¼ã€‚</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Page&lt;Object&gt; page = PageHelper.startPage(<span class="number">1</span>, <span class="number">5</span>);</span><br><span class="line">List&lt;Country&gt; list = countryMapper.selectIf(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">page.xxx();</span><br><span class="line">å…³äºä¸ªä¸­ page çš„ä¿¡æ¯ã€‚</span><br></pre></td></tr></table></figure>
<hr>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//list æŸ¥è¯¢çš„ç»“æœé›†ï¼› ç¬¬äºŒä¸ªå‚æ•° ä¼ å…¥è¿ç»­æ˜¾ç¤ºå‡ é¡µ</span></span><br><span class="line">PageInfo info = <span class="keyword">new</span> PageInfo(listï¼Œ<span class="number">5</span>);</span><br><span class="line"><span class="comment">//æµ‹è¯•PageInfoå…¨éƒ¨å±æ€§</span></span><br><span class="line"><span class="comment">//PageInfoåŒ…å«äº†éå¸¸å…¨é¢çš„åˆ†é¡µå±æ€§</span></span><br><span class="line">info.getPageNum();</span><br><span class="line">info.getPageSize();</span><br><span class="line">info.getStartRow();</span><br><span class="line">info.getEndRow();</span><br><span class="line">info.getTotal();</span><br><span class="line">info.getPages();</span><br><span class="line">info.getFirstPage();</span><br><span class="line">info.getLastPage();</span><br><span class="line">info.isFirstPage();</span><br><span class="line">info.isLastPage();</span><br><span class="line">info.isHasPreviousPage();</span><br><span class="line">info.isHasNextPage();</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="æ‰¹é‡å¤„ç†">æ‰¹é‡å¤„ç†</h2>
<ul>
<li>æ‰¹é‡ï¼šï¼ˆé¢„ç¼–è¯‘sql (1æ¬¡) ==&gt;è®¾ç½®å‚æ•°===&gt;10000æ¬¡===&gt;æ‰§è¡Œï¼ˆ1æ¬¡ï¼‰ï¼‰</li>
<li>éæ‰¹é‡ï¼šï¼ˆé¢„ç¼–è¯‘sql=è®¾ç½®å‚æ•°=æ‰§è¡Œï¼‰==&gt; 10000 æ¬¡</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testBatch</span><span class="params">()</span> <span class="keyword">throws</span> IOException</span>&#123;</span><br><span class="line">	SqlSessionFactory sqlSessionFactory = getSqlSessionFactory();</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//å¯ä»¥æ‰§è¡Œæ‰¹é‡æ“ä½œçš„sqlSession</span></span><br><span class="line">	SqlSession openSession = sqlSessionFactory.openSession(ExecutorType.BATCH);</span><br><span class="line">	<span class="keyword">long</span> start = System.currentTimeMillis();</span><br><span class="line">	<span class="keyword">try</span>&#123;</span><br><span class="line">		EmployeeMapper mapper = openSession.getMapper(EmployeeMapper.class);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10000</span>; i++) &#123;</span><br><span class="line">			mapper.addEmp(<span class="keyword">new</span> Employee(UUID.randomUUID().toString().substring(<span class="number">0</span>, <span class="number">5</span>), <span class="string">"b"</span>, <span class="string">"1"</span>));</span><br><span class="line">		&#125;</span><br><span class="line">		openSession.commit();</span><br><span class="line">		<span class="keyword">long</span> end = System.currentTimeMillis();</span><br><span class="line">		System.out.println(<span class="string">"æ‰§è¡Œæ—¶é•¿ï¼š"</span>+(end-start));</span><br><span class="line">	&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">		openSession.close();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>åœ¨ Spring ä¸­ è®¾ç½® æ‰¹é‡ sqlSession</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- é…ç½®ä¸€ä¸ªå¯ä»¥è¿›è¡Œæ‰¹é‡æ‰§è¡Œçš„sqlSession  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"sqlSession"</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.SqlSessionTemplate"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">"sqlSessionFactory"</span> <span class="attr">ref</span>=<span class="string">"sqlSessionFactoryBean"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">"executorType"</span> <span class="attr">value</span>=<span class="string">"BATCH"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="æ„Ÿè°¢é˜…è¯»">æ„Ÿè°¢é˜…è¯»</h1>

                

                <hr>
                <!-- Pager -->
                <ul class="pager">
                    
                        <li class="previous">
                            <a href="/article/Maven/" data-toggle="tooltip" data-placement="top" title="Maven ä½¿ç”¨">&larr; Previous Post</a>
                        </li>
                    
                    
                        <li class="next">
                            <a href="/article/SpringMVC/" data-toggle="tooltip" data-placement="top" title="SpringMVC">Next Post &rarr;</a>
                        </li>
                    
                </ul>

                <br>

                <!--æ‰“èµ-->
                
                    <div class="reward">
                        <div class="reward-button">èµ <span class="reward-code"> 
                            <span class="alipay-code"> <img class="alipay-img" src="http://ww1.sinaimg.cn/large/006vWPzFly1g0o77ru34uj30dz0drdhv.jpg"><b>æ”¯ä»˜å®æ‰“èµ</b></span> 
                            <span class="wechat-code"> <img class="wechat-img" src="http://ww1.sinaimg.cn/large/006vWPzFly1g0o740lhb9j30rb0ov77z.jpg"><b>å¾®ä¿¡æ‰“èµ</b> </span>
                            </span></div>
                        <p class="reward-notice">èµèµä¸€ä¸‹</p>
                    </div>
                
                <!--æ‰“èµ-->

                <br>
                <!--åˆ†äº«-->
                
                <!--åˆ†äº«-->
                <br>                       
                
                <!-- require APlayer -->
                

                <!-- duoshuo Share start -->
                
                <!-- å¤šè¯´ Share end-->

                <!-- å¤šè¯´è¯„è®ºæ¡† start -->
                
                <!-- å¤šè¯´è¯„è®ºæ¡† end -->

                <!-- disqus comment start -->
                
                <!-- disqus comment end -->

                

            </div>
            
            <!-- Tabe of Content -->
            <!-- Table of Contents -->

  
    <style>
      span.toc-nav-number{
        display: none
      }
    </style>
  
    
      <aside id="sidebar">
        <div id="toc" class="toc-article">
        <strong class="toc-title">Contents</strong>
        
          <ol class="toc-nav"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#mybatisæ‰‹å†Œå…¥å£ä»å…¥é—¨åˆ°æ”¾å¼ƒ"><span class="toc-nav-number">1.</span> <span class="toc-nav-text"><a href="http://www.mybatis.org/mybatis-3/zh/getting-started.html" target="_blank" rel="noopener">MyBatis&#x624B;&#x518C;&#x5165;&#x53E3;&#x2014;&#x2014;&#x4ECE;&#x5165;&#x95E8;&#x5230;&#x653E;&#x5F03;</a></span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#ä¸€-ä»-xml-ä¸­æ„å»º-sqlsessionfactory"><span class="toc-nav-number">2.</span> <span class="toc-nav-text">&#x4E00;&#x3001;&#x4ECE; XML &#x4E2D;&#x6784;&#x5EFA; SqlSessionFactory</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#äºŒ-è·å–-sqlsession"><span class="toc-nav-number">3.</span> <span class="toc-nav-text">&#x4E8C;&#x3001;&#x83B7;&#x53D6; SqlSession</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#æ¥å£å¼ç¼–ç¨‹-xxxmapperclass-æ˜ å°„å™¨"><span class="toc-nav-number">3.1.</span> <span class="toc-nav-text">&#x63A5;&#x53E3;&#x5F0F;&#x7F16;&#x7A0B; XxxMapper.class &#x6620;&#x5C04;&#x5668;</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#ä¸‰-mybatis-configxml-é…ç½®æ–‡ä»¶"><span class="toc-nav-number">4.</span> <span class="toc-nav-text">&#x4E09;&#x3001;mybatis-config.xml &#x914D;&#x7F6E;&#x6587;&#x4EF6;</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#å±æ€§properties"><span class="toc-nav-number">4.1.</span> <span class="toc-nav-text">&#x5C5E;&#x6027;&#xFF08;properties&#xFF09;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#è®¾ç½®settings"><span class="toc-nav-number">4.2.</span> <span class="toc-nav-text">&#x8BBE;&#x7F6E;&#xFF08;settings&#xFF09;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#ç±»å‹åˆ«åtypealiases"><span class="toc-nav-number">4.3.</span> <span class="toc-nav-text">&#x7C7B;&#x578B;&#x522B;&#x540D;&#xFF08;typeAliases&#xFF09;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#ç±»å‹å¤„ç†å™¨typehandlers"><span class="toc-nav-number">4.4.</span> <span class="toc-nav-text">&#x7C7B;&#x578B;&#x5904;&#x7406;&#x5668;&#xFF08;typeHandlers&#xFF09;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#æ’ä»¶plugins"><span class="toc-nav-number">4.5.</span> <span class="toc-nav-text">&#x63D2;&#x4EF6;&#xFF08;plugins&#xFF09;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#ç¯å¢ƒé…ç½®environments"><span class="toc-nav-number">4.6.</span> <span class="toc-nav-text">&#x73AF;&#x5883;&#x914D;&#x7F6E;&#xFF08;environments&#xFF09;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#æ•°æ®åº“å‚å•†æ ‡è¯†dbidprovider"><span class="toc-nav-number">4.7.</span> <span class="toc-nav-text">&#x6570;&#x636E;&#x5E93;&#x5382;&#x5546;&#x6807;&#x8BC6;&#xFF08;DBIdProvider&#xFF09;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#æ˜ å°„å™¨mappers"><span class="toc-nav-number">4.8.</span> <span class="toc-nav-text">&#x6620;&#x5C04;&#x5668;&#xFF08;mappers&#xFF09;</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#å››-mybatis-xml-æ˜ å°„æ–‡ä»¶"><span class="toc-nav-number">5.</span> <span class="toc-nav-text">&#x56DB;&#x3001;MyBatis XML &#x6620;&#x5C04;&#x6587;&#x4EF6;</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#xxxmapperxml-è¯¦è§£"><span class="toc-nav-number">5.1.</span> <span class="toc-nav-text">XxxMapper.xml &#x8BE6;&#x89E3;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#è‡ªå®šä¹‰-resultmapå®ç°ç»“æœé›†æ˜ å°„"><span class="toc-nav-number">5.2.</span> <span class="toc-nav-text">&#x81EA;&#x5B9A;&#x4E49; ResultMap&#xFF0C;&#x5B9E;&#x73B0;&#x7ED3;&#x679C;&#x96C6;&#x6620;&#x5C04;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#ä¸€å¯¹ä¸€-resultmap"><span class="toc-nav-number">5.3.</span> <span class="toc-nav-text">&#x4E00;&#x5BF9;&#x4E00; resultMap</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#ä¸€å¯¹å¤š-resultmap"><span class="toc-nav-number">5.4.</span> <span class="toc-nav-text">&#x4E00;&#x5BF9;&#x591A; resultMap</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#äº”-åŠ¨æ€sql"><span class="toc-nav-number">6.</span> <span class="toc-nav-text">&#x4E94;&#x3001;&#x52A8;&#x6001;SQL</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#if"><span class="toc-nav-number">6.1.</span> <span class="toc-nav-text">if</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#trim-where-set"><span class="toc-nav-number">6.2.</span> <span class="toc-nav-text">trim (where, set)</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#where"><span class="toc-nav-number">6.3.</span> <span class="toc-nav-text">where</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#trim-where-å°è£…æŸ¥è¯¢æ¡ä»¶"><span class="toc-nav-number">6.3.1.</span> <span class="toc-nav-text">trim where (&#x5C01;&#x88C5;&#x67E5;&#x8BE2;&#x6761;&#x4EF6;)</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#set-å°è£…ä¿®æ”¹æ¡ä»¶"><span class="toc-nav-number">6.3.2.</span> <span class="toc-nav-text">set (&#x5C01;&#x88C5;&#x4FEE;&#x6539;&#x6761;&#x4EF6;)</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#trim-set-æ›´æ–°æ‹¼ä¸²"><span class="toc-nav-number">6.3.3.</span> <span class="toc-nav-text">trim set &#xFF08;&#x66F4;&#x65B0;&#x62FC;&#x4E32;&#xFF09;</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#choose-when-otherwise-åˆ†æ”¯é€‰æ‹©"><span class="toc-nav-number">6.3.4.</span> <span class="toc-nav-text">choose (when, otherwise) &#x5206;&#x652F;&#x9009;&#x62E9;</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#foreach"><span class="toc-nav-number">6.3.5.</span> <span class="toc-nav-text">foreach</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#ä¸¤ä¸ªå†…ç½®å‚æ•°"><span class="toc-nav-number">6.4.</span> <span class="toc-nav-text">&#x4E24;&#x4E2A;&#x5185;&#x7F6E;&#x53C2;&#x6570;</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#å…­-mybatis-ç¼“å­˜"><span class="toc-nav-number">7.</span> <span class="toc-nav-text">&#x516D;&#x3001;Mybatis &#x7F13;&#x5B58;</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#ä¸€çº§ç¼“å­˜-æœ¬åœ°ç¼“å­˜"><span class="toc-nav-number">7.1.</span> <span class="toc-nav-text">&#x4E00;&#x7EA7;&#x7F13;&#x5B58; (&#x672C;&#x5730;&#x7F13;&#x5B58;)</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#äºŒçº§ç¼“å­˜-å…¨å±€ç¼“å­˜"><span class="toc-nav-number">7.2.</span> <span class="toc-nav-text">&#x4E8C;&#x7EA7;&#x7F13;&#x5B58; (&#x5168;&#x5C40;&#x7F13;&#x5B58;)</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#ä¸ƒ-é€†å‘å·¥ç¨‹-mbg"><span class="toc-nav-number">8.</span> <span class="toc-nav-text">&#x4E03;&#x3001;&#x9006;&#x5411;&#x5DE5;&#x7A0B; (MBG)</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#å…«-spring-æ•´åˆ-mybatis"><span class="toc-nav-number">9.</span> <span class="toc-nav-text">&#x516B;&#x3001;Spring &#x6574;&#x5408; Mybatis</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#ä¹-mybatis-å·¥ä½œåŸç†"><span class="toc-nav-number">10.</span> <span class="toc-nav-text">&#x4E5D;&#x3001;Mybatis &#x5DE5;&#x4F5C;&#x539F;&#x7406;</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#æ’ä»¶å¼€å‘"><span class="toc-nav-number">11.</span> <span class="toc-nav-text">&#x63D2;&#x4EF6;&#x5F00;&#x53D1;</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#æ‰¹é‡å¤„ç†"><span class="toc-nav-number">12.</span> <span class="toc-nav-text">&#x6279;&#x91CF;&#x5904;&#x7406;</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#æ„Ÿè°¢é˜…è¯»"><span class="toc-nav-number"></span> <span class="toc-nav-text">&#x611F;&#x8C22;&#x9605;&#x8BFB;</span></a>
        
        </div>
      </aside>
    

                
            <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                
                <section>
                    <!-- no hr -->
                    <h5><a href="/tags/">FEATURED TAGS</a></h5>
                    <div class="tags">
                       
                          <a class="tag" href="/tags/#ORM æ¡†æ¶" title="ORM æ¡†æ¶">ORM æ¡†æ¶</a>
                        
                    </div>
                </section>
                

                <!-- Friends Blog -->
                
                <hr>
                <h5>FRIENDS</h5>
                <ul class="list-inline">

                    
                        <li><a href="https://github.com/GitHub-yuteng" target="_blank">GitHub</a></li>
                    
                        <li><a href="https://weibo.com/u/5968884687" target="_blank">å¾®åš</a></li>
                    
                </ul>
                
            </div>
        </div>
    </div>
</article>








<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("https://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'hover',
          placement: 'left',
          icon: 'â„¬'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>



    <!-- Footer -->
    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                
                
                

                

                

                
                    <li>
                        <a target="_blank"  href="https://github.com/GitHub-yuteng">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                

                </ul>
                <p class="copyright text-muted">
                    Copyright &copy; äºè…¾ 2019 
                    <br>
                    Theme by <a href="http://beantech.org">BeanTech</a> 
                    <span style="display: inline-block; margin: 0 5px;">
                        <i class="fa fa-heart"></i>
                    </span> 
                    re-Ported by <a href="http://www.huweihuang.com">èƒ¡ä¼Ÿç…Œ</a> | 
                    <iframe
                        style="margin-left: 2px; margin-bottom:-5px;"
                        frameborder="0" scrolling="0" width="91px" height="20px"
                        src="https://ghbtns.com/github-btn.html?user=huweihuang&repo=hexo-theme-huweihuang&type=star&count=true" >
                    </iframe>
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js"></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js"></script>

<!-- Custom Theme JavaScript -->
<script src="/js/hux-blog.min.js"></script>


<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!-- 
     Because of the native support for backtick-style fenced code blocks 
     right within the Markdown is landed in Github Pages, 
     From V1.6, There is no need for Highlight.js, 
     so Huxblog drops it officially.

     - https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0  
     - https://help.github.com/articles/creating-and-highlighting-code-blocks/    
-->
<!--
    <script>
        async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
            hljs.initHighlightingOnLoad();
        })
    </script>
    <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">
-->


<!-- jquery.tagcloud.js -->
<script>
    // only load tagcloud.js in tag.html
    if($('#tag_cloud').length !== 0){
        async("https://github-yuteng.github.io/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                //size: {start: 1, end: 1, unit: 'em'},
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>

<!--fastClick.js -->
<script>
    async("https://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->


<script>
    // dynamic User by Hux
    var _gaId = 'UA-XXXXXXXX-X';
    var _gaDomain = 'yoursite';

    // Originial
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', _gaId, _gaDomain);
    ga('send', 'pageview');
</script>




<!-- Baidu Tongji -->

<script>
    // dynamic User by Hux
    var _baId = 'xxx';

    // Originial
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?" + _baId;
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
</script>






	<a id="rocket" href="#top" class=""></a>
	<script type="text/javascript" src="/js/totop.js?v=1.0.0" async=""></script>
    <script type="text/javascript" src="/js/toc.js?v=1.0.0" async=""></script>
<!-- Image to hack wechat -->
<img src="https://github-yuteng.github.io/img/icon_wechat.png" width="0" height="0" />
<!-- Migrate from head to bottom, no longer block render and still work -->

</body>

</html>
