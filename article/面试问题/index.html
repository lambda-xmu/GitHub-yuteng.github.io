<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="keyword"  content="">
    <link rel="shortcut icon" href="/img/ironman-draw.png">
    <!-- Place this tag in your head or just before your close body tag. -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <title>
        
          é¢è¯•é—®é¢˜æ€»ç»“ - äºè…¾ | Blog
        
    </title>

    <link rel="canonical" href="https://github-yuteng.github.io/article/é¢è¯•é—®é¢˜/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS --> 
    <link rel="stylesheet" href="/css/beantech.min.css">

    <link rel="stylesheet" href="/css/donate.css">
    
    <!-- Pygments Highlight CSS -->
    <link rel="stylesheet" href="/css/highlight.css">

    <link rel="stylesheet" href="/css/widget.css">

    <link rel="stylesheet" href="/css/rocket.css">

    <link rel="stylesheet" href="/css/signature.css">

    <link rel="stylesheet" href="/css/toc.css">

    <!-- Custom Fonts -->
    <!-- <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <!-- Hux change font-awesome CDN to qiniu -->
    <link href="https://cdn.staticfile.org/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">


    <!-- Hux Delete, sad but pending in China
    <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/
    css'>
    -->


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- ga & ba script hoook -->
    <script></script>
</head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">
	<!-- Modified by Yu-Hsuan Yen -->
<!-- Post Header -->
<style type="text/css">
    header.intro-header{
        
            background-image: url('/img/article_header/article_bg.jpg')
            /*post*/
        
    }
    
</style>

<header class="intro-header" >
    <!-- Signature -->
    <div id="signature">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                
                    <div class="post-heading">
                        <div class="tags">
                            
                              <a class="tag" href="/tags/#é¢è¯•" title="é¢è¯•">é¢è¯•</a>
                            
                        </div>
                        <h1>é¢è¯•é—®é¢˜æ€»ç»“</h1>
                        <h2 class="subheading"></h2>
                        <span class="meta">
                            Posted by äºè…¾ on
                            2019-05-08
                        </span>
                    </div>
                


                </div>
            </div>
        </div>
    </div>
</header>

	
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">æ‰€çˆ±éš”å±±æµ·</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <!-- Known Issue, found by Hux:
            <nav>'s height woule be hold on by its content.
            so, when navbar scale out, the <nav> will cover tags.
            also mask any touch event of tags, unfortunately.
        -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>

                    

                        
                    

                        
                        <li>
                            <a href="/about/">è‡³æ­¤è‡³ç»ˆ</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/archive/">Archives</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/tags/">Tags</a>
                        </li>
                        
                    
                    
                </ul>
            </div>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        // CLOSE
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        // OPEN
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>


    <!-- Main Content -->
    <!-- Modify by Yu-Hsuan Yen -->

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                <h2 id="1-equals-amp-hashcode">1ã€equals() &amp; hashCode()</h2>
<p><strong>åœ¨é‡å†™equalsæ–¹æ³•çš„åŒæ—¶ï¼Œå¿…é¡»é‡å†™hashCodeæ–¹æ³•ã€‚</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object obj)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">this</span> == obj);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">native</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span></span>;<span class="comment">//è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªintç±»å‹çš„æ•°å€¼ï¼Œå¹¶ä¸”æ˜¯æœ¬åœ°æ–¹æ³•</span></span><br></pre></td></tr></table></figure>
<ul>
<li>
<p><strong>equals å¦‚æœä¸é‡å†™åº•å±‚ä¸º == æ¯”è¾ƒçš„ä¸ºå¯¹è±¡çš„åœ°å€ã€‚</strong></p>
</li>
<li>
<p><strong>é‡å†™äº† hashcode() ä¸¤ä¸ªç›¸åŒå¯¹è±¡çš„ hashcode æ‰ç›¸ç­‰ã€‚</strong></p>
</li>
</ul>
<hr>
<p><strong>å¯¹äºä¸¤ä¸ªå¯¹è±¡:</strong></p>
<ul>
<li>1ã€ä¸¤ä¸ªä¸åŒçš„å¯¹è±¡å¯èƒ½ä¼šç”Ÿæˆç›¸åŒ Hashcode å€¼ï¼ˆHashcodeå€¼ç›¸ç­‰ï¼Œequalsæ–¹æ³•ç»“æœæœªçŸ¥ï¼‰</li>
<li>2ã€ä¸¤ä¸ªå¯¹è±¡çš„ Hashcode å€¼ä¸åŒï¼Œå¿…å®šæ˜¯ä¸¤ä¸ªä¸åŒçš„å¯¹è±¡ï¼Œequalsæ–¹æ³•ç»“æœå¿…å®šä¸ºfalseã€‚</li>
<li>3ã€å¦‚æœè°ƒç”¨ equals æ–¹æ³•å¾—åˆ°çš„ç»“æœä¸º trueï¼Œåˆ™ä¸¤ä¸ªå¯¹è±¡çš„ Hashcode å€¼å¿…å®šç›¸ç­‰ï¼›</li>
<li>4ã€å¦‚æœè°ƒç”¨ equals æ–¹æ³•å¾—åˆ°çš„ç»“æœä¸º falseï¼Œåˆ™ä¸¤ä¸ªå¯¹è±¡çš„ Hashcode å€¼ä¸ä¸€å®šä¸åŒï¼›</li>
</ul>
<p><strong>é…åˆåŸºäºæ•£åˆ—çš„é›†åˆä¸€èµ·æ­£å¸¸è¿è¡Œï¼Œæ•£åˆ—é›†åˆåŒ…æ‹¬HashSetã€HashMapä»¥åŠHashTableã€‚</strong><br>
<strong><code>å¦‚æœä¸é‡å†™ hashCode æ–¹æ³•ï¼Œæ— æ³•ä½¿ç”¨ Mapï¼ŒSet ç­‰é›†åˆã€‚ï¼ˆå®ä½“ç±»ä½œä¸º Keyï¼Œå¤±æ•ˆï¼‰</code></strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Objects;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * é‡å†™äº† hashcode() ä¸¤ä¸ªå¯¹è±¡çš„ hashcode æ‰ç›¸ç­‰ã€‚</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        People p1 = <span class="keyword">new</span> People(<span class="string">"Jack"</span>, <span class="number">12</span>);</span><br><span class="line">        System.out.println(p1.hashCode());<span class="comment">//71329710</span></span><br><span class="line"></span><br><span class="line">        People p2 = <span class="keyword">new</span> People(<span class="string">"Jack"</span>, <span class="number">12</span>);</span><br><span class="line">        System.out.println(p2.hashCode());<span class="comment">//71329710</span></span><br><span class="line"></span><br><span class="line">        HashMap&lt;People, Integer&gt; hashMap = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        hashMap.put(p1, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//TODO åœ¨è®¾è®¡hashCodeæ–¹æ³•å’Œequalsæ–¹æ³•çš„æ—¶å€™ï¼Œå¦‚æœå¯¹è±¡ä¸­çš„æ•°æ®æ˜“å˜</span></span><br><span class="line">        <span class="comment">//TODO åˆ™æœ€å¥½åœ¨equalsæ–¹æ³•å’ŒhashCodeæ–¹æ³•ä¸­ä¸è¦ä¾èµ–äºè¯¥å­—æ®µã€‚</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// p1.setAge(1);//å¦‚æœæ›´æ”¹äº†å­—æ®µå€¼ï¼Œhashcodeå€¼å°†æ›´æ”¹</span></span><br><span class="line">        <span class="comment">// System.out.println(p1.hashCode());//71329699</span></span><br><span class="line"></span><br><span class="line">        System.out.println(hashMap.get(p1));<span class="comment">//</span></span><br><span class="line">        System.out.println(hashMap.get(p2));<span class="comment">//å¦‚æœä¸é‡å†™ åˆ™ä¸º null</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * equals å¦‚æœä¸é‡å†™åº•å±‚ä¸º == æ¯”è¾ƒçš„ä¸º å¯¹è±¡åœ°å€ åˆ™ä¸º false</span></span><br><span class="line"><span class="comment">         * public boolean equals(Object obj) &#123;</span></span><br><span class="line"><span class="comment">         *      return (this == obj);</span></span><br><span class="line"><span class="comment">         * &#125;</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        System.out.println(p1.equals(p2));<span class="comment">// æœŸæœ›å€¼ä¸º true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">People</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">People</span><span class="params">(String name, <span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(<span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span> == o) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (o == <span class="keyword">null</span> || getClass() != o.getClass()) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        People people = (People) o;</span><br><span class="line">        <span class="keyword">return</span> age == people.age &amp;&amp;</span><br><span class="line">                Objects.equals(name, people.name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Objects.hash(name, age);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="2-equals-amp">2ã€equals &amp; ==</h2>
<p><strong>æ‘˜è‡ªã€ŠJavaç¼–ç¨‹æ€æƒ³ã€‹ä¸€ä¹¦ä¸­çš„åŸè¯ï¼š</strong></p>
<p><strong><code>â€œå…³ç³»æ“ä½œç¬¦ç”Ÿæˆçš„æ˜¯ä¸€ä¸ªbooleanç»“æœï¼Œå®ƒä»¬è®¡ç®—çš„æ˜¯æ“ä½œæ•°çš„å€¼ä¹‹é—´çš„å…³ç³»â€ã€‚</code></strong></p>
<hr>
<p><strong>== å¯¹äºåŸºæœ¬æ•°æ®ç±»å‹ å’Œ Stringï¼Œæ˜¯ç›´æ¥æ¯”è¾ƒçš„å€¼ã€‚</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> i1 = <span class="number">12</span>;</span><br><span class="line"><span class="keyword">int</span> i2 = <span class="number">12</span>;</span><br><span class="line">System.out.println(i1 == i2);<span class="comment">// true</span></span><br><span class="line"></span><br><span class="line">String s1 = <span class="string">"hello"</span>;</span><br><span class="line">String s2 = <span class="string">"hello"</span>;</span><br><span class="line">System.out.println(s1 == s2);<span class="comment">// true</span></span><br><span class="line"></span><br><span class="line">String str = <span class="keyword">new</span> String(<span class="string">"hello"</span>);</span><br><span class="line">String str1 = <span class="keyword">new</span> String(<span class="string">"hello"</span>);</span><br><span class="line">String str2 = <span class="keyword">new</span> String(<span class="string">"hello"</span>);</span><br><span class="line">System.out.println(<span class="string">"-&gt;:"</span> + (str1 == str2));<span class="comment">// -&gt;:false</span></span><br><span class="line">System.out.println(<span class="string">"=&gt;:"</span> + str1.equals(str2));<span class="comment">// =&gt;:true</span></span><br><span class="line"><span class="comment">//TODO Stringç±»å¯¹equalsæ–¹æ³•è¿›è¡Œäº†é‡å†™ï¼Œç”¨æ¥æ¯”è¾ƒæŒ‡å‘çš„å­—ç¬¦ä¸²å¯¹è±¡æ‰€å­˜å‚¨çš„å­—ç¬¦ä¸²æ˜¯å¦ç›¸ç­‰ã€‚</span></span><br><span class="line"></span><br><span class="line">str1 = str;</span><br><span class="line">str2 = str;</span><br><span class="line">System.out.println(<span class="string">"-&gt;:"</span> + (str1 == str2));<span class="comment">// -&gt;:true</span></span><br></pre></td></tr></table></figure>
<hr>
<p><strong>== å¯¹äºå¼•ç”¨ç±»å‹ï¼Œæ˜¯ç›´æ¥æ¯”è¾ƒçš„ä¸¤ä¸ªå¯¹è±¡çš„å †å†…å­˜åœ°å€ï¼Œå¦‚æœç›¸ç­‰ï¼Œåˆ™è¯´æ˜è¿™ä¸¤ä¸ªå¼•ç”¨å®é™…æ˜¯æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡åœ°å€ã€‚</strong></p>
<p><strong>Integer åœ¨å¸¸é‡æ± ä¸­çš„å­˜å‚¨èŒƒå›´ä¸º[-128,127]</strong></p>
<ul>
<li>127åœ¨è¿™èŒƒå›´å†…ï¼Œå› æ­¤æ˜¯ç›´æ¥å­˜å‚¨äºå¸¸é‡æ± çš„ï¼Œè€Œ128ä¸åœ¨è¿™èŒƒå›´å†…ï¼Œæ‰€ä»¥ä¼šåœ¨å †å†…å­˜ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡æ¥ä¿å­˜è¿™ä¸ªå€¼ï¼Œæ‰€ä»¥ i5ï¼Œi6 åˆ†åˆ«æŒ‡å‘äº†ä¸¤ä¸ªä¸åŒçš„å¯¹è±¡åœ°å€ï¼Œæ•…è€Œå¯¼è‡´äº†ä¸ç›¸ç­‰ã€‚</li>
</ul>
<p><strong><code>Integer æºç </code></strong>  ğŸ‘‡</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Integer <span class="title">valueOf</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (i &gt;= IntegerCache.low &amp;&amp; i &lt;= IntegerCache.high)&#123;</span><br><span class="line">            <span class="keyword">return</span> IntegerCache.cache[i + (-IntegerCache.low)];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Integer(i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Integer i3 = <span class="number">127</span>;</span><br><span class="line">Integer i4 = <span class="number">127</span>;</span><br><span class="line"><span class="comment">//It's best to use equals() to compare</span></span><br><span class="line">System.out.println(i3 == i4);<span class="comment">// true</span></span><br><span class="line">System.out.println(i3.equals(i4));<span class="comment">// true</span></span><br><span class="line"></span><br><span class="line">Integer i5 = <span class="number">128</span>;</span><br><span class="line">Integer i6 = <span class="number">128</span>;</span><br><span class="line"><span class="comment">//It's best to use equals() to compare</span></span><br><span class="line">System.out.println(i5 == i6);<span class="comment">// -----&gt; false</span></span><br><span class="line">System.out.println(i5.equals(i6));<span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<h3 id=""></h3>
<p>1ï¼‰<strong>å¯¹äº==ï¼Œæ¯”è¾ƒçš„æ˜¯å€¼æ˜¯å¦ç›¸ç­‰</strong></p>
<ul>
<li>
<p>å¦‚æœä½œç”¨äºåŸºæœ¬æ•°æ®ç±»å‹çš„å˜é‡ï¼Œåˆ™ç›´æ¥æ¯”è¾ƒå…¶å­˜å‚¨çš„ â€œå€¼â€æ˜¯å¦ç›¸ç­‰ï¼›</p>
</li>
<li>
<p>å¦‚æœä½œç”¨äºå¼•ç”¨ç±»å‹çš„å˜é‡ï¼Œåˆ™æ¯”è¾ƒçš„æ˜¯æ‰€æŒ‡å‘çš„å¯¹è±¡çš„åœ°å€ã€‚</p>
</li>
</ul>
<p>2ï¼‰<strong>å¯¹äºequalsæ–¹æ³•ï¼Œæ‰€æœ‰ç±»ä»Objectç±»ä¸­ç»§æ‰¿equalsæ–¹æ³•ï¼Œæ¯”è¾ƒçš„æ˜¯å¦æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object obj)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">this</span> == obj);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>æ³¨æ„ï¼šequals() æ–¹æ³•æœ¬èº«å’Œ == æ²¡æœ‰åŒºåˆ«ï¼Œä½†ä¸èƒ½ä½œç”¨äºåŸºæœ¬æ•°æ®ç±»å‹çš„å˜é‡ï¼ˆå¯ä»¥ä¸ºåŒ…è£…ç±»å‹ï¼Œæ¯”è¾ƒå€¼ï¼‰ï¼›</p>
</li>
<li>
<p>å¦‚æœæ²¡æœ‰å¯¹ equals æ–¹æ³•è¿›è¡Œé‡å†™ï¼Œåˆ™æ¯”è¾ƒçš„æ˜¯å¼•ç”¨ç±»å‹çš„å˜é‡æ‰€æŒ‡å‘çš„å¯¹è±¡çš„åœ°å€ï¼Œï¼›</p>
</li>
<li>
<p>è¯¸å¦‚Stringã€Dateç­‰ç±»å¯¹equalsæ–¹æ³•è¿›è¡Œäº†é‡å†™çš„è¯ï¼Œæ¯”è¾ƒçš„æ˜¯æ‰€æŒ‡å‘çš„å¯¹è±¡çš„å†…å®¹ã€‚</p>
</li>
</ul>
<hr>
<hr>
<h2 id="3-hashmap">3ã€HashMap</h2>
<p><strong>HashMapå®ç°äº†Mapæ¥å£ï¼ŒMapæ¥å£å¯¹é”®å€¼å¯¹è¿›è¡Œæ˜ å°„ã€‚Mapä¸­ä¸å…è®¸å‡ºç°é‡å¤çš„é”®ï¼ˆKeyï¼‰ã€‚</strong></p>
<ul>
<li><strong>åœ¨ JDK1.6ï¼ŒJDK1.7 ä¸­ï¼ŒHashMapé‡‡ç”¨ <code>å“ˆå¸Œæ¡¶æ•°ç»„(ä½æ¡¶)+é“¾è¡¨</code>å®ç°ï¼Œå³ä½¿ç”¨é“¾è¡¨å¤„ç†å†²çªã€‚å¤´æ’æ³•</strong>
<ul>
<li>å½“ä½äºä¸€ä¸ªæ¡¶ä¸­çš„å…ƒç´ è¾ƒå¤š(é“¾è¡¨è¿‡é•¿)ï¼Œå³ Hash å€¼ç›¸ç­‰çš„å…ƒç´ è¾ƒå¤šæ—¶ï¼Œé€šè¿‡keyå€¼ä¾æ¬¡æŸ¥æ‰¾çš„æ•ˆç‡è¾ƒä½ã€‚</li>
</ul>
</li>
<li><strong>åœ¨  JDK1.8 ä¸­ï¼ŒHashMapé‡‡ç”¨ <code>å“ˆå¸Œæ¡¶æ•°ç»„(ä½æ¡¶)+é“¾è¡¨+çº¢é»‘æ ‘</code>å®ç°ï¼Œå½“é“¾è¡¨é•¿åº¦è¶…è¿‡é˜ˆå€¼ (8) æ—¶ï¼Œå°†é“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘ã€‚</strong></li>
</ul>
<hr>
<h3 id="jdk-18-hashmap-å®ç°åŸç†">JDK 1.8 HashMap å®ç°åŸç†</h3>
<p><strong>é¦–å…ˆæœ‰ä¸€ä¸ª å“ˆå¸Œæ¡¶æ•°ç»„(ä½æ¡¶)ï¼Œå½“æ·»åŠ ä¸€ä¸ªå…ƒç´ ï¼ˆkey-valueï¼‰æ—¶ï¼Œé¦–å…ˆè®¡ç®—å…ƒç´  Key çš„ Hash å€¼ï¼Œä»¥æ­¤ç¡®å®šæ’å…¥æ•°ç»„ä¸­çš„ä½ç½®ï¼Œä½†æ˜¯å¯èƒ½å­˜åœ¨ç›¸åŒ Hashå€¼çš„å…ƒç´ å·²ç»è¢«æ”¾åœ¨æ•°ç»„åŒä¸€ä½ç½®äº†ï¼Œè¿™æ—¶å°±æ·»åŠ åˆ°åŒä¸€ Hash å€¼çš„å…ƒç´ çš„åé¢ï¼Œä»–ä»¬åœ¨æ•°ç»„çš„åŒä¸€ä½ç½®ï¼Œä½†æ˜¯å½¢æˆäº†é“¾è¡¨ï¼ŒåŒä¸€å„é“¾è¡¨ä¸Šçš„ Hash å€¼æ˜¯ç›¸åŒçš„ï¼Œæ‰€ä»¥è¯´æ•°ç»„å­˜æ”¾çš„æ˜¯é“¾è¡¨ã€‚ä½†æ˜¯å½“é“¾è¡¨é•¿åº¦å¤ªé•¿æ—¶ï¼ŒJDK 1.8 é“¾è¡¨å°±è½¬æ¢ä¸ºçº¢é»‘æ ‘ï¼Œå¤§å¤§æé«˜äº†æŸ¥æ‰¾çš„æ•ˆç‡ã€‚</strong></p>
<ul>
<li><strong>hashCodeæ–¹æ³•çš„å­˜åœ¨æ˜¯ä¸ºäº†å‡å°‘equalsæ–¹æ³•çš„è°ƒç”¨æ¬¡æ•°ï¼Œä»è€Œæé«˜ç¨‹åºæ•ˆç‡ã€‚</strong></li>
</ul>
<hr>
<img src="https://i.loli.net/2019/07/17/5d2e931bac9a719213.png" alt="1.png" title="1.png">
<h4 id="å­˜å‚¨ç»“æ„-å­—æ®µ">å­˜å‚¨ç»“æ„-å­—æ®µ</h4>
<p><strong>HashMapç±»ä¸­æœ‰ä¸€ä¸ªéå¸¸é‡è¦çš„å­—æ®µï¼Œå°±æ˜¯ Node&lt;K,V&gt;[] tableï¼Œå³ å“ˆå¸Œæ¡¶æ•°ç»„ï¼›</strong></p>
<p><strong>Nodeæ˜¯HashMapçš„ä¸€ä¸ªå†…éƒ¨ç±»ï¼Œå®ç°äº†Map.Entryæ¥å£ï¼Œæœ¬è´¨æ˜¯å°±æ˜¯ä¸€ä¸ªæ˜ å°„(é”®å€¼å¯¹)ã€‚</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">transient</span> Node&lt;K,V&gt;[] table;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Nodeæ˜¯å•å‘é“¾è¡¨ï¼Œå®ƒå®ç°äº†Map.Entryæ¥å£ å­˜å‚¨ç€key-value</span></span><br><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt; <span class="keyword">implements</span> <span class="title">Map</span>.<span class="title">Entry</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">int</span> hash; <span class="comment">//ä¿å­˜è¯¥æ¡¶çš„hashå€¼</span></span><br><span class="line">    <span class="keyword">final</span> K key; <span class="comment">//ä¸å¯å˜çš„key</span></span><br><span class="line">    V value; <span class="comment">//æŒ‡å‘ä¸€ä¸ªæ•°æ®çš„æŒ‡é’ˆ</span></span><br><span class="line">    Node&lt;K,V&gt; next;</span><br><span class="line"></span><br><span class="line">    Node(<span class="keyword">int</span> hash, K key, V value, Node&lt;K,V&gt; next) &#123;</span><br><span class="line">        <span class="keyword">this</span>.hash = hash;</span><br><span class="line">        <span class="keyword">this</span>.key = key;</span><br><span class="line">        <span class="keyword">this</span>.value = value;</span><br><span class="line">        <span class="keyword">this</span>.next = next;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> K <span class="title">getKey</span><span class="params">()</span>        </span>&#123; <span class="keyword">return</span> key; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> V <span class="title">getValue</span><span class="params">()</span>      </span>&#123; <span class="keyword">return</span> value; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> key + <span class="string">"="</span> + value; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Objects.hashCode(key) ^ Objects.hashCode(value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> V <span class="title">setValue</span><span class="params">(V newValue)</span> </span>&#123;</span><br><span class="line">        V oldValue = value;</span><br><span class="line">        value = newValue;</span><br><span class="line">        <span class="keyword">return</span> oldValue;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (o == <span class="keyword">this</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        <span class="keyword">if</span> (o <span class="keyword">instanceof</span> Map.Entry) &#123;</span><br><span class="line">            Map.Entry&lt;?,?&gt; e = (Map.Entry&lt;?,?&gt;)o;</span><br><span class="line">            <span class="keyword">if</span> (Objects.equals(key, e.getKey()) &amp;&amp;</span><br><span class="line">                Objects.equals(value, e.getValue()))</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h4 id="hash-å†²çª">Hash å†²çª</h4>
<p><strong>æœ‰æ—¶å€™ä¸¤ä¸ª key çš„ hashCode å¯èƒ½ä¼šå®šä½åˆ°ä¸€ä¸ªæ¡¶ä¸­ï¼Œè¿™æ—¶å°±å‘ç”Ÿäº†hashå†²çªï¼Œå¦‚æœHashMapçš„ Hash ç®—æ³•è¶Šæ•£åˆ—ï¼Œé‚£ä¹ˆå‘ç”ŸHash å†²çªçš„æ¦‚ç‡è¶Šä½ã€‚å¦‚æœæ•°ç»„è¶Šå¤§ï¼Œé‚£ä¹ˆå‘ç”Ÿ Hash å†²çªçš„æ¦‚ç‡ä¹Ÿä¼šè¶Šä½ï¼Œä½†æ˜¯æ•°ç»„è¶Šå¤§å¸¦æ¥çš„ç©ºé—´å¼€é”€è¶Šå¤šï¼Œä½†æ˜¯éå†é€Ÿåº¦è¶Šå¿«ï¼Œè¿™å°±è¦åœ¨ç©ºé—´å’Œæ—¶é—´ä¸Šè¿›è¡Œæƒè¡¡ï¼Œè¿™å°±è¦çœ‹çœ‹ HashMap çš„æ‰©å®¹æœºåˆ¶ã€‚</strong></p>
<hr>
<h4 id="æ‰©å®¹æœºåˆ¶">æ‰©å®¹æœºåˆ¶</h4>
<p><strong>æ‰©å®¹æœºåˆ¶å‡ ä¸ªæ¯”è¾ƒé‡è¦çš„å­—æ®µ</strong></p>
<ul>
<li>
<p>static final int DEFAULT_INITIAL_CAPACITY = 1 &lt;&lt; 4; // aka 16  <code>é»˜è®¤ä¸º16ä¸ªæ¡¶</code></p>
</li>
<li>
<p>static final int MAXIMUM_CAPACITY = 1 &lt;&lt; 30; //<code>é»˜è®¤æ¡¶æœ€å¤šæœ‰2^30ä¸ª,å¹¶ä¸”å¿…é¡»æ˜¯ 2çš„å¹‚</code></p>
</li>
<li>
<p>static final float DEFAULT_LOAD_FACTOR = 0.75f; //<code>é»˜è®¤è´Ÿè½½å› å­æ˜¯0.75</code></p>
</li>
<li>
<p>int threshold; //<code>èƒ½å®¹çº³æœ€å¤škey_valueå¯¹çš„ä¸ªæ•°</code></p>
</li>
<li>
<p>transient int size; //<code>ä¸€å…±æœ‰ key-valueå¯¹ ä¸ªæ•°</code></p>
</li>
<li>
<p>transient int modCount; //<code>è®°å½•æ˜¯å‘ç”Ÿå†…éƒ¨ç»“æ„å˜åŒ–çš„æ¬¡æ•° putä¸ç®—å‘ç”Ÿç»“æ„å˜åŒ–</code></p>
</li>
</ul>
<p><strong>threshold = è´Ÿè½½å› å­ * lengthï¼Œä¹Ÿå°±æ˜¯è¯´æ•°ç»„é•¿åº¦å›ºå®šä»¥åï¼Œ å¦‚æœè´Ÿè½½å› å­è¶Šå¤§ï¼Œæ‰€èƒ½å®¹çº³çš„å…ƒç´ ä¸ªæ•°è¶Šå¤šï¼Œå¦‚æœè¶…è¿‡è¿™ä¸ªå€¼ï¼ˆthreshold ï¼‰å°±ä¼šè¿›è¡Œæ‰©å®¹(é»˜è®¤æ˜¯æ‰©å®¹ä¸ºåŸæ¥çš„2å€)ï¼Œ0.75è¿™ä¸ªå€¼æ˜¯æƒè¡¡è¿‡ç©ºé—´å’Œæ—¶é—´å¾—å‡ºçš„ã€‚(è¿™ä¸ªå€¼å¯ä»¥å¤§äº1)</strong></p>
<p><strong>å› ä¸º HashMap æ‰©å®¹æ¯æ¬¡éƒ½æ˜¯æ‰©å®¹ä¸ºåŸæ¥çš„2å€ï¼Œæ‰€ä»¥ length æ€»æ˜¯2çš„æ¬¡æ–¹ï¼Œè¿™æ˜¯éå¸¸è§„çš„è®¾ç½®ï¼Œå¸¸è§„è®¾ç½®æ˜¯æŠŠæ¡¶çš„å¤§å°è®¾ç½®ä¸ºç´ æ•°ï¼Œå› ä¸º<code>ç´ æ•°å‘ç”Ÿhashå†²çªçš„æ¦‚ç‡è¦å°äºåˆæ•°</code>ï¼Œæ¯”å¦‚HashTableçš„é»˜è®¤å€¼è®¾ç½®ä¸º11ï¼Œå°±æ˜¯æ¡¶çš„å¤§å°ä¸ºç´ æ•°çš„åº”ç”¨(HashTableæ‰©å®¹åä¸èƒ½ä¿è¯æ˜¯ç´ æ•°)ã€‚HashMapé‡‡ç”¨è¿™ç§è®¾ç½®æ˜¯ä¸ºäº†åœ¨å–æ¨¡å’Œæ‰©å®¹çš„æ—¶å€™åšå‡ºä¼˜åŒ–ã€‚</strong></p>
<p><strong>hashMapæ˜¯é€šè¿‡keyçš„hashCodeçš„é«˜16ä½å’Œä½16ä½å¼‚æˆ–åå’Œæ¡¶çš„æ•°é‡å–æ¨¡å¾—åˆ°ç´¢å¼•ä½ç½®ã€‚å¦‚ä¸‹ï¼š</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> <span class="title">hash</span><span class="params">(Object key)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> h;</span><br><span class="line">    <span class="comment">// h = key.hashCode() ä¸ºç¬¬ä¸€æ­¥ å–hashCodeå€¼</span></span><br><span class="line">    <span class="comment">// h ^ (h &gt;&gt;&gt; 16)  ä¸ºç¬¬äºŒæ­¥ é«˜ä½å‚ä¸è¿ç®—</span></span><br><span class="line">    <span class="keyword">return</span> (key == <span class="keyword">null</span>) ? <span class="number">0</span> : (h = key.hashCode()) ^ (h &gt;&gt;&gt; <span class="number">16</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>åœ¨æ‰©å®¹çš„æ—¶å€™ï¼Œå¦‚æœlengthæ¯æ¬¡æ˜¯ 2^nï¼Œé‚£ä¹ˆé‡æ–°è®¡ç®—å‡ºæ¥çš„ç´¢å¼•åªæœ‰ä¸¤ç§æƒ…å†µï¼Œä¸€ç§æ˜¯ old ç´¢å¼•+16ï¼Œå¦ä¸€ç§æ˜¯ç´¢å¼•ä¸å˜ï¼Œæ‰€ä»¥å°±ä¸éœ€è¦æ¯æ¬¡éƒ½é‡æ–°è®¡ç®—ç´¢å¼•ã€‚</strong></p>
<hr>
<h4 id="hashmapçš„putæ–¹æ³•å®ç°">HashMapçš„putæ–¹æ³•å®ç°</h4>
<p><strong>å®ç°æ€è·¯ï¼š</strong></p>
<ul>
<li>
<p><strong>1.åˆ¤æ–­é”®å€¼å¯¹æ•°ç»„ Node&lt;K,V&gt;[] table æ˜¯å¦ä¸ºç©ºã€‚</strong></p>
</li>
<li>
<p><strong>2.åˆ¤æ–­ table[i] å¤„æ˜¯å¦æ’å…¥è¿‡å€¼</strong>ã€‚</p>
</li>
<li>
<p><strong>3.åˆ¤æ–­é“¾è¡¨é•¿åº¦æ˜¯å¦å¤§äº8ï¼Œå°äºæŒ‚åœ¨é“¾è¡¨æœ€åï¼Œå¦‚æœå¤§äºå°±è½¬æ¢ä¸ºçº¢é»‘äºŒå‰æ ‘ï¼Œå¹¶æ’å…¥æ ‘ä¸­</strong>ã€‚</p>
</li>
<li>
<p><strong>4.åˆ¤æ–­keyæ˜¯å¦å’ŒåŸæœ‰keyç›¸åŒï¼Œå¦‚æœç›¸åŒå°±è¦†ç›–åŸæœ‰keyçš„valueï¼Œå¹¶è¿”å›åŸæœ‰valueã€‚(æ—§å€¼)</strong></p>
</li>
<li>
<p><strong>5.å¦‚æœkeyä¸ç›¸åŒï¼Œå°±æ’å…¥ä¸€ä¸ªkeyï¼Œ<code>è®°å½•ç»“æ„å˜åŒ–ä¸€æ¬¡</code>ï¼ˆmodCountï¼‰ã€‚</strong></p>
</li>
</ul>
<p>é€šä¿—æ¥è¯´ï¼šJavaä¸­çš„hashCodeæ–¹æ³•å°±æ˜¯æ ¹æ®ä¸€å®šçš„è§„åˆ™å°†ä¸å¯¹è±¡ç›¸å…³çš„ä¿¡æ¯ï¼ˆæ¯”å¦‚å¯¹è±¡çš„å­˜å‚¨åœ°å€ï¼Œå¯¹è±¡çš„å­—æ®µç­‰ï¼‰æ˜ å°„æˆä¸€ä¸ªæ•°å€¼ï¼Œè¿™ä¸ªæ•°å€¼ç§°ä½œä¸ºæ•£åˆ—å€¼(HashCodeå€¼)ã€‚ æœ‰äº›æœ‹å‹è¯¯ä»¥ä¸ºé»˜è®¤æƒ…å†µä¸‹ï¼ŒhashCodeè¿”å›çš„å°±æ˜¯å¯¹è±¡çš„å­˜å‚¨åœ°å€ï¼Œäº‹å®ä¸Šè¿™ç§çœ‹æ³•æ˜¯ä¸å…¨é¢çš„ï¼Œç¡®å®æœ‰äº›JVMåœ¨å®ç°æ—¶æ˜¯ç›´æ¥è¿”å›å¯¹è±¡çš„å­˜å‚¨åœ°å€ï¼Œä½†æ˜¯å¤§å¤šæ—¶å€™å¹¶ä¸æ˜¯è¿™æ ·ï¼Œåªèƒ½è¯´å¯èƒ½å­˜å‚¨åœ°å€æœ‰ä¸€å®šå…³è”ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> V <span class="title">put</span><span class="params">(K key, V value)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> putVal(hash(key), key, value, <span class="keyword">false</span>, <span class="keyword">true</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* Implements Map.put and related methods</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> hash hash for key</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> key the key</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> value the value to put</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> onlyIfAbsent if true, don't change existing value</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> evict if false, the table is in creation mode.</span></span><br><span class="line"><span class="comment">* <span class="doctag">@return</span> previous value, or null if none</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">final</span> V <span class="title">putVal</span><span class="params">(<span class="keyword">int</span> hash, K key, V value, <span class="keyword">boolean</span> onlyIfAbsent,<span class="keyword">boolean</span> evict)</span> </span>&#123;</span><br><span class="line">    Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; <span class="keyword">int</span> n, i;</span><br><span class="line">    <span class="comment">//åˆ¤æ–­tableæ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœæ˜¯ç©ºçš„å°±åˆ›å»ºä¸€ä¸ªtableï¼Œå¹¶è·å–ä»–çš„é•¿åº¦</span></span><br><span class="line">    <span class="keyword">if</span> ((tab = table) == <span class="keyword">null</span> || (n = tab.length) == <span class="number">0</span>)</span><br><span class="line">        n = (tab = resize()).length;</span><br><span class="line">    <span class="comment">//å¦‚æœè®¡ç®—å‡ºæ¥çš„ç´¢å¼•ä½ç½®ä¹‹å‰æ²¡æœ‰æ”¾è¿‡æ•°æ®ï¼Œå°±ç›´æ¥æ”¾å…¥</span></span><br><span class="line">    <span class="keyword">if</span> ((p = tab[i = (n - <span class="number">1</span>) &amp; hash]) == <span class="keyword">null</span>)</span><br><span class="line">        tab[i] = newNode(hash, key, value, <span class="keyword">null</span>);</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">//è¿›å…¥è¿™é‡Œè¯´æ˜ç´¢å¼•ä½ç½®å·²ç»æ”¾å…¥è¿‡æ•°æ®äº†</span></span><br><span class="line">        Node&lt;K,V&gt; e; K k;</span><br><span class="line">        <span class="comment">//åˆ¤æ–­putçš„æ•°æ®å’Œä¹‹å‰çš„æ•°æ®æ˜¯å¦é‡å¤</span></span><br><span class="line">        <span class="keyword">if</span> (p.hash == hash &amp;&amp;</span><br><span class="line">            <span class="comment">//keyçš„åœ°å€æˆ–keyçš„equals()åªè¦æœ‰ä¸€ä¸ªç›¸ç­‰å°±è®¤ä¸ºkeyé‡å¤äº†ï¼Œå°±ç›´æ¥è¦†ç›–åŸæ¥keyçš„value</span></span><br><span class="line">            ((k = p.key) == key || (key != <span class="keyword">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">            e = p;</span><br><span class="line">        <span class="comment">//åˆ¤æ–­æ˜¯å¦æ˜¯çº¢é»‘æ ‘ï¼Œå¦‚æœæ˜¯çº¢é»‘æ ‘å°±ç›´æ¥æ’å…¥æ ‘ä¸­</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (p <span class="keyword">instanceof</span> TreeNode)</span><br><span class="line">            e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(<span class="keyword">this</span>, tab, hash, key, value);</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">//å¦‚æœä¸æ˜¯çº¢é»‘æ ‘ï¼Œå°±éå†æ¯ä¸ªèŠ‚ç‚¹ï¼Œåˆ¤æ–­é“¾è¡¨é•¿åº¦æ˜¯å¦å¤§äº8ï¼Œå¦‚æœå¤§äºå°±è½¬æ¢ä¸ºçº¢é»‘æ ‘</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> binCount = <span class="number">0</span>; ; ++binCount) &#123;</span><br><span class="line">                <span class="keyword">if</span> ((e = p.next) == <span class="keyword">null</span>) &#123;</span><br><span class="line">                    p.next = newNode(hash, key, value, <span class="keyword">null</span>);</span><br><span class="line">                    <span class="keyword">if</span> (binCount &gt;= TREEIFY_THRESHOLD - <span class="number">1</span>) <span class="comment">// -1 for 1st</span></span><br><span class="line">                        treeifyBin(tab, hash);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">//åˆ¤æ–­ç´¢å¼•æ¯ä¸ªå…ƒç´ çš„keyæ˜¯å¦å’Œå¯è¦æ’å…¥çš„keyç›¸åŒï¼Œå¦‚æœç›¸åŒå°±ç›´æ¥è¦†ç›–</span></span><br><span class="line">                <span class="keyword">if</span> (e.hash == hash &amp;&amp;</span><br><span class="line">                    ((k = e.key) == key || (key != <span class="keyword">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                p = e;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//å¦‚æœeä¸æ˜¯nullï¼Œè¯´æ˜æ²¡æœ‰è¿­ä»£åˆ°æœ€åå°±è·³å‡ºäº†å¾ªç¯ï¼Œè¯´æ˜é“¾è¡¨ä¸­æœ‰ç›¸åŒçš„key</span></span><br><span class="line">        <span class="comment">//å› æ­¤åªéœ€è¦å°†valueè¦†ç›–ï¼Œå¹¶å°†oldValueè¿”å›å³å¯</span></span><br><span class="line">        <span class="keyword">if</span> (e != <span class="keyword">null</span>) &#123; <span class="comment">// existing mapping for key</span></span><br><span class="line">            V oldValue = e.value;</span><br><span class="line">            <span class="keyword">if</span> (!onlyIfAbsent || oldValue == <span class="keyword">null</span>)</span><br><span class="line">                e.value = value;</span><br><span class="line">            afterNodeAccess(e);</span><br><span class="line">            <span class="keyword">return</span> oldValue;<span class="comment">//è¿”å›å­˜åœ¨çš„Valueå€¼ æ—§å€¼</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//è¯´æ˜æ²¡æœ‰keyç›¸åŒï¼Œå› æ­¤è¦æ’å…¥ä¸€ä¸ªkey-valueï¼Œå¹¶è®°å½•å†…éƒ¨ç»“æ„å˜åŒ–æ¬¡æ•°</span></span><br><span class="line">    ++modCount;</span><br><span class="line">    <span class="keyword">if</span> (++size &gt; threshold)<span class="comment">//å¤§äºäº† threshold</span></span><br><span class="line">        resize();<span class="comment">//æ‰©å®¹ä¸¤å€  </span></span><br><span class="line">    afterNodeInsertion(evict);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h4 id="hashmapçš„getæ–¹æ³•å®ç°">HashMapçš„getæ–¹æ³•å®ç°</h4>
<p><strong>å®ç°æ€è·¯ï¼š</strong></p>
<ul>
<li>
<p><strong>1.åˆ¤æ–­è¡¨æˆ–keyæ˜¯å¦æ˜¯nullï¼Œå¦‚æœæ˜¯ç›´æ¥è¿”å›null</strong>ã€‚</p>
</li>
<li>
<p><strong>2.åˆ¤æ–­ç´¢å¼•å¤„ç¬¬ä¸€ä¸ªkeyä¸ä¼ å…¥keyæ˜¯å¦ç›¸ç­‰ï¼Œå¦‚æœç›¸ç­‰ç›´æ¥è¿”å›ã€‚</strong></p>
</li>
<li>
<p><strong>3.å¦‚æœä¸ç›¸ç­‰ï¼Œåˆ¤æ–­é“¾è¡¨æ˜¯å¦æ˜¯çº¢é»‘äºŒå‰æ ‘ï¼Œå¦‚æœæ˜¯ï¼Œç›´æ¥ä»æ ‘ä¸­å–å€¼ã€‚</strong></p>
</li>
<li>
<p><strong>4.å¦‚æœä¸æ˜¯æ ‘ï¼Œå°±éå†é“¾è¡¨æŸ¥æ‰¾ã€‚</strong></p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">final</span> Node&lt;K,V&gt; <span class="title">getNode</span><span class="params">(<span class="keyword">int</span> hash, Object key)</span> </span>&#123;</span><br><span class="line">    Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; first, e; <span class="keyword">int</span> n; K k;</span><br><span class="line">    <span class="comment">//å¦‚æœè¡¨ä¸æ˜¯ç©ºçš„ï¼Œå¹¶ä¸”è¦æŸ¥æ‰¾ç´¢å¼•å¤„æœ‰å€¼ï¼Œå°±åˆ¤æ–­ä½äºç¬¬ä¸€ä¸ªçš„keyæ˜¯å¦æ˜¯è¦æŸ¥æ‰¾çš„key</span></span><br><span class="line">    <span class="keyword">if</span> ((tab = table) != <span class="keyword">null</span> &amp;&amp; (n = tab.length) &gt; <span class="number">0</span> &amp;&amp;</span><br><span class="line">        (first = tab[(n - <span class="number">1</span>) &amp; hash]) != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (first.hash == hash &amp;&amp; <span class="comment">// always check first node</span></span><br><span class="line">            ((k = first.key) == key || (key != <span class="keyword">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">            <span class="comment">//å¦‚æœæ˜¯ï¼Œå°±ç›´æ¥è¿”å›</span></span><br><span class="line">            <span class="keyword">return</span> first;</span><br><span class="line">        <span class="comment">//å¦‚æœä¸æ˜¯å°±åˆ¤æ–­é“¾è¡¨æ˜¯å¦æ˜¯çº¢é»‘äºŒå‰æ ‘ï¼Œå¦‚æœæ˜¯ï¼Œå°±ä»æ ‘ä¸­å–å€¼</span></span><br><span class="line">        <span class="keyword">if</span> ((e = first.next) != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (first <span class="keyword">instanceof</span> TreeNode)</span><br><span class="line">                <span class="keyword">return</span> ((TreeNode&lt;K,V&gt;)first).getTreeNode(hash, key);</span><br><span class="line">            <span class="comment">//å¦‚æœä¸æ˜¯æ ‘ï¼Œå°±éå†é“¾è¡¨</span></span><br><span class="line">            <span class="keyword">do</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (e.hash == hash &amp;&amp;</span><br><span class="line">                    ((k = e.key) == key || (key != <span class="keyword">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">                    <span class="keyword">return</span> e;</span><br><span class="line">            &#125; <span class="keyword">while</span> ((e = e.next) != <span class="keyword">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="4-hashset">4ã€HashSet</h2>
<p><strong>HashSet å®ç°äº†Setæ¥å£ï¼Œåº•å±‚æ˜¯HashMap</strong>ã€‚</p>
<p><strong>HashSet çš„æ–¹æ³•ï¼Œä¹Ÿæ˜¯å€ŸåŠ©HashMapçš„æ–¹æ³•æ¥å®ç°çš„ã€‚</strong></p>
<ul>
<li>HashSet å®ç°äº†Setæ¥å£ï¼Œå®ƒä¸å…è®¸é›†åˆä¸­å‡ºç°é‡å¤å…ƒç´ ã€‚(ä»…å­˜å‚¨å¯¹è±¡)</li>
<li>ä¸èƒ½ä¿è¯å…ƒç´ çš„é¡ºåºï¼Œå…ƒç´ æ˜¯æ— åºçš„ã€‚</li>
<li>é›†åˆå…ƒç´ å€¼å…è®¸ä¸ºnullã€‚</li>
<li>HashSetä¸æ˜¯åŒæ­¥çš„ï¼Œéœ€è¦å¤–éƒ¨ä¿æŒçº¿ç¨‹ä¹‹é—´çš„åŒæ­¥é—®é¢˜ã€‚</li>
<li>å°†å¯¹è±¡å­˜å‚¨åœ¨HashSetä¹‹å‰ï¼Œ<code>è¦ç¡®ä¿é‡å†™ equals() æ–¹æ³• å’Œ hashCode() æ–¹æ³•</code> ï¼Œè¿™æ ·æ‰èƒ½æ¯”è¾ƒå¯¹è±¡çš„å€¼æ˜¯å¦ç›¸ç­‰ï¼Œç¡®ä¿é›†åˆä¸­æ²¡æœ‰å‚¨å­˜ç›¸åŒçš„å¯¹è±¡ã€‚</li>
</ul>
<h3 id="hashset-å…ƒç´ ä¸é‡å¤">HashSet å…ƒç´ ä¸é‡å¤</h3>
<p><strong>å®ç°äº† Set æ¥å£ï¼š</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HashSet</span>&lt;<span class="title">E</span>&gt;</span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">AbstractSet</span>&lt;<span class="title">E</span>&gt;</span></span><br><span class="line"><span class="class">    <span class="keyword">implements</span> <span class="title">Set</span>&lt;<span class="title">E</span>&gt;, <span class="title">Cloneable</span>, <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span></span></span><br></pre></td></tr></table></figure>
<p><strong>ç±»ä¸­ map å’Œ PARENT çš„å®šä¹‰ï¼š</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">transient</span> HashMap&lt;E,Object&gt; map;<span class="comment">//mapé›†åˆï¼ŒHashSetå­˜æ”¾å…ƒç´ çš„å®¹å™¨</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Dummy value to associate with an Object in the backing Map</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Object PRESENT = <span class="keyword">new</span> Object();<span class="comment">//mapï¼Œä¸­é”®å¯¹åº”çš„valueå€¼</span></span><br></pre></td></tr></table></figure>
<p><strong>æ„é€ æ–¹æ³•:</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ— å‚æ„é€ æ–¹æ³•ï¼Œå®Œæˆmapçš„åˆ›å»º</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">HashSet</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æŒ‡å®šé›†åˆè½¬åŒ–ä¸ºHashSet, å®Œæˆmapçš„åˆ›å»º</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">HashSet</span><span class="params">(Collection&lt;? extends E&gt; c)</span> </span>&#123;</span><br><span class="line">   map = <span class="keyword">new</span> HashMap&lt;&gt;(Math.max((<span class="keyword">int</span>) (c.size()/.<span class="number">75f</span>) + <span class="number">1</span>, <span class="number">16</span>));</span><br><span class="line">   addAll(c);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æŒ‡å®šåˆå§‹åŒ–å¤§å°ï¼Œå’Œè´Ÿè½½å› å­</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">HashSet</span><span class="params">(<span class="keyword">int</span> initialCapacity, <span class="keyword">float</span> loadFactor)</span> </span>&#123;</span><br><span class="line">    map = <span class="keyword">new</span> HashMap&lt;&gt;(initialCapacity, loadFactor);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æŒ‡å®šåˆå§‹åŒ–å¤§å°</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">HashSet</span><span class="params">(<span class="keyword">int</span> initialCapacity)</span> </span>&#123;</span><br><span class="line">    map = <span class="keyword">new</span> HashMap&lt;&gt;(initialCapacity);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æŒ‡å®šåˆå§‹åŒ–å¤§å°å’Œè´Ÿè½½å› å­ï¼Œdummy æ— å®é™…æ„ä¹‰</span></span><br><span class="line">HashSet(<span class="keyword">int</span> initialCapacity, <span class="keyword">float</span> loadFactor, <span class="keyword">boolean</span> dummy) &#123;</span><br><span class="line">    map = <span class="keyword">new</span> LinkedHashMap&lt;&gt;(initialCapacity, loadFactor);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>æºç  ğŸ‘‰ HashSet ç±»ä¸­çš„add()æ–¹æ³•ï¼š</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">add</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> map.put(e, PRESENT)==<span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>æ¥åˆ°äº† ğŸ‘‰ HashMap çš„ put()æ–¹æ³•ï¼š</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> V <span class="title">put</span><span class="params">(K key, V value)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> putVal(hash(key), key, value, <span class="keyword">false</span>, <span class="keyword">true</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"> HashSet&lt;String&gt; set = <span class="keyword">new</span> HashSet&lt;&gt;();</span><br><span class="line"> set.add(<span class="string">"1"</span>);</span><br><span class="line"> set.add(<span class="string">"1"</span>);</span><br><span class="line"> set.add(<span class="string">"2"</span>);</span><br><span class="line"> set.add(<span class="keyword">null</span>);</span><br><span class="line"></span><br><span class="line">Iterator&lt;String&gt; iterator = set.iterator();</span><br><span class="line"><span class="keyword">while</span> (iterator.hasNext())&#123;</span><br><span class="line">    String next = iterator.next();</span><br><span class="line">    System.out.println(next);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* null</span></span><br><span class="line"><span class="comment">* 1</span></span><br><span class="line"><span class="comment">* 2</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="5-concurrenthashmap">5ã€ConcurrentHashMap</h2>
<p><strong>if (<code>key == null || value == null</code>) throw new <code>NullPointerException();</code></strong></p>
<ul>
<li><strong>key-valueéƒ½ä¸å¯ä¸ºç©ºï¼</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> V <span class="title">put</span><span class="params">(K key, V value)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> putVal(key, value, <span class="keyword">false</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** Implementation for put and putIfAbsent */</span></span><br><span class="line"><span class="function"><span class="keyword">final</span> V <span class="title">putVal</span><span class="params">(K key, V value, <span class="keyword">boolean</span> onlyIfAbsent)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (key == <span class="keyword">null</span> || value == <span class="keyword">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException();</span><br></pre></td></tr></table></figure>
<p><strong>ConcurrentHashMap å¯ä»¥æ”¯æŒå¹¶å‘çš„è¯»å†™</strong>ã€‚</p>
<img src="https://i.loli.net/2019/07/17/5d2ece546df0066415.png" alt="1.png" title="1.png">
<p><strong>HashMapï¼šéçº¿ç¨‹å®‰å…¨</strong>ï¼Œå³ä»»ä¸€æ—¶åˆ»å¯ä»¥æœ‰å¤šä¸ªçº¿ç¨‹åŒæ—¶å†™HashMapï¼Œå¯èƒ½ä¼šå¯¼è‡´æ•°æ®çš„ä¸ä¸€è‡´ã€‚</p>
<ul>
<li>HashMapÂ åšputÂ æ“ä½œçš„æ—¶å€™ï¼Œå‡å¦‚Açº¿ç¨‹å’ŒBçº¿ç¨‹åŒæ—¶å¯¹åŒä¸€ä¸ªæ•°ç»„ä½ç½®è°ƒç”¨addEntryï¼Œä¸¤ä¸ªçº¿ç¨‹ä¼šåŒæ—¶å¾—åˆ°ç°åœ¨çš„å¤´ç»“ç‚¹ï¼Œç„¶åAå†™å…¥æ–°çš„å¤´ç»“ç‚¹ä¹‹åï¼ŒBä¹Ÿå†™å…¥æ–°çš„å¤´ç»“ç‚¹ï¼Œé‚£Bçš„å†™å…¥æ“ä½œå°±ä¼šè¦†ç›–Açš„å†™å…¥æ“ä½œé€ æˆAçš„å†™å…¥æ“ä½œä¸¢å¤±ã€‚åŒç†ï¼Œå½“å¤šçº¿ç¨‹å¯¹åŒä¸€æ•°ç»„ä½ç½®è¿›è¡Œremoveæ“ä½œæ—¶ä¹Ÿä¼šäº§ç”Ÿè¦†ç›–ã€‚å› æ­¤å¦‚æœä¸è¿›è¡Œé¢å¤–çš„å¤–åŒæ­¥æ“ä½œï¼ŒHashMap æ˜¯éçº¿ç¨‹å®‰å…¨çš„ã€‚æ ·å¿…ç„¶å¯¼è‡´æ•ˆç‡ä½ä¸‹ï¼Œè€Œä¸”ç«äº‰è¶Šæ¿€çƒˆï¼Œæ•ˆç‡è¶Šä½ä¸‹ã€‚ä¸¥é‡æƒ…å†µï¼Œ<strong>ä¸¤ä¸ªçº¿ç¨‹ä½¿ç”¨HashMapè¿›è¡Œputæ“ä½œä¼šå¼•èµ·æ­»å¾ªç¯(æ¯”å¦‚putçš„ä¸¤ä¸ªå¯¹è±¡ å¼•èµ·æ‰©å®¹ï¼Œå¯èƒ½å‡ºç°åŒæ—¶åœ¨åŒä¸€æ•°ç»„ä¸‹ç”¨é“¾è¡¨è¡¨ç¤ºï¼Œç»“æœåœ¨getæ—¶ä¼šå‡ºç°æ­»å¾ªç¯)ï¼Œå¯¼è‡´CPUåˆ©ç”¨ç‡æ¥è¿‘100%</strong>ã€‚</li>
</ul>
<p><strong>HashTableï¼šé—ç•™ç±»ï¼Œçº¿ç¨‹å®‰å…¨ã€‚</strong> å¾ˆå¤šæ˜ å°„çš„å¸¸ç”¨åŠŸèƒ½ä¸HashMapç±»ä¼¼ï¼Œä¸åŒçš„æ˜¯å®ƒæ‰¿è‡ªDictionaryç±»ï¼Œå¹¶ä¸”æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä»»ä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½è¿›å…¥Hashtableã€‚</p>
<ul>
<li>HashTable åªæœ‰ä¸€æŠŠé”ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹è®¿é—® HashTable çš„åŒæ­¥æ–¹æ³•æ—¶ï¼Œä¼šå°†æ•´å¼  table é”ä½ï¼Œå½“å…¶ä»–çº¿ç¨‹ä¹Ÿæƒ³è®¿é—® HashTable åŒæ­¥æ–¹æ³•æ—¶ï¼Œå°±ä¼šè¿›å…¥é˜»å¡æˆ–è½®è¯¢çŠ¶æ€ã€‚ä¹Ÿå°±æ˜¯ç¡®ä¿åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªçº¿ç¨‹å¯¹åŒæ­¥æ–¹æ³•çš„å ç”¨ï¼Œé¿å…å¤šä¸ªçº¿ç¨‹åŒæ—¶å¯¹æ•°æ®çš„ä¿®æ”¹ï¼Œç¡®ä¿çº¿ç¨‹çš„å®‰å…¨æ€§ã€‚ä½†æ˜¯ HashTable å¯¹ getï¼Œputï¼Œremove æ–¹æ³•éƒ½ä½¿ç”¨äº†åŒæ­¥æ“ä½œï¼Œè¿™å°±é€ æˆå¦‚æœä¸¤ä¸ªçº¿ç¨‹éƒ½åªæƒ³ä½¿ç”¨get æ–¹æ³•å»è¯»å–æ•°æ®æ—¶ï¼Œå› ä¸ºä¸€ä¸ªçº¿ç¨‹å…ˆåˆ°è¿›è¡Œäº†é”æ“ä½œï¼Œå¦ä¸€ä¸ªçº¿ç¨‹å°±ä¸å¾—ä¸ç­‰å¾…ï¼Œè¿™æ ·å¿…ç„¶å¯¼è‡´æ•ˆç‡ä½ä¸‹ï¼Œè€Œä¸”ç«äº‰è¶Šæ¿€çƒˆï¼Œæ•ˆç‡è¶Šä½ä¸‹ã€‚</li>
</ul>
<h3 id="jdk-17-concurrenthashmap">JDK 1.7 ConcurrentHashMap</h3>
<p><strong>ReentrantLock + Segment + HashEntry</strong></p>
<p><strong>JDK1.7ä¹‹å‰çš„ ConcurrentHashMap ä½¿ç”¨åˆ†æ®µé”æœºåˆ¶å®ç°ã€‚(JDK 1.5â€”JDK1.7)</strong></p>
<ul>
<li>ConcurrentHashMap åœ¨å¯¹è±¡ä¸­ä¿å­˜äº†ä¸€ä¸ªSegmentæ•°ç»„ï¼Œå³å°†æ•´ä¸ªHashè¡¨åˆ’åˆ†ä¸ºå¤šä¸ªåˆ†æ®µï¼›è€Œæ¯ä¸ªSegmentå…ƒç´ ï¼Œå³æ¯ä¸ªåˆ†æ®µåˆ™ç±»ä¼¼äºä¸€ä¸ªHashtableï¼›è¿™æ ·ï¼Œåœ¨æ‰§è¡Œputæ“ä½œæ—¶é¦–å…ˆæ ¹æ®hashç®—æ³•å®šä½åˆ°å…ƒç´ å±äºå“ªä¸ªSegmentï¼Œç„¶åå¯¹è¯¥SegmentåŠ é”å³å¯ã€‚</li>
</ul>
<hr>
<h3 id="jdk-18-concurrenthashmap">JDK 1.8 ConcurrentHashMap</h3>
<p><strong>Synchronized + CAS + HashEntry + Red-Black Tree</strong></p>
<p><strong>JDK 1.8 å·²ç»æŠ›å¼ƒäº†Segmentçš„æ¦‚å¿µï¼Œè™½ç„¶æºç é‡Œé¢è¿˜ä¿ç•™äº†ï¼Œä¹Ÿåªæ˜¯ä¸ºäº†å…¼å®¹æ€§çš„è€ƒè™‘ã€‚</strong><br>
<strong>JDK1.8 åˆ™ä½¿ç”¨<code>æ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘æ•°æ®ç»“æ„ã€å¹¶å‘æ§åˆ¶ä½¿ç”¨Synchronizedå’ŒCASåŸå­æ“ä½œ</code>å®ç°ConcurrentHashMap</strong></p>
<h4 id="casåŸç†-ä¹è§‚é”">CASåŸç† ï¼ˆä¹è§‚é”ï¼‰</h4>
<p><strong>ä¸€èˆ¬åœ°ï¼Œé”åˆ†ä¸ºæ‚²è§‚é”å’Œä¹è§‚é”ï¼š</strong></p>
<ul>
<li>
<p><strong><code>æ‚²è§‚é”</code></strong> è®¤ä¸ºå¯¹äºåŒä¸€ä¸ªæ•°æ®çš„å¹¶å‘æ“ä½œï¼Œä¸€å®šæ˜¯ä¸ºå‘ç”Ÿä¿®æ”¹çš„ï¼›</p>
</li>
<li>
<p><strong><code>ä¹è§‚é”</code></strong> è®¤ä¸ºå¯¹äºåŒä¸€ä¸ªæ•°æ®çš„å¹¶å‘æ“ä½œæ˜¯ä¸ä¼šå‘ç”Ÿä¿®æ”¹çš„ï¼Œåœ¨æ›´æ–°æ•°æ®æ—¶ä¼šé‡‡ç”¨å°è¯•æ›´æ–°ä¸æ–­é‡è¯•çš„æ–¹å¼æ›´æ–°æ•°æ®ã€‚</p>
</li>
</ul>
<hr>
<ul>
<li><strong>CASæœ‰ä¸‰ä¸ªæ“ä½œæ•°ï¼š</strong>
<ul>
<li>å†…å­˜å€¼ V</li>
<li>é¢„ä¼°å€¼ A</li>
<li>æ›´æ–°å€¼ B</li>
</ul>
</li>
</ul>
<p><strong>å½“ä¸”ä»…å½“ V == A æ—¶ï¼Œâ€“&gt; V = B; B èµ‹å€¼ç»™ V å¦åˆ™ï¼Œä¸ä¼šæ‰§è¡Œä»»ä½•æ“ä½œã€‚</strong></p>
<h4 id="æ¨¡æ‹Ÿcasç®—æ³•">æ¨¡æ‹ŸCASç®—æ³•</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestCompareAndSwap</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">final</span> CompareAndSwap cas = <span class="keyword">new</span> CompareAndSwap();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="comment">/*new Thread(new Runnable() &#123;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">                @Override</span></span><br><span class="line"><span class="comment">                public void run() &#123;</span></span><br><span class="line"><span class="comment">                    int expectedValue = cas.get();</span></span><br><span class="line"><span class="comment">                    boolean b = cas.compareAndSet(expectedValue, (int) (Math.random() * 101));</span></span><br><span class="line"><span class="comment">                    System.out.println(b);</span></span><br><span class="line"><span class="comment">                &#125;</span></span><br><span class="line"><span class="comment">            &#125;).start();*/</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">new</span> Thread(() -&gt;</span><br><span class="line">                    System.out.println(cas.compareAndSet(cas.get(), (<span class="keyword">int</span>) (Math.random() * <span class="number">101</span>)))</span><br><span class="line">            ).start();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CompareAndSwap</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> value;</span><br><span class="line">    <span class="comment">//è·å–å†…å­˜å€¼</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">int</span> <span class="title">get</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//æ¯”è¾ƒ</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">int</span> <span class="title">compareAndSwap</span><span class="params">(<span class="keyword">int</span> expectedValue, <span class="keyword">int</span> newValue)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> oldValue = value;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(oldValue == expectedValue)&#123;</span><br><span class="line">            <span class="keyword">this</span>.value = newValue;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> oldValue;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//è®¾ç½®</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">boolean</span> <span class="title">compareAndSet</span><span class="params">(<span class="keyword">int</span> expectedValue, <span class="keyword">int</span> newValue)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> expectedValue == compareAndSwap(expectedValue, newValue);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h4 id="concurrenthashmap-çš„putæ–¹æ³•å®ç°">ConcurrentHashMap çš„putæ–¹æ³•å®ç°</h4>
<p><strong>å®ç°æ€è·¯ï¼š</strong></p>
<ul>
<li>
<p><strong>1.å¦‚æœæ²¡æœ‰åˆå§‹åŒ–å°±å…ˆè°ƒç”¨ initTable() æ–¹æ³•æ¥è¿›è¡Œåˆå§‹åŒ–è¿‡ç¨‹ã€‚</strong></p>
</li>
<li>
<p><strong>2.å¦‚æœæ²¡æœ‰hashå†²çªå°±ç›´æ¥CASæ’å…¥ã€‚</strong></p>
</li>
<li>
<p><strong>3.å¦‚æœè¿˜åœ¨è¿›è¡Œæ‰©å®¹æ“ä½œå°±å…ˆè¿›è¡Œæ‰©å®¹ã€‚</strong></p>
</li>
<li>
<p><strong>4.å¦‚æœå­˜åœ¨hashå†²çªï¼Œå°±åŠ é”æ¥ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œè¿™é‡Œæœ‰ä¸¤ç§æƒ…å†µï¼Œä¸€ç§æ˜¯é“¾è¡¨å½¢å¼å°±ç›´æ¥éå†åˆ°å°¾ç«¯æ’å…¥ï¼Œä¸€ç§æ˜¯çº¢é»‘æ ‘å°±æŒ‰ç…§çº¢é»‘æ ‘ç»“æ„æ’å…¥</strong>ã€‚</p>
</li>
<li>
<p><strong>5.æœ€åä¸€ä¸ªå¦‚æœè¯¥é“¾è¡¨çš„æ•°é‡å¤§äºé˜ˆå€¼8ï¼Œå°±è¦å…ˆè½¬æ¢æˆé»‘çº¢æ ‘çš„ç»“æ„ï¼Œbreakå†ä¸€æ¬¡è¿›å…¥å¾ªç¯</strong>ã€‚</p>
</li>
<li>
<p><strong>6.å¦‚æœæ·»åŠ æˆåŠŸå°±è°ƒç”¨ addCount() æ–¹æ³•ç»Ÿè®¡sizeï¼Œå¹¶ä¸”æ£€æŸ¥æ˜¯å¦éœ€è¦æ‰©å®¹</strong>ã€‚</p>
</li>
</ul>
<hr>
<h4 id="concurrenthashmap-çš„getæ–¹æ³•å®ç°">ConcurrentHashMap çš„getæ–¹æ³•å®ç°</h4>
<p><strong>å®ç°æ€è·¯ï¼š</strong></p>
<ul>
<li>
<p><strong>1.è®¡ç®—hashå€¼ï¼Œå®šä½åˆ°è¯¥tableç´¢å¼•ä½ç½®ï¼Œå¦‚æœæ˜¯é¦–èŠ‚ç‚¹ç¬¦åˆå°±è¿”å›</strong>ã€‚</p>
</li>
<li>
<p><strong>2.å¦‚æœé‡åˆ°æ‰©å®¹çš„æ—¶å€™ï¼Œä¼šè°ƒç”¨æ ‡å¿—æ­£åœ¨æ‰©å®¹èŠ‚ç‚¹ForwardingNodeçš„findæ–¹æ³•ï¼ŒæŸ¥æ‰¾è¯¥èŠ‚ç‚¹ï¼ŒåŒ¹é…å°±è¿”å›</strong>ã€‚</p>
</li>
<li>
<p><strong>3.ä»¥ä¸Šéƒ½ä¸ç¬¦åˆçš„è¯ï¼Œå°±å¾€ä¸‹éå†èŠ‚ç‚¹ï¼ŒåŒ¹é…å°±è¿”å›ï¼Œå¦åˆ™æœ€åå°±è¿”å›null</strong> ã€‚</p>
</li>
</ul>
<hr>
<h2 id="6-javaé›†åˆç±»æ¡†æ¶çš„åŸºæœ¬æ¥å£">6ã€Javaé›†åˆç±»æ¡†æ¶çš„åŸºæœ¬æ¥å£</h2>
<ul>
<li>
<p><strong>Collection:ä»£è¡¨ä¸€ç»„å¯¹è±¡ï¼Œæ¯ä¸€ä¸ªå¯¹è±¡éƒ½æ˜¯ä»–çš„å­å…ƒç´ ;</strong></p>
<ul>
<li>
<p><strong>Setï¼šä¸åŒ…å«é‡å¤å…ƒç´ çš„Collectionï¼›</strong></p>
<ul>
<li><strong>HashSet</strong></li>
</ul>
</li>
<li>
<p><strong>Listï¼šæœ‰åºçš„Collectionï¼Œå¯ä»¥åŒ…å«é‡å¤å…ƒç´ ï¼›</strong></p>
<ul>
<li>
<p><strong>ArrayList</strong></p>
</li>
<li>
<p><strong>LinkedList</strong></p>
</li>
<li>
<p><strong>Vector</strong></p>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Mapï¼šå°†keyæ˜ å°„åˆ°valueçš„å¯¹è±¡ï¼Œkeyä¸èƒ½é‡å¤ã€‚</strong></p>
<ul>
<li><strong>HashMap</strong></li>
</ul>
</li>
</ul>
<hr>
<h2 id="7-å…³äºlistmapsetvectorhashtable">7ã€å…³äºList,Map,Set,Vector,HashTable</h2>
<h3 id="list">List ğŸ‘‡</h3>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testArrayList</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ArrayList&lt;String&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    list.add(<span class="keyword">null</span>);</span><br><span class="line">    list.add(<span class="keyword">null</span>);</span><br><span class="line">    Assert.assertEquals(<span class="number">2</span>,list.size()); <span class="comment">// success</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testLinkedList</span><span class="params">()</span></span>&#123;</span><br><span class="line">    LinkedList&lt;String&gt; list = <span class="keyword">new</span> LinkedList&lt;&gt;();</span><br><span class="line">    list.add(<span class="keyword">null</span>);</span><br><span class="line">    list.add(<span class="keyword">null</span>);</span><br><span class="line">    Assert.assertEquals(<span class="number">2</span>,list.size()); <span class="comment">// success</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>ArrayListåº•å±‚æ˜¯æ•°ç»„ï¼Œå¯ä»¥å­˜å‚¨å¤šä¸ªnullï¼Œæ·»åŠ  null å¹¶æœªå¯¹ä»–çš„æ•°æ®ç»“æ„é€ æˆå½±å“ã€‚</strong></li>
<li><strong>LinkedList åº•å±‚ä¸ºåŒå‘é“¾è¡¨ï¼Œ<code>node.value = null</code>ä¹Ÿæ²¡æœ‰å½±å“ã€‚</strong></li>
</ul>
<hr>
<h3 id="map">Map ğŸ‘‡</h3>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testHashMap</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    HashMap&lt;String, String&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    map.put(<span class="keyword">null</span>, <span class="keyword">null</span>);</span><br><span class="line">    map.put(<span class="keyword">null</span>, <span class="string">"1"</span>);</span><br><span class="line">    map.put(<span class="string">"2"</span>, <span class="keyword">null</span>);</span><br><span class="line">    <span class="keyword">for</span> (Map.Entry&lt;String, String&gt; entry : map.entrySet()) &#123;</span><br><span class="line">        String key = entry.getKey();</span><br><span class="line">        String value = entry.getValue();</span><br><span class="line">        System.out.println(key + <span class="string">"-&gt;"</span> + value);</span><br><span class="line">    &#125;</span><br><span class="line">    Assert.assertEquals(<span class="number">2</span>, map.size()); <span class="comment">//OK size = 2</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testTreeMap</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    TreeMap&lt;String, String&gt; map = <span class="keyword">new</span> TreeMap&lt;&gt;();</span><br><span class="line">    map.put(<span class="keyword">null</span>, <span class="keyword">null</span>);</span><br><span class="line">    Assert.assertEquals(<span class="number">1</span>, map.size()); <span class="comment">//Error NullPointException</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>HashMapä¸­æœ€å¤šåªæœ‰ä¸€ä¸ª<code>key == null</code>çš„èŠ‚ç‚¹ï¼Œå› ä¸ºkeyç›¸åŒæ—¶ï¼Œåé¢çš„èŠ‚ç‚¹ä¼šæ›¿æ¢ä¹‹å‰ç›¸åŒkeyçš„èŠ‚ç‚¹ï¼Œæ‰€ä»¥HashMapæ˜¯å¯ä»¥æ·»åŠ <code>key == null</code>çš„èŠ‚ç‚¹çš„ï¼Œåªä¸è¿‡åªä¼šå­˜åœ¨ä¸€ä¸ªï¼Œå¹¶ä¸” put() æ–¹æ³•è¿”å›æ—§å€¼ã€‚</strong></li>
<li><strong>TreeMapçš„putæ–¹æ³•ä¼šè°ƒç”¨ compareTo æ–¹æ³•ï¼Œå¯¹è±¡ä¸ºnullæ—¶ï¼Œä¼šæŠ¥ç©ºæŒ‡é’ˆé”™ã€‚</strong>
<ul>
<li><strong>TreeMapå­˜å‚¨ä¸¤ä¸ªå¯¹è±¡Keyå’ŒValueï¼ˆä»…ä»…keyå¯¹è±¡æœ‰åºï¼Œæ ¹æ®é”®æ’åºçš„æœ‰åºé›†åˆ)</strong>ã€‚</li>
<li><strong>TreeMapçš„åº•å±‚é‡‡ç”¨çº¢é»‘æ ‘çš„å®ç°ï¼Œå®Œæˆæ•°æ®æœ‰åºçš„æ’å…¥ï¼Œæ’åºã€‚</strong></li>
</ul>
</li>
</ul>
<hr>
<h3 id="set">SetğŸ‘‡</h3>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testHashSet</span><span class="params">()</span></span>&#123;</span><br><span class="line">    HashSet&lt;String&gt; set = <span class="keyword">new</span> HashSet&lt;&gt;();</span><br><span class="line">    set.add(<span class="keyword">null</span>);</span><br><span class="line">    Assert.assertEquals(<span class="number">1</span>,set.size()); <span class="comment">//OK size = 1</span></span><br><span class="line">    set.add(<span class="keyword">null</span>);</span><br><span class="line">    Assert.assertEquals(<span class="number">2</span>,set.size()); <span class="comment">//Error size = 1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testTreeSet</span><span class="params">()</span></span>&#123;</span><br><span class="line">    TreeSet&lt;String&gt; set = <span class="keyword">new</span> TreeSet&lt;&gt;();</span><br><span class="line">    set.add(<span class="keyword">null</span>); <span class="comment">//Error NullPointException</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p><strong>HashSet åº•å±‚æ˜¯HashMapï¼Œæ‰€ä»¥å®ƒçš„ add() è°ƒç”¨çš„æ˜¯ HashMapçš„ put()  ï¼Œä¹Ÿåªèƒ½æœ‰ä¸€ä¸ªnullã€‚</strong></p>
<ul>
<li>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">add</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> map.put(e, PRESENT)==<span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li>
<p><strong>TreeSet çš„ add() æ–¹æ³•ä¼šè°ƒç”¨ compareTo æ–¹æ³•ï¼Œå¯¹è±¡ä¸ºnullæ—¶ï¼Œä¼šæŠ¥ç©ºæŒ‡é’ˆé”™ã€‚</strong></p>
<ul>
<li>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">add</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> m.put(e, PRESENT)==<span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p><strong>TreeSetä¸­ä¸èƒ½æœ‰é‡å¤å¯¹è±¡ï¼Œè€ŒTreeMapä¸­å¯ä»¥å­˜åœ¨ã€‚(æ’åºé›†åˆ)</strong></p>
</li>
</ul>
</li>
</ul>
<hr>
<h3 id="vector">Vector ğŸ‘‡</h3>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">VectorTest</span><span class="params">()</span></span>&#123;</span><br><span class="line">    Vector box = <span class="keyword">new</span> Vector();</span><br><span class="line">    box.add(<span class="keyword">null</span>);</span><br><span class="line">    box.add(<span class="keyword">null</span>);</span><br><span class="line">    Assert.assertEquals(<span class="number">2</span>,box.size()); <span class="comment">//ok</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p><strong>Vector åº•å±‚æ˜¯æ•°ç»„ï¼Œå¯ä»¥å­˜å‚¨å¤šä¸ªnullã€‚add() æ–¹æ³•å¦‚ä¸‹ï¼š</strong></p>
<ul>
<li>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">boolean</span> <span class="title">add</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">    modCount++;</span><br><span class="line">    ensureCapacityHelper(elementCount + <span class="number">1</span>);</span><br><span class="line">    elementData[elementCount++] = e;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<hr>
<h3 id="hashtable">HashTable ğŸ‘‡</h3>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">HashTableTest</span><span class="params">()</span></span>&#123;</span><br><span class="line">    Hashtable table = <span class="keyword">new</span> Hashtable();</span><br><span class="line">    table.put(<span class="keyword">new</span> Object(),<span class="keyword">null</span>); <span class="comment">//Exception</span></span><br><span class="line">    <span class="comment">//table.put(null,new Object()); //Exception</span></span><br><span class="line">    <span class="comment">//table.put(null,null); //Exception</span></span><br><span class="line">    Assert.assertEquals(<span class="number">1</span>,table.size());<span class="comment">//NullPointerException</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p><strong>åº•å±‚ä¸ºæ•£åˆ—è¡¨ï¼Œæ— è®ºæ˜¯keyä¸ºnullï¼Œè¿˜æ˜¯valueä¸ºnullï¼Œéƒ½ä¼šæŠ¥é”™ã€‚</strong></p>
</li>
<li>
<p><strong>Why â€”&gt; æºç å¥‰ä¸Šï¼š</strong></p>
<ul>
<li>
<p>459è¡Œ -&gt; value éœ€è¦åˆ¤ç©ºï¼Œæ‰€ä»¥valueä¸å¯ä¸ºnullã€‚</p>
</li>
<li>
<p>465è¡Œ -&gt; keyéœ€è¦æ‹¥æœ‰å®ä¾‹å»è°ƒç”¨hashCodeæ–¹æ³•ï¼Œæ‰€ä»¥ä¹Ÿä¸èƒ½ä¸ºç©ºã€‚</p>
</li>
<li>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> V <span class="title">put</span><span class="params">(K key, V value)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// Make sure the value is not null</span></span><br><span class="line">    <span class="keyword">if</span> (value == <span class="keyword">null</span>) &#123; <span class="comment">//value éœ€è¦åˆ¤ç©ºï¼Œæ‰€ä»¥valueä¸å¯ä¸ºnull</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Makes sure the key is not already in the hashtable.</span></span><br><span class="line">    Entry&lt;?,?&gt; tab[] = table;</span><br><span class="line">    <span class="keyword">int</span> hash = key.hashCode();<span class="comment">//keyéœ€è¦æ‹¥æœ‰å®ä¾‹å»è°ƒç”¨hashCodeæ–¹æ³•ï¼Œæ‰€ä»¥ä¹Ÿä¸èƒ½ä¸ºç©º</span></span><br><span class="line">    <span class="keyword">int</span> index = (hash &amp; <span class="number">0x7FFFFFFF</span>) % tab.length;</span><br><span class="line">    <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line">    Entry&lt;K,V&gt; entry = (Entry&lt;K,V&gt;)tab[index];</span><br><span class="line">    <span class="keyword">for</span>(; entry != <span class="keyword">null</span> ; entry = entry.next) &#123;</span><br><span class="line">        <span class="keyword">if</span> ((entry.hash == hash) &amp;&amp; entry.key.equals(key)) &#123;</span><br><span class="line">            V old = entry.value;</span><br><span class="line">            entry.value = value;</span><br><span class="line">            <span class="keyword">return</span> old;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    addEntry(hash, key, value, index);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li>
<p><strong>å› ä¸º HashTableï¼ŒConcurrentHashMap ç”¨äºå¤šçº¿ç¨‹ï¼Œå¹¶å‘ã€‚å¦‚æœ table.get(key) å¾—åˆ°äº†nullï¼Œä¸èƒ½åˆ¤æ–­åˆ°åº•æ˜¯æ˜ å°„çš„ value æ˜¯nullï¼Œè¿˜æ˜¯å› ä¸ºæ²¡æœ‰æ‰¾åˆ°å¯¹åº”çš„ key è€Œä¸ºç©ºï¼Œè€Œç”¨äºå•çº¿ç¨‹çŠ¶æ€çš„ HashMap å´å¯ä»¥containsKey() å»åˆ¤æ–­åˆ°åº•æ˜¯å¦åŒ…å«äº†è¿™ä¸ª nullï¼›</strong></p>
</li>
<li>
<p><strong>ä¸ºä»€ä¹ˆ HashTable ä¸èƒ½ containsKey()ï¼Ÿ</strong></p>
<ul>
<li>å¤šçº¿ç¨‹çŠ¶æ€ä¸‹ï¼Œä¸€ä¸ªçº¿ç¨‹å…ˆ table.get(key) å† table.containsKey(key)ï¼Œåœ¨è¿™ä¸¤ä¸ªæ–¹æ³•çš„ä¸­é—´æ—¶åˆ»ï¼Œå…¶ä»–çº¿ç¨‹å¯èƒ½ä¼šæ“ä½œè¿™ä¸ª key ï¼Œä¾‹å¦‚åˆ é™¤ è¿™ä¸ª keyï¼›æ‰€ä»¥ä¸å®‰å…¨ã€‚</li>
</ul>
</li>
</ul>
<hr>
<h3 id="æ€»ç»“">æ€»ç»“</h3>
<ul>
<li>List éƒ½å¯ä»¥æ·»åŠ  null å…ƒç´ ã€‚</li>
<li>HashMap å¯ä»¥æœ‰1ä¸ªkeyä¸ºnullçš„å…ƒç´ ï¼ŒTreeMapä¸èƒ½æœ‰keyä¸º null çš„å…ƒç´ ã€‚</li>
<li>Setåº•å±‚æ˜¯Mapï¼š
<ul>
<li>æ‰€ä»¥HashSetå¯ä»¥æœ‰1ä¸ªnullçš„å…ƒç´ ï¼ŒTreeSetä¸èƒ½æœ‰keyä¸º null çš„å…ƒç´ ã€‚</li>
</ul>
</li>
<li>Vector åº•å±‚æ˜¯æ•°ç»„ï¼Œå¯ä»¥å­˜å‚¨å¤šä¸ªnullã€‚</li>
<li>HashTable åº•å±‚ä¸ºæ•£åˆ—è¡¨ï¼Œæ— è®ºæ˜¯keyä¸ºnullï¼Œè¿˜æ˜¯valueä¸ºnullï¼Œéƒ½ä¼šæŠ¥é”™ã€‚</li>
</ul>
<hr>
<h2 id="8-å¤šçº¿ç¨‹">8ã€å¤šçº¿ç¨‹</h2>
<h3 id="ä»€ä¹ˆæ˜¯çº¿ç¨‹">ä»€ä¹ˆæ˜¯çº¿ç¨‹ï¼Ÿ</h3>
<p><strong>æ ¹æœ¬åŒºåˆ«ï¼šè¿›ç¨‹æ˜¯æ“ä½œç³»ç»Ÿèµ„æºåˆ†é…çš„åŸºæœ¬å•ä½ï¼Œè€Œçº¿ç¨‹æ˜¯ CPU ä»»åŠ¡è°ƒåº¦å’Œæ‰§è¡Œçš„åŸºæœ¬å•ä½</strong>ã€‚</p>
<ul>
<li><strong>ä¸€ä¸ªç¨‹åº(è¿›ç¨‹)åŒæ—¶æ‰§è¡Œå¤šä¸ªä»»åŠ¡ï¼Œæ¯ä¸€ä¸ªä»»åŠ¡ç§°ä¸ºä¸€ä¸ªçº¿ç¨‹ã€‚</strong></li>
<li><strong>è¿›ç¨‹æ˜¯çº¿ç¨‹çš„å®¹å™¨ï¼Œä¸å­˜åœ¨æ²¡æœ‰çº¿ç¨‹çš„è¿›ç¨‹çš„ã€‚</strong></li>
</ul>
<h3 id="è¿›ç¨‹ä¸çº¿ç¨‹åŒºåˆ«"><strong>è¿›ç¨‹ä¸çº¿ç¨‹åŒºåˆ«</strong></h3>
<ul>
<li><strong>è¿›ç¨‹</strong>
<ul>
<li>è¿›ç¨‹æ˜¯ç¨‹åºè¿è¡Œå’Œæ“ä½œç³»ç»Ÿèµ„æºåˆ†é…çš„åŸºæœ¬å•ä½;</li>
<li>åŒä¸€è¿›ç¨‹ä¸­çš„å¤šä¸ªçº¿ç¨‹ä¹‹é—´å¯ä»¥å¹¶å‘æ‰§è¡Œã€‚</li>
<li>æœ¬è´¨åŒºåˆ«åœ¨äºæ¯ä¸ªè¿›ç¨‹æ‹¥æœ‰è‡ªå·±çš„ä¸€å¥—å˜é‡ä½¿ç”¨è‡ªå·±çš„å†…å­˜ç©ºé—´ï¼›</li>
</ul>
</li>
<li><strong>çº¿ç¨‹</strong>
<ul>
<li>çº¿ç¨‹æ˜¯è¿›ç¨‹çš„å­é›†ï¼Œä¸€ä¸ªè¿›ç¨‹å¯ä»¥æœ‰å¾ˆå¤šçº¿ç¨‹ï¼›</li>
<li>çº¿ç¨‹åˆ™å…±äº«ä¸€ç‰‡ç›¸åŒçš„å†…å­˜ç©ºé—´ï¼›æ¯ä¸ªçº¿ç¨‹éƒ½æ‹¥æœ‰å•ç‹¬çš„æ ˆå†…å­˜ç”¨æ¥å­˜å‚¨æœ¬åœ°æ•°æ®ã€‚</li>
<li>å…±äº«å˜é‡ä½¿çº¿ç¨‹ä¹‹é—´çš„é€šä¿¡æ¯”è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡æ›´æœ‰æ•ˆï¼Œæ›´å®¹æ˜“ï¼›</li>
<li>çº¿ç¨‹æ›´åŠ â€œè½»é‡çº§â€ï¼Œåˆ›å»ºã€æ’¤é”€ä¸€ä¸ªçº¿ç¨‹æ¯”å¯åŠ¨æ–°è¿›ç¨‹çš„å¼€é”€å°å¾—å¤šã€‚</li>
</ul>
</li>
</ul>
<hr>
<h3 id="å®ˆæŠ¤çº¿ç¨‹ä¸éå®ˆæŠ¤çº¿ç¨‹">å®ˆæŠ¤çº¿ç¨‹ä¸éå®ˆæŠ¤çº¿ç¨‹</h3>
<ul>
<li>
<p><strong>ç¨‹åºè¿è¡Œå®Œæ¯•ï¼Œjvmä¼šç­‰å¾…éå®ˆæŠ¤çº¿ç¨‹å®Œæˆåå…³é—­ï¼Œä½†æ˜¯jvmä¸ä¼šç­‰å¾…å®ˆæŠ¤çº¿ç¨‹ã€‚</strong></p>
</li>
<li>
<p><strong>å®ˆæŠ¤çº¿ç¨‹æœ€å…¸å‹çš„ä¾‹å­å°±æ˜¯GCçº¿ç¨‹ã€‚</strong></p>
</li>
</ul>
<h4 id="å®ˆæŠ¤çº¿ç¨‹">å®ˆæŠ¤çº¿ç¨‹</h4>
<ul>
<li><strong>åƒåœ¾å›æ”¶çº¿ç¨‹ï¼šGCçº¿ç¨‹</strong></li>
<li><strong>å½“ä¸»çº¿ç¨‹è¿è¡Œçš„æ—¶å€™ï¼Œåƒåœ¾å›æ”¶çº¿ç¨‹ä¸€èµ·è¿è¡Œã€‚å½“ä¸»çº¿ç¨‹é”€æ¯ï¼Œä¼šå’Œä¸»çº¿ç¨‹ä¸€èµ·é”€æ¯ã€‚</strong></li>
</ul>
<h4 id="éå®ˆæŠ¤çº¿ç¨‹ç”¨æˆ·çº¿ç¨‹">éå®ˆæŠ¤çº¿ç¨‹(ç”¨æˆ·çº¿ç¨‹)</h4>
<ul>
<li><strong>éå®ˆæŠ¤çº¿ç¨‹å³æˆ‘ä»¬æ‰‹åŠ¨åˆ›å»ºçš„çº¿ç¨‹</strong>ã€‚</li>
<li><strong>å¦‚æœä¸»çº¿ç¨‹é”€æ¯ï¼Œç”¨æˆ·çº¿ç¨‹ç»§ç»­è¿è¡Œä¸”äº’ä¸å½±å“ã€‚</strong></li>
</ul>
<p><strong>åˆ›å»ºå®ˆæŠ¤çº¿ç¨‹</strong> ğŸ‘‡</p>
<ul>
<li><strong>å¿…é¡»åœ¨ <code>t1.start()</code>ä¹‹å‰è®¾ç½®å®ˆæŠ¤çº¿ç¨‹ <code>t1.setDaemon(true);</code></strong></li>
<li><strong>ä¸èƒ½æŠŠæ­£åœ¨è¿è¡Œçš„å¸¸è§„çº¿ç¨‹è®¾ç½®ä¸ºå®ˆæŠ¤çº¿ç¨‹,å¦åˆ™æŠ¥IllegalThreadStateExceptionå¼‚å¸¸ã€‚</strong></li>
<li><strong>ä¸»çº¿ç¨‹ç»“æŸä¹‹åå¹¶æ²¡æœ‰åœ¨ç»§ç»­è¿è¡Œå®ˆæŠ¤çº¿ç¨‹ï¼Œå®ˆæŠ¤çº¿ç¨‹ä¹Ÿè·Ÿç€ç»“æŸï¼Œä¸€èµ·é”€æ¯åœæ­¢ã€‚</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DaemonThread</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">        <span class="comment">/*Thread t1 = new Thread(new Runnable() &#123;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">            @Override</span></span><br><span class="line"><span class="comment">            public void run() &#123;</span></span><br><span class="line"><span class="comment">                while (true) &#123;</span></span><br><span class="line"><span class="comment">                    try &#123;</span></span><br><span class="line"><span class="comment">                        Thread.sleep(1000);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">                    &#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="comment">                        e.printStackTrace();</span></span><br><span class="line"><span class="comment">                    &#125;</span></span><br><span class="line"><span class="comment">                    System.out.println("æˆ‘æ˜¯å­çº¿ç¨‹(ç”¨æˆ·çº¿ç¨‹)");</span></span><br><span class="line"><span class="comment">                &#125;</span></span><br><span class="line"><span class="comment">            &#125;</span></span><br><span class="line"><span class="comment">        &#125;);*/</span></span><br><span class="line">        Thread t1 = <span class="keyword">new</span> Thread(() -&gt; &#123;</span><br><span class="line">            <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    Thread.sleep(<span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">                System.out.println(<span class="string">"æˆ‘æ˜¯å­çº¿ç¨‹(ç”¨æˆ·çº¿ç¨‹)"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// TODO æ ‡è¯†å½“å‰æ–¹æ³•ä¸ºå®ˆæŠ¤çº¿ç¨‹ï¼Œä¸€å®šè¦åœ¨å¯åŠ¨çº¿ç¨‹å‰è®¾ç½®ä¸ºå®ˆæŠ¤çº¿ç¨‹</span></span><br><span class="line">        t1.setDaemon(<span class="keyword">true</span>);</span><br><span class="line">        t1.start();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ç›¸å½“ä¸ä¸»çº¿ç¨‹</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Thread.sleep(<span class="number">300</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(<span class="string">"main:i:"</span> + i);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">"ä¸»çº¿ç¨‹æ‰§è¡Œå®Œæ¯•..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// TODO</span></span><br><span class="line">main:i:<span class="number">0</span></span><br><span class="line">main:i:<span class="number">1</span></span><br><span class="line">main:i:<span class="number">2</span></span><br><span class="line">æˆ‘æ˜¯å­çº¿ç¨‹(ç”¨æˆ·çº¿ç¨‹)</span><br><span class="line">main:i:<span class="number">3</span></span><br><span class="line">main:i:<span class="number">4</span></span><br><span class="line">main:i:<span class="number">5</span></span><br><span class="line">æˆ‘æ˜¯å­çº¿ç¨‹(ç”¨æˆ·çº¿ç¨‹)</span><br><span class="line">main:i:<span class="number">6</span></span><br><span class="line">main:i:<span class="number">7</span></span><br><span class="line">main:i:<span class="number">8</span></span><br><span class="line">æˆ‘æ˜¯å­çº¿ç¨‹(ç”¨æˆ·çº¿ç¨‹)</span><br><span class="line">main:i:<span class="number">9</span></span><br><span class="line">ä¸»çº¿ç¨‹æ‰§è¡Œå®Œæ¯•...</span><br></pre></td></tr></table></figure>
<p><strong>éå®ˆæŠ¤çº¿ç¨‹ï¼šå¦‚æœä¸»çº¿ç¨‹é”€æ¯ï¼Œç”¨æˆ·çº¿ç¨‹ç»§ç»­è¿è¡Œä¸”äº’ä¸å½±å“ã€‚</strong> ğŸ‘‡</p>
<p><strong>å½“ä¸»çº¿ç¨‹é”€æ¯åœæ­¢ï¼Œéå®ˆæŠ¤çº¿ç¨‹ï¼ˆç”¨æˆ·çº¿ç¨‹ï¼‰å¹¶æ²¡æœ‰ç»“æŸï¼Œè€Œæ˜¯ä¸€ç›´åœ¨æ‰§è¡Œï¼Œä¸ä¸»çº¿ç¨‹äº’ä¸å½±å“ã€‚</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NotDaemonThread</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">       <span class="comment">/* Thread t1 = new Thread(new Runnable() &#123;</span></span><br><span class="line"><span class="comment">            @Override</span></span><br><span class="line"><span class="comment">            public void run() &#123;</span></span><br><span class="line"><span class="comment">                while (true) &#123;</span></span><br><span class="line"><span class="comment">                    try &#123;</span></span><br><span class="line"><span class="comment">                        Thread.sleep(1000);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">                    &#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="comment">                        e.printStackTrace();</span></span><br><span class="line"><span class="comment">                    &#125;</span></span><br><span class="line"><span class="comment">                    System.out.println("æˆ‘æ˜¯å­çº¿ç¨‹(ç”¨æˆ·çº¿ç¨‹)");</span></span><br><span class="line"><span class="comment">                &#125;</span></span><br><span class="line"><span class="comment">            &#125;</span></span><br><span class="line"><span class="comment">        &#125;);*/</span></span><br><span class="line"></span><br><span class="line">        Thread t1 = <span class="keyword">new</span> Thread(() -&gt; &#123;</span><br><span class="line">            <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    Thread.sleep(<span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">                System.out.println(<span class="string">"æˆ‘æ˜¯å­çº¿ç¨‹(ç”¨æˆ·çº¿ç¨‹)"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">// TODO å¯åŠ¨çº¿ç¨‹ æ²¡æœ‰å¼€å¯å®ˆæŠ¤çº¿ç¨‹</span></span><br><span class="line">        t1.start();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ç›¸å½“ä¸ä¸»çº¿ç¨‹</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Thread.sleep(<span class="number">300</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(<span class="string">"main:i:"</span> + i);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">"ä¸»çº¿ç¨‹æ‰§è¡Œå®Œæ¯•..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// TODO</span></span><br><span class="line">main:i:<span class="number">0</span></span><br><span class="line">main:i:<span class="number">1</span></span><br><span class="line">main:i:<span class="number">2</span></span><br><span class="line">æˆ‘æ˜¯å­çº¿ç¨‹(ç”¨æˆ·çº¿ç¨‹)</span><br><span class="line">main:i:<span class="number">3</span></span><br><span class="line">main:i:<span class="number">4</span></span><br><span class="line">main:i:<span class="number">5</span></span><br><span class="line">æˆ‘æ˜¯å­çº¿ç¨‹(ç”¨æˆ·çº¿ç¨‹)</span><br><span class="line">main:i:<span class="number">6</span></span><br><span class="line">main:i:<span class="number">7</span></span><br><span class="line">main:i:<span class="number">8</span></span><br><span class="line">æˆ‘æ˜¯å­çº¿ç¨‹(ç”¨æˆ·çº¿ç¨‹)</span><br><span class="line">main:i:<span class="number">9</span></span><br><span class="line">ä¸»çº¿ç¨‹æ‰§è¡Œå®Œæ¯•...</span><br><span class="line">æˆ‘æ˜¯å­çº¿ç¨‹(ç”¨æˆ·çº¿ç¨‹)</span><br><span class="line">æˆ‘æ˜¯å­çº¿ç¨‹(ç”¨æˆ·çº¿ç¨‹)</span><br><span class="line">æˆ‘æ˜¯å­çº¿ç¨‹(ç”¨æˆ·çº¿ç¨‹)</span><br><span class="line">......</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="9-synchronized-amp-lock-åŒºåˆ«">9ã€Synchronized &amp; lock åŒºåˆ«</h2>
<p><strong>synchronizedæ˜¯å…³é”®å­—å±äºJVMå±‚é¢ï¼Œåº•å±‚æ˜¯é€šè¿‡monitorå¯¹è±¡æ¥å®Œæˆï¼Œå…¶å®wait/notifyç­‰æ–¹æ³•ä¹Ÿä¾èµ–monitor å¯¹è±¡åªæœ‰åœ¨åŒæ­¥ä»£ç å—å’ŒåŒæ­¥æ–¹æ³•ä¸­æ‰èƒ½è°ƒç”¨wait/notifyç­‰æ–¹æ³•)</strong></p>
<p><strong>Lock æ˜¯ä¸€ä¸ªæ¥å£ï¼Œæ˜¯ API å±‚é¢çš„é”ï¼›é»˜è®¤éå…¬å¹³é”ã€‚</strong></p>
<ul>
<li><strong>é”çš„é‡Šæ”¾ï¼š</strong>
<ul>
<li><strong><code>Synchronized</code> åœ¨çº¿ç¨‹å‘ç”Ÿå¼‚å¸¸æ—¶ä¼šè‡ªåŠ¨é‡Šæ”¾é”ï¼Œå› æ­¤ä¸ä¼šå‘ç”Ÿå¼‚å¸¸æ­»é”ã€‚</strong></li>
<li><strong><code>Lock</code> å¼‚å¸¸æ—¶ä¸ä¼šè‡ªåŠ¨é‡Šæ”¾é”ï¼Œæ‰€ä»¥éœ€è¦åœ¨finallyä¸­å®ç°é‡Šæ”¾é”ã€‚</strong></li>
</ul>
</li>
<li><strong>é”çš„è·å–ï¼š</strong>
<ul>
<li><strong><code>Synchronized</code> å‡è®¾Açº¿ç¨‹è·å¾—é”ï¼ŒBçº¿ç¨‹ç­‰å¾…ã€‚å¦‚æœAçº¿ç¨‹é˜»å¡ï¼ŒBçº¿ç¨‹ä¼šä¸€ç›´ç­‰å¾…ã€‚</strong></li>
<li><strong><code>Lock</code> éœ€åœ¨finallyä¸­æ‰‹å·¥é‡Šæ”¾é”ï¼ˆunlock()æ–¹æ³•é‡Šæ”¾é”ï¼‰ï¼Œå¦åˆ™å®¹æ˜“é€ æˆçº¿ç¨‹æ­»é”ï¼›</strong></li>
</ul>
</li>
<li><strong>åº•å±‚å®ç°åŒºåˆ«ï¼š</strong>
<ul>
<li><strong>Synchronizedï¼š</strong> åº•å±‚ä½¿ç”¨æŒ‡ä»¤ç æ–¹å¼æ¥æ§åˆ¶é”çš„ï¼Œæ˜ å°„æˆå­—èŠ‚ç æŒ‡ä»¤å°±æ˜¯å¢åŠ æ¥ä¸¤ä¸ªæŒ‡ä»¤ï¼š<code>monitorenter</code> å’Œ <code>monitorexit</code>ã€‚å½“çº¿ç¨‹æ‰§è¡Œé‡åˆ° <code>monitorenter</code> æŒ‡ä»¤æ—¶ä¼šå°è¯•è·å–å†…ç½®é”ï¼Œå¦‚æœè·å–é”åˆ™é”è®¡æ•°å™¨+1ï¼Œå¦‚æœæ²¡æœ‰è·å–é”åˆ™é˜»å¡ï¼›å½“é‡åˆ° <code>monitorexit</code> æŒ‡ä»¤æ—¶é”è®¡æ•°å™¨-1ï¼Œå¦‚æœè®¡æ•°å™¨ä¸º0åˆ™é‡Šæ”¾é”ã€‚</li>
<li><strong>Lockï¼š</strong> åº•å±‚æ˜¯CASä¹è§‚é”ï¼Œä¾èµ– AbstractQueuedSynchronizer ç±»ï¼ŒæŠŠæ‰€æœ‰çš„è¯·æ±‚çº¿ç¨‹æ„æˆä¸€ä¸ªCLHé˜Ÿåˆ—ã€‚è€Œå¯¹è¯¥é˜Ÿåˆ—çš„æ“ä½œå‡é€šè¿‡Lock-Freeï¼ˆCASï¼‰æ“ä½œã€‚</li>
</ul>
</li>
<li><strong>Lock å¯ä»¥ä½¿ç”¨è¯»é”æé«˜å¤šçº¿ç¨‹è¯»æ•ˆç‡ã€‚ï¼ˆReadWriteLockï¼‰</strong></li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">å±‚æ¬¡</th>
<th style="text-align:center">Synchronized Javaå…³é”®å­—ï¼Œjvm å±‚é¢ä¸Š</th>
<th style="text-align:center">Lock æ˜¯ä¸€ä¸ªæ¥å£ï¼ŒJava API å±‚</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">é”çŠ¶æ€</td>
<td style="text-align:center">æ— æ³•åˆ¤æ–­</td>
<td style="text-align:center">å¯ä»¥åˆ¤æ–­</td>
</tr>
<tr>
<td style="text-align:center">é”ç±»å‹</td>
<td style="text-align:center"><strong>éšå¼é”</strong>  å¯é‡å…¥ ä¸å¯ä¸­æ–­  éå…¬å¹³</td>
<td style="text-align:center"><strong>æ˜¾ç¤ºé”</strong> å¯é‡å…¥ å¯ä¸­æ–­ å¯å…¬å¹³ï¼ˆä¸¤è€…çš†å¯ï¼‰</td>
</tr>
<tr>
<td style="text-align:center">æ€§èƒ½</td>
<td style="text-align:center">æ‚²è§‚é” é€‚ç”¨å°‘é‡åŒæ­¥</td>
<td style="text-align:center">ä¹è§‚é”ï¼ˆCASï¼‰ é€‚ç”¨å¤§é‡åŒæ­¥</td>
</tr>
<tr>
<td style="text-align:center">å”¤é†’</td>
<td style="text-align:center">éšæœºå”¤é†’ 1 ä¸ªæˆ– å”¤é†’å…¨éƒ¨çº¿ç¨‹ã€‚</td>
<td style="text-align:center">å¯ç²¾ç¡®å”¤é†’</td>
</tr>
</tbody>
</table>
<hr>
<h3 id="é”çš„åˆ†ç±»">é”çš„åˆ†ç±»</h3>
<ul>
<li><strong>å¯é‡å…¥é”ï¼š</strong> Synchronizedå’ŒReentrantLookéƒ½æ˜¯å¯é‡å…¥é”ï¼Œé”çš„å¯é‡å…¥æ€§æ ‡æ˜äº†é”æ˜¯é’ˆå¯¹çº¿ç¨‹åˆ†é…æ–¹å¼è€Œä¸æ˜¯é’ˆå¯¹æ–¹æ³•ã€‚ä¾‹å¦‚è°ƒç”¨Synchronizedæ–¹æ³•Aä¸­å¯ä»¥è°ƒç”¨Synchronizedæ–¹æ³•Bï¼Œè€Œä¸éœ€è¦é‡æ–°ç”³è¯·é”ã€‚</li>
<li><strong>è¯»å†™é”ï¼š</strong> æŒ‰ç…§æ•°æ®åº“äº‹åŠ¡éš”ç¦»ç‰¹æ€§çš„ç±»æ¯”è¯»å†™é”ï¼Œåœ¨è®¿é—®ç»Ÿä¸€ä¸ªèµ„æºï¼ˆä¸€ä¸ªæ–‡ä»¶ï¼‰çš„æ—¶å€™ï¼Œä½¿ç”¨è¯»é”æ¥ä¿è¯å¤šçº¿ç¨‹å¯ä»¥åŒæ­¥è¯»å–èµ„æºã€‚ReadWriteLockæ˜¯ä¸€ä¸ªè¯»å†™é”ï¼Œé€šè¿‡readLock()è·å–è¯»é”ï¼Œé€šè¿‡writeLock()è·å–å†™é”ã€‚</li>
<li><strong>å¯ä¸­æ–­é”ï¼š</strong> å¯ä¸­æ–­æ˜¯æŒ‡é”æ˜¯å¯ä»¥è¢«ä¸­æ–­çš„ï¼ŒSynchronizedå†…ç½®é”æ˜¯ä¸å¯ä¸­æ–­é”ï¼ŒReentrantLockå¯ä»¥é€šè¿‡lockInterruptibly() æ–¹æ³•ä¸­æ–­æ˜¾æ€§é”ã€‚ä¾‹å¦‚çº¿ç¨‹Båœ¨ç­‰å¾…çº¿ç¨‹Aé‡Šæ”¾é”ï¼Œä½†æ˜¯çº¿ç¨‹Bç”±äºç­‰å¾…æ—¶é—´å¤ªä¹…ï¼Œå¯ä»¥ä¸»åŠ¨ä¸­æ–­ç­‰å¾…é”ã€‚</li>
<li><strong>å…¬å¹³é”ï¼š</strong> å…¬å¹³é”æ˜¯æŒ‡å°½é‡ä»¥çº¿ç¨‹çš„ç­‰å¾…æ—¶é—´å…ˆåé¡ºåºè·å–é”ï¼Œç­‰å¾…æ—¶é—´æœ€ä¹…çš„çº¿ç¨‹ä¼˜å…ˆè·å–é”ã€‚synchronized éšæ€§é”æ˜¯éå…¬å¹³é”ï¼Œå®ƒæ— æ³•ä¿è¯ç­‰å¾…çš„çº¿ç¨‹è·å–é”çš„é¡ºåºï¼ŒReentrantLookå¯ä»¥è‡ªå·±æ§åˆ¶æ˜¯å¦å…¬å¹³é”ã€‚</li>
</ul>
<hr>
<h3 id="reentrantlock-å…¬å¹³é”å’Œéå…¬å¹³é”">ReentrantLock å…¬å¹³é”å’Œéå…¬å¹³é”</h3>
<p><strong>ReentrantLock é»˜è®¤é‡‡ç”¨éå…¬å¹³é”ï¼Œé™¤éåœ¨æ„é€ æ–¹æ³•ä¸­ä¼ å…¥å‚æ•° true ï¼Œä¸ºå…¬å¹³é”ã€‚æºç å¦‚ä¸‹ï¼šğŸ‘‡</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* Creates an instance of &#123;<span class="doctag">@code</span> ReentrantLock&#125;.</span></span><br><span class="line"><span class="comment">* This is equivalent to using &#123;<span class="doctag">@code</span> ReentrantLock(false)&#125;.</span></span><br><span class="line"><span class="comment">* default false</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">ReentrantLock</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    sync = <span class="keyword">new</span> NonfairSync();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* Creates an instance of &#123;<span class="doctag">@code</span> ReentrantLock&#125; with the</span></span><br><span class="line"><span class="comment">* given fairness policy.</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> fair &#123;<span class="doctag">@code</span> true&#125; if this lock should use a fair ordering policy</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">ReentrantLock</span><span class="params">(<span class="keyword">boolean</span> fair)</span> </span>&#123;</span><br><span class="line">    sync = fair ? <span class="keyword">new</span> FairSync() : <span class="keyword">new</span> NonfairSync();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="10-äº§ç”Ÿæ­»é”çš„æ¡ä»¶">10ã€äº§ç”Ÿæ­»é”çš„æ¡ä»¶</h2>
<p>æ­»é”æ˜¯æŒ‡ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„è¿›ç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå› äº‰å¤ºèµ„æºè€Œé€ æˆçš„ä¸€ç§äº’ç›¸ç­‰å¾…çš„ç°è±¡ï¼Œè‹¥æ— å¤–åŠ›ä½œç”¨ï¼Œå®ƒä»¬éƒ½å°†æ— æ³•æ¨è¿›ä¸‹å»ã€‚</p>
<p><strong>æ­»é”çš„å‘ç”Ÿå¿…é¡»æ»¡è¶³ä»¥ä¸‹å››ä¸ªæ¡ä»¶ï¼š</strong></p>
<ul>
<li>äº’æ–¥æ¡ä»¶ï¼šä¸€ä¸ªèµ„æºæ¯æ¬¡åªèƒ½è¢«ä¸€ä¸ªè¿›ç¨‹ä½¿ç”¨ã€‚</li>
<li>è¯·æ±‚ä¸ä¿æŒæ¡ä»¶ï¼šä¸€ä¸ªè¿›ç¨‹å› è¯·æ±‚èµ„æºè€Œé˜»å¡æ—¶ï¼Œå¯¹å·²è·å¾—çš„èµ„æºä¿æŒä¸æ”¾ã€‚</li>
<li>ä¸å‰¥å¤ºæ¡ä»¶ï¼šè¿›ç¨‹å·²è·å¾—çš„èµ„æºï¼Œåœ¨æœ«ä½¿ç”¨å®Œä¹‹å‰ï¼Œä¸èƒ½å¼ºè¡Œå‰¥å¤ºã€‚</li>
<li>å¾ªç¯ç­‰å¾…æ¡ä»¶ï¼šè‹¥å¹²è¿›ç¨‹ä¹‹é—´å½¢æˆä¸€ç§å¤´å°¾ç›¸æ¥çš„å¾ªç¯ç­‰å¾…èµ„æºå…³ç³»ã€‚</li>
</ul>
<hr>
<h2 id="10-ä¸ºä»€ä¹ˆé€‰æ‹©mysqlæ•°æ®åº“">10ã€ä¸ºä»€ä¹ˆé€‰æ‹©MySQLæ•°æ®åº“</h2>
<ul>
<li>2008å¹´é˜¿é‡Œæå‡ºå»IOEã€‚Oâ€”&gt;Oracle</li>
<li>MySql æ€§èƒ½å“è¶Šï¼ŒæœåŠ¡ç¨³å®šï¼Œå¾ˆå°‘å‡ºç°å®•æœºï¼›</li>
<li>å¼€æ”¾æºä»£ç ä¸”æ— ç‰ˆæƒåˆ¶çº¦ï¼Œè‡ªä¸»æ€§ï¼Œä½¿ç”¨æˆæœ¬ä½ï¼›</li>
<li>å†å²æ‚ ä¹…ï¼Œç¤¾åŒºç”¨æˆ·éå¸¸æ´»è·ƒï¼Œé‡åˆ°é—®é¢˜å¯ä»¥å¯»æ±‚å¸®åŠ©ï¼›</li>
<li>è½¯ä»¶ä½“ç§¯å°ï¼Œå®‰è£…ä½¿ç”¨ç®€å•ï¼Œå¹¶ä¸”æ˜“äºç»´æŠ¤ï¼›</li>
<li>å“ç‰Œå£ç¢‘æ•ˆåº”ï¼Œä½¿å¾—ä¼ä¸šæ— éœ€è€ƒè™‘å°±ç›´æ¥ç”¨ä¹‹ï¼ŒLAMP LEMPæµè¡Œæ¶æ„ï¼›</li>
<li>æ”¯æŒå¤šç§æ“ä½œç³»ç»Ÿï¼Œæä¾›å¤šä¸ªAPIæ¥å£ï¼Œæ”¯æŒå¤šä¸ªå¼€å‘è¯­è¨€ã€‚</li>
</ul>
<hr>
<h2 id="11-ç³»ç»Ÿè®¾ç½®çš„ä¸»é”®ä¸æˆ‘ä»¬å®šä¹‰çš„ä¸»é”®åŒºåˆ«">11ã€ç³»ç»Ÿè®¾ç½®çš„ä¸»é”®ä¸æˆ‘ä»¬å®šä¹‰çš„ä¸»é”®åŒºåˆ«</h2>
<ul>
<li>æ²¡æœ‰æ ¹æœ¬æ€§åŒºåˆ«ï¼Œåªæ˜¯ç³»ç»Ÿè‡ªåŠ¨æ·»åŠ çš„ä¸€èˆ¬æ•°æ®ç±»å‹æ˜¯è‡ªåŠ¨ç¼–å·å‹ï¼Œæ•°æ®æ˜¯ç³»ç»Ÿç»´æŠ¤ï¼›</li>
<li>è€Œè‡ªå·±å®šä¹‰çš„ä¸»é”®ï¼Œå¯ä»¥é€‰æ‹©å…¶ä»–æ•°æ®ç±»å‹ï¼Œè‡ªå·±ç»´æŠ¤æ•°æ®ã€‚</li>
</ul>
<hr>
<h2 id="12-æœ‰æ— ä¸»é”®åŒºåˆ«">12ã€æœ‰æ— ä¸»é”®åŒºåˆ«</h2>
<ul>
<li>æ²¡æœ‰ä¸»é”®ï¼Œè¡¨ä¸­å¯ä»¥æœ‰é‡å¤çš„è¡Œï¼›</li>
<li>æœ‰ä¸»é”®ï¼Œè¡¨ä¸­ä¸å¯ä»¥æœ‰é‡å¤çš„è¡Œï¼›</li>
<li>ä¸»é”®çš„å¥½å¤„æ˜¯èƒ½å”¯ä¸€ç¡®å®šè¡¨ä¸­çš„è¡Œï¼Œä½“ç°åˆ°ç°å®ä¸–ç•Œä¸­å°±æ˜¯èƒ½åŒºåˆ«äº‹ç‰©ã€‚å¤šä¸ªå­—æ®µä¸ºè¡¨çš„ä¸»é”®ä»£è¡¨è¿™äº›å­—æ®µçš„å€¼ç»„åˆèµ·æ¥æ‰èƒ½ç¡®å®šè¡¨ä¸­çš„ä¸€è¡Œï¼Œé€‰è¯¾ï¼ˆå­¦ç”Ÿå­¦å·ï¼Œè¯¾ç¨‹å·ï¼Œåˆ†æ•°ï¼‰ä¸»é”®ä¸ºå­¦å·å’Œè¯¾ç¨‹å·çš„ç»„åˆï¼Œåªæœ‰è¿™ä¸¤ä¸ªå€¼ç¡®å®šäº†ï¼Œé€‰è¯¾è¡¨ä¸­çš„ä¸€è¡Œæ‰èƒ½è¢«å”¯ä¸€çš„ç¡®å®šã€‚</li>
</ul>

                

                <hr>
                <!-- Pager -->
                <ul class="pager">
                    
                        <li class="previous">
                            <a href="/article/ShardingSphere/" data-toggle="tooltip" data-placement="top" title="ShardingSphere">&larr; Previous Post</a>
                        </li>
                    
                    
                        <li class="next">
                            <a href="/article/java-util-concurrent/" data-toggle="tooltip" data-placement="top" title="java.util.concurrent">Next Post &rarr;</a>
                        </li>
                    
                </ul>

                <br>

                <!--æ‰“èµ-->
                
                    <div class="reward">
                        <div class="reward-button">èµ <span class="reward-code"> 
                            <span class="alipay-code"> <img class="alipay-img" src="http://ww1.sinaimg.cn/large/006vWPzFly1g0o77ru34uj30dz0drdhv.jpg"><b>æ”¯ä»˜å®æ‰“èµ</b></span> 
                            <span class="wechat-code"> <img class="wechat-img" src="http://ww1.sinaimg.cn/large/006vWPzFly1g0o740lhb9j30rb0ov77z.jpg"><b>å¾®ä¿¡æ‰“èµ</b> </span>
                            </span></div>
                        <p class="reward-notice">èµèµä¸€ä¸‹</p>
                    </div>
                
                <!--æ‰“èµ-->

                <br>
                <!--åˆ†äº«-->
                
                <!--åˆ†äº«-->
                <br>                       
                
                <!-- require APlayer -->
                

                <!-- duoshuo Share start -->
                
                <!-- å¤šè¯´ Share end-->

                <!-- å¤šè¯´è¯„è®ºæ¡† start -->
                
                <!-- å¤šè¯´è¯„è®ºæ¡† end -->

                <!-- disqus comment start -->
                
                <!-- disqus comment end -->

                

            </div>
            
            <!-- Tabe of Content -->
            <!-- Table of Contents -->

  
    <style>
      span.toc-nav-number{
        display: none
      }
    </style>
  
    
      <aside id="sidebar">
        <div id="toc" class="toc-article">
        <strong class="toc-title">Contents</strong>
        
          <ol class="toc-nav"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#1-equals-amp-hashcode"><span class="toc-nav-number">1.</span> <span class="toc-nav-text">1&#x3001;equals() &amp; hashCode()</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#2-equals-amp"><span class="toc-nav-number">2.</span> <span class="toc-nav-text">2&#x3001;equals &amp; ==</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#"><span class="toc-nav-number">2.1.</span> <span class="toc-nav-text"></span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#3-hashmap"><span class="toc-nav-number">3.</span> <span class="toc-nav-text">3&#x3001;HashMap</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#jdk-18-hashmap-å®ç°åŸç†"><span class="toc-nav-number">3.1.</span> <span class="toc-nav-text">JDK 1.8 HashMap &#x5B9E;&#x73B0;&#x539F;&#x7406;</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#å­˜å‚¨ç»“æ„-å­—æ®µ"><span class="toc-nav-number">3.1.1.</span> <span class="toc-nav-text">&#x5B58;&#x50A8;&#x7ED3;&#x6784;-&#x5B57;&#x6BB5;</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#hash-å†²çª"><span class="toc-nav-number">3.1.2.</span> <span class="toc-nav-text">Hash &#x51B2;&#x7A81;</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#æ‰©å®¹æœºåˆ¶"><span class="toc-nav-number">3.1.3.</span> <span class="toc-nav-text">&#x6269;&#x5BB9;&#x673A;&#x5236;</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#hashmapçš„putæ–¹æ³•å®ç°"><span class="toc-nav-number">3.1.4.</span> <span class="toc-nav-text">HashMap&#x7684;put&#x65B9;&#x6CD5;&#x5B9E;&#x73B0;</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#hashmapçš„getæ–¹æ³•å®ç°"><span class="toc-nav-number">3.1.5.</span> <span class="toc-nav-text">HashMap&#x7684;get&#x65B9;&#x6CD5;&#x5B9E;&#x73B0;</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#4-hashset"><span class="toc-nav-number">4.</span> <span class="toc-nav-text">4&#x3001;HashSet</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#hashset-å…ƒç´ ä¸é‡å¤"><span class="toc-nav-number">4.1.</span> <span class="toc-nav-text">HashSet &#x5143;&#x7D20;&#x4E0D;&#x91CD;&#x590D;</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#5-concurrenthashmap"><span class="toc-nav-number">5.</span> <span class="toc-nav-text">5&#x3001;ConcurrentHashMap</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#jdk-17-concurrenthashmap"><span class="toc-nav-number">5.1.</span> <span class="toc-nav-text">JDK 1.7 ConcurrentHashMap</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#jdk-18-concurrenthashmap"><span class="toc-nav-number">5.2.</span> <span class="toc-nav-text">JDK 1.8 ConcurrentHashMap</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#casåŸç†-ä¹è§‚é”"><span class="toc-nav-number">5.2.1.</span> <span class="toc-nav-text">CAS&#x539F;&#x7406; &#xFF08;&#x4E50;&#x89C2;&#x9501;&#xFF09;</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#æ¨¡æ‹Ÿcasç®—æ³•"><span class="toc-nav-number">5.2.2.</span> <span class="toc-nav-text">&#x6A21;&#x62DF;CAS&#x7B97;&#x6CD5;</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#concurrenthashmap-çš„putæ–¹æ³•å®ç°"><span class="toc-nav-number">5.2.3.</span> <span class="toc-nav-text">ConcurrentHashMap &#x7684;put&#x65B9;&#x6CD5;&#x5B9E;&#x73B0;</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#concurrenthashmap-çš„getæ–¹æ³•å®ç°"><span class="toc-nav-number">5.2.4.</span> <span class="toc-nav-text">ConcurrentHashMap &#x7684;get&#x65B9;&#x6CD5;&#x5B9E;&#x73B0;</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#6-javaé›†åˆç±»æ¡†æ¶çš„åŸºæœ¬æ¥å£"><span class="toc-nav-number">6.</span> <span class="toc-nav-text">6&#x3001;Java&#x96C6;&#x5408;&#x7C7B;&#x6846;&#x67B6;&#x7684;&#x57FA;&#x672C;&#x63A5;&#x53E3;</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#7-å…³äºlistmapsetvectorhashtable"><span class="toc-nav-number">7.</span> <span class="toc-nav-text">7&#x3001;&#x5173;&#x4E8E;List,Map,Set,Vector,HashTable</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#list"><span class="toc-nav-number">7.1.</span> <span class="toc-nav-text">List &#x1F447;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#map"><span class="toc-nav-number">7.2.</span> <span class="toc-nav-text">Map &#x1F447;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#set"><span class="toc-nav-number">7.3.</span> <span class="toc-nav-text">Set&#x1F447;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#vector"><span class="toc-nav-number">7.4.</span> <span class="toc-nav-text">Vector &#x1F447;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#hashtable"><span class="toc-nav-number">7.5.</span> <span class="toc-nav-text">HashTable &#x1F447;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#æ€»ç»“"><span class="toc-nav-number">7.6.</span> <span class="toc-nav-text">&#x603B;&#x7ED3;</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#8-å¤šçº¿ç¨‹"><span class="toc-nav-number">8.</span> <span class="toc-nav-text">8&#x3001;&#x591A;&#x7EBF;&#x7A0B;</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#ä»€ä¹ˆæ˜¯çº¿ç¨‹"><span class="toc-nav-number">8.1.</span> <span class="toc-nav-text">&#x4EC0;&#x4E48;&#x662F;&#x7EBF;&#x7A0B;&#xFF1F;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#è¿›ç¨‹ä¸çº¿ç¨‹åŒºåˆ«"><span class="toc-nav-number">8.2.</span> <span class="toc-nav-text"><strong>&#x8FDB;&#x7A0B;&#x4E0E;&#x7EBF;&#x7A0B;&#x533A;&#x522B;</strong></span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#å®ˆæŠ¤çº¿ç¨‹ä¸éå®ˆæŠ¤çº¿ç¨‹"><span class="toc-nav-number">8.3.</span> <span class="toc-nav-text">&#x5B88;&#x62A4;&#x7EBF;&#x7A0B;&#x4E0E;&#x975E;&#x5B88;&#x62A4;&#x7EBF;&#x7A0B;</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#å®ˆæŠ¤çº¿ç¨‹"><span class="toc-nav-number">8.3.1.</span> <span class="toc-nav-text">&#x5B88;&#x62A4;&#x7EBF;&#x7A0B;</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#éå®ˆæŠ¤çº¿ç¨‹ç”¨æˆ·çº¿ç¨‹"><span class="toc-nav-number">8.3.2.</span> <span class="toc-nav-text">&#x975E;&#x5B88;&#x62A4;&#x7EBF;&#x7A0B;(&#x7528;&#x6237;&#x7EBF;&#x7A0B;)</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#9-synchronized-amp-lock-åŒºåˆ«"><span class="toc-nav-number">9.</span> <span class="toc-nav-text">9&#x3001;Synchronized &amp; lock &#x533A;&#x522B;</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#é”çš„åˆ†ç±»"><span class="toc-nav-number">9.1.</span> <span class="toc-nav-text">&#x9501;&#x7684;&#x5206;&#x7C7B;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#reentrantlock-å…¬å¹³é”å’Œéå…¬å¹³é”"><span class="toc-nav-number">9.2.</span> <span class="toc-nav-text">ReentrantLock &#x516C;&#x5E73;&#x9501;&#x548C;&#x975E;&#x516C;&#x5E73;&#x9501;</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#10-äº§ç”Ÿæ­»é”çš„æ¡ä»¶"><span class="toc-nav-number">10.</span> <span class="toc-nav-text">10&#x3001;&#x4EA7;&#x751F;&#x6B7B;&#x9501;&#x7684;&#x6761;&#x4EF6;</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#10-ä¸ºä»€ä¹ˆé€‰æ‹©mysqlæ•°æ®åº“"><span class="toc-nav-number">11.</span> <span class="toc-nav-text">10&#x3001;&#x4E3A;&#x4EC0;&#x4E48;&#x9009;&#x62E9;MySQL&#x6570;&#x636E;&#x5E93;</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#11-ç³»ç»Ÿè®¾ç½®çš„ä¸»é”®ä¸æˆ‘ä»¬å®šä¹‰çš„ä¸»é”®åŒºåˆ«"><span class="toc-nav-number">12.</span> <span class="toc-nav-text">11&#x3001;&#x7CFB;&#x7EDF;&#x8BBE;&#x7F6E;&#x7684;&#x4E3B;&#x952E;&#x4E0E;&#x6211;&#x4EEC;&#x5B9A;&#x4E49;&#x7684;&#x4E3B;&#x952E;&#x533A;&#x522B;</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#12-æœ‰æ— ä¸»é”®åŒºåˆ«"><span class="toc-nav-number">13.</span> <span class="toc-nav-text">12&#x3001;&#x6709;&#x65E0;&#x4E3B;&#x952E;&#x533A;&#x522B;</span></a></li></ol>
        
        </div>
      </aside>
    

                
            <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                
                <section>
                    <!-- no hr -->
                    <h5><a href="/tags/">FEATURED TAGS</a></h5>
                    <div class="tags">
                       
                          <a class="tag" href="/tags/#é¢è¯•" title="é¢è¯•">é¢è¯•</a>
                        
                    </div>
                </section>
                

                <!-- Friends Blog -->
                
                <hr>
                <h5>FRIENDS</h5>
                <ul class="list-inline">

                    
                        <li><a href="https://yexua.github.io/" target="_blank">å¤§ä½¬</a></li>
                    
                        <li><a href="https://snailclimb.gitee.io/javaguide/#/" target="_blank">JavaGuide</a></li>
                    
                        <li><a href="http://cyc2018.gitee.io/cs-notes/#/notes/%E5%89%91%E6%8C%87%20Offer%20%E9%A2%98%E8%A7%A3%20-%20%E7%9B%AE%E5%BD%951" target="_blank">å‰‘æŒ‡Offer</a></li>
                    
                        <li><a href="http://cyc2018.gitee.io/cs-notes/#/" target="_blank">æŠ€æœ¯é¢è¯•å¿…å¤‡åŸºç¡€çŸ¥è¯†</a></li>
                    
                </ul>
                
            </div>
        </div>
    </div>
</article>








<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("https://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'hover',
          placement: 'left',
          icon: 'â„¬'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>



    <!-- Footer -->
    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                
                
                

                

                

                
                    <li>
                        <a target="_blank"  href="https://github.com/GitHub-yuteng">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                

                </ul>
                <p class="copyright text-muted">
                    Copyright &copy; äºè…¾ 2019 
                    <br>
                    Theme by <a href="http://beantech.org">BeanTech</a> 
                    <span style="display: inline-block; margin: 0 5px;">
                        <i class="fa fa-heart"></i>
                    </span> 
                    re-Ported by <a href="http://www.huweihuang.com">èƒ¡ä¼Ÿç…Œ</a> | 
                    <iframe
                        style="margin-left: 2px; margin-bottom:-5px;"
                        frameborder="0" scrolling="0" width="91px" height="20px"
                        src="https://ghbtns.com/github-btn.html?user=huweihuang&repo=hexo-theme-huweihuang&type=star&count=true" >
                    </iframe>
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js"></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js"></script>

<!-- Custom Theme JavaScript -->
<script src="/js/hux-blog.min.js"></script>


<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!-- 
     Because of the native support for backtick-style fenced code blocks 
     right within the Markdown is landed in Github Pages, 
     From V1.6, There is no need for Highlight.js, 
     so Huxblog drops it officially.

     - https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0  
     - https://help.github.com/articles/creating-and-highlighting-code-blocks/    
-->
<!--
    <script>
        async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
            hljs.initHighlightingOnLoad();
        })
    </script>
    <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">
-->


<!-- jquery.tagcloud.js -->
<script>
    // only load tagcloud.js in tag.html
    if($('#tag_cloud').length !== 0){
        async("https://github-yuteng.github.io/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                //size: {start: 1, end: 1, unit: 'em'},
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>

<!--fastClick.js -->
<script>
    async("https://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->


<script>
    // dynamic User by Hux
    var _gaId = 'UA-XXXXXXXX-X';
    var _gaDomain = 'yoursite';

    // Originial
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', _gaId, _gaDomain);
    ga('send', 'pageview');
</script>




<!-- Baidu Tongji -->

<script>
    // dynamic User by Hux
    var _baId = 'xxx';

    // Originial
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?" + _baId;
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
</script>






	<a id="rocket" href="#top" class=""></a>
	<script type="text/javascript" src="/js/totop.js?v=1.0.0" async=""></script>
    <script type="text/javascript" src="/js/toc.js?v=1.0.0" async=""></script>
<!-- Image to hack wechat -->
<img src="https://github-yuteng.github.io/img/icon_wechat.png" width="0" height="0" />
<!-- Migrate from head to bottom, no longer block render and still work -->

</body>

</html>
