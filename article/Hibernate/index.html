<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="keyword"  content="">
    <link rel="shortcut icon" href="/img/ironman-draw.png">
    <!-- Place this tag in your head or just before your close body tag. -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <title>
        
          Hibernate - äºè…¾ | Blog
        
    </title>

    <link rel="canonical" href="https://github-yuteng.github.io/article/Hibernate/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS --> 
    <link rel="stylesheet" href="/css/beantech.min.css">

    <link rel="stylesheet" href="/css/donate.css">
    
    <!-- Pygments Highlight CSS -->
    <link rel="stylesheet" href="/css/highlight.css">

    <link rel="stylesheet" href="/css/widget.css">

    <link rel="stylesheet" href="/css/rocket.css">

    <link rel="stylesheet" href="/css/signature.css">

    <link rel="stylesheet" href="/css/toc.css">

    <!-- Custom Fonts -->
    <!-- <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <!-- Hux change font-awesome CDN to qiniu -->
    <link href="https://cdn.staticfile.org/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">


    <!-- Hux Delete, sad but pending in China
    <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/
    css'>
    -->


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- ga & ba script hoook -->
    <script></script>
</head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">
	<!-- Modified by Yu-Hsuan Yen -->
<!-- Post Header -->
<style type="text/css">
    header.intro-header{
        
            background-image: url('/img/article_header/article_bg.jpg')
            /*post*/
        
    }
    
</style>

<header class="intro-header" >
    <!-- Signature -->
    <div id="signature">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                
                    <div class="post-heading">
                        <div class="tags">
                            
                              <a class="tag" href="/tags/#ORM æ¡†æ¶" title="ORM æ¡†æ¶">ORM æ¡†æ¶</a>
                            
                        </div>
                        <h1>Hibernate</h1>
                        <h2 class="subheading"></h2>
                        <span class="meta">
                            Posted by äºè…¾ on
                            2019-03-26
                        </span>
                    </div>
                


                </div>
            </div>
        </div>
    </div>
</header>

	
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">æ‰€çˆ±éš”å±±æµ·</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <!-- Known Issue, found by Hux:
            <nav>'s height woule be hold on by its content.
            so, when navbar scale out, the <nav> will cover tags.
            also mask any touch event of tags, unfortunately.
        -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>

                    

                        
                    

                        
                        <li>
                            <a href="/archive/">Archives</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/about/">è‡³æ­¤è‡³ç»ˆ</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/tags/">Tags</a>
                        </li>
                        
                    
                    
                </ul>
            </div>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        // CLOSE
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        // OPEN
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>


    <!-- Main Content -->
    <!-- Modify by Yu-Hsuan Yen -->

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                <h2 id="ä¸€-æŒä¹…åŒ–æ¡†æ¶">ä¸€ã€æŒä¹…åŒ–æ¡†æ¶</h2>
<p><strong>ORM(Object/Relation Mapping)ï¼šå¯¹è±¡/å…³ç³»æ˜ å°„</strong></p>
<table>
<thead>
<tr>
<th>é¢å‘å¯¹è±¡æ¦‚å¿µ</th>
<th>é¢å‘å…³ç³»æ¦‚å¿µ</th>
</tr>
</thead>
<tbody>
<tr>
<td>ç±»</td>
<td>è¡¨</td>
</tr>
<tr>
<td>å¯¹è±¡</td>
<td>è¡¨çš„è¡Œ(è®°å½•)</td>
</tr>
<tr>
<td>å±æ€§</td>
<td>è¡¨çš„åˆ—(å­—æ®µ)</td>
</tr>
</tbody>
</table>
<hr>
<h3 id="ormçš„æ€æƒ³">ORMçš„æ€æƒ³</h3>
<p>å°†å…³ç³»æ•°æ®åº“ä¸­è¡¨ä¸­çš„è®°å½•æ˜ å°„æˆä¸ºå¯¹è±¡ï¼Œä»¥å¯¹è±¡çš„å½¢å¼å±•ç°ï¼Œç¨‹åºå‘˜å¯ä»¥æŠŠå¯¹æ•°æ®åº“çš„æ“ä½œè½¬åŒ–ä¸ºå¯¹å¯¹è±¡çš„æ“ä½œã€‚ORM é‡‡ç”¨å…ƒæ•°æ®æ¥æè¿° å¯¹è±¡-å…³ç³» æ˜ å°„ç»†èŠ‚ï¼Œå…ƒæ•°æ®é€šå¸¸é‡‡ç”¨ XML æ ¼å¼ï¼Œå¹¶ä¸”å­˜æ”¾åœ¨ä¸“é—¨çš„ å¯¹è±¡-å…³ç³» æ˜ å°„æ–‡ä»¶ä¸­ã€‚</p>
<img src="https://i.loli.net/2019/07/09/5d23f97bed4cb87111.png" alt="hb.png" title="hb.png">
<hr>
<p><strong>æ·»åŠ  jar åŒ…</strong><br>
<img src="http://ww1.sinaimg.cn/large/006vWPzFly1g1hary8cirj309m0790st.jpg" width="400"></p>
<hr>
<hr>
<h2 id="äºŒ-hibernate-é…ç½®æ–‡ä»¶">äºŒã€Hibernate é…ç½®æ–‡ä»¶</h2>
<p><strong>Hibernate é…ç½®æ–‡ä»¶ä¸»è¦ç”¨äºé…ç½®æ•°æ®åº“è¿æ¥å’Œ Hibernate è¿è¡Œæ—¶æ‰€éœ€çš„å„ç§å±æ€§ã€‚</strong></p>
<p>æ¯ä¸ª Hibernate é…ç½®æ–‡ä»¶å¯¹åº”ä¸€ä¸ª Configuration å¯¹è±¡ã€‚</p>
<ul>
<li>Hibernateé…ç½®æ–‡ä»¶å¯ä»¥æœ‰ä¸¤ç§æ ¼å¼ï¼š
<ul>
<li><s>hibernate.properties</s></li>
<li><strong>hibernate.cfg.xml (æ¨è)</strong></li>
</ul>
</li>
</ul>
<h3 id="1-åˆ›å»º-hibernatecfgxml">1ã€åˆ›å»º hibernate.cfg.xml</h3>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">hibernate-configuration</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">session-factory</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- é…ç½®è¿æ¥æ•°æ®åº“çš„åŸºæœ¬ä¿¡æ¯ --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.username"</span>&gt;</span>root<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.password"</span>&gt;</span>root<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.driver_class"</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.url"</span>&gt;</span>jdbc:mysql://localhost:3306/hibernate5<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">&lt;!-- é…ç½® hibernate çš„åŸºæœ¬ä¿¡æ¯ --&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- hibernate æ‰€ä½¿ç”¨çš„æ•°æ®åº“æ–¹è¨€ MySQL5InnoDBDialect æ³¨æ„æ˜¯MySQL5 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dialect"</span>&gt;</span>org.hibernate.dialect.MySQL5InnoDBDialect<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">&lt;!-- æ‰§è¡Œæ“ä½œæ—¶æ˜¯å¦åœ¨æ§åˆ¶å°æ‰“å° SQL --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"show_sql"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">&lt;!-- æ˜¯å¦å¯¹ SQL è¿›è¡Œæ ¼å¼åŒ– --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"format_sql"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">&lt;!-- æŒ‡å®šè‡ªåŠ¨ç”Ÿæˆæ•°æ®è¡¨çš„ç­–ç•¥ --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hbm2ddl.auto"</span>&gt;</span>update<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">&lt;!-- æŒ‡å®šå…³è”çš„ .hbm.xml æ–‡ä»¶ --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">mapping</span> <span class="attr">resource</span>=<span class="string">"com/hibernate/News.hbm.xml"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;/<span class="name">session-factory</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">å¯¹äºOracleæœ‰æ•ˆ å¯¹äº MySQLæ— æ•ˆ</span><br><span class="line"><span class="comment">&lt;!-- è®¾å®š JDBC çš„ Statement è¯»å–æ•°æ®çš„æ—¶å€™æ¯æ¬¡ä»æ•°æ®åº“ä¸­å–å‡ºçš„è®°å½•æ¡æ•° --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.jdbc.fetch_size"</span>&gt;</span>100<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- è®¾å®šå¯¹æ•°æ®åº“è¿›è¡Œæ‰¹é‡åˆ é™¤ï¼Œæ‰¹é‡æ›´æ–°å’Œæ‰¹é‡æ’å…¥çš„æ—¶å€™çš„æ‰¹æ¬¡å¤§å° --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"jdbc.batch_size"</span>&gt;</span>30<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
<hr>
<h3 id="2-åˆ›å»ºæŒä¹…åŒ–-java-ç±»">2ã€åˆ›å»ºæŒä¹…åŒ– Java ç±»</h3>
<ul>
<li>Hibernate ä¸è¦æ±‚æŒä¹…åŒ–ç±»ç»§æ‰¿ä»»ä½•çˆ¶ç±»æˆ–å®ç°æ¥å£ï¼Œè¿™å¯ä»¥ä¿è¯ä»£ç ä¸è¢«æ±¡æŸ“ã€‚è¿™å°±æ˜¯Hibernateè¢«ç§°ä¸ºä½ä¾µå…¥å¼è®¾è®¡çš„åŸå› </li>
</ul>
<p><strong>1ã€æä¾›ä¸€ä¸ªæ— å‚çš„æ„é€ å™¨ï¼š</strong> ä½¿Hibernateå¯ä»¥ä½¿ç”¨Constructor.newInstance() æ¥å®ä¾‹åŒ–æŒä¹…åŒ–ç±»ã€‚<br>
<strong>2ã€æä¾›ä¸€ä¸ªæ ‡è¯†å±æ€§(identifier property)ï¼š</strong> é€šå¸¸æ˜ å°„ä¸ºæ•°æ®åº“è¡¨çš„ä¸»é”®å­—æ®µã€‚å¦‚æœæ²¡æœ‰è¯¥å±æ€§ï¼Œä¸€äº›åŠŸèƒ½å°†ä¸èµ·ä½œç”¨ï¼Œå¦‚ï¼šSession.saveOrUpdate()ã€‚<br>
<strong>3ã€ä¸ºç±»çš„æŒä¹…åŒ–ç±»å­—æ®µå£°æ˜è®¿é—®æ–¹æ³•(get/set)ï¼š</strong> Hibernateå¯¹JavaBeans é£æ ¼çš„å±æ€§å®è¡ŒæŒä¹…åŒ–ã€‚<br>
<strong>4ã€ä½¿ç”¨é final ç±»ï¼š</strong> åœ¨è¿è¡Œæ—¶ç”Ÿæˆä»£ç†æ˜¯ Hibernate çš„ä¸€ä¸ªé‡è¦çš„åŠŸèƒ½ã€‚å¦‚æœæŒä¹…åŒ–ç±»æ²¡æœ‰å®ç°ä»»ä½•æ¥å£, Hibnernate ä½¿ç”¨ CGLIB ç”Ÿæˆä»£ç†ã€‚å¦‚æœä½¿ç”¨çš„æ˜¯ final ç±», åˆ™æ— æ³•ç”Ÿæˆ CGLIB ä»£ç†ã€‚<br>
<strong>5ã€é‡å†™ eqauls å’Œ hashCode æ–¹æ³•ï¼š</strong> å¦‚æœéœ€è¦æŠŠæŒä¹…åŒ–ç±»çš„å®ä¾‹æ”¾åˆ° Set ä¸­(å½“éœ€è¦è¿›è¡Œå…³è”æ˜ å°„æ—¶), åˆ™åº”è¯¥é‡å†™è¿™ä¸¤ä¸ªæ–¹æ³•ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">News</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> Integer id; <span class="comment">// field</span></span><br><span class="line">	<span class="keyword">private</span> String title;</span><br><span class="line">	<span class="keyword">private</span> String author;</span><br><span class="line">	<span class="keyword">private</span> Date date;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">News</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">News</span><span class="params">(String title, String author, Date date)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>();</span><br><span class="line">		<span class="keyword">this</span>.title = title;</span><br><span class="line">		<span class="keyword">this</span>.author = author;</span><br><span class="line">		<span class="keyword">this</span>.date = date;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Integer <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> id;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.id = id;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getTitle</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> title;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTitle</span><span class="params">(String title)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.title = title;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getAuthor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> author;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAuthor</span><span class="params">(String author)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.author = author;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Date <span class="title">getDate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> date;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDate</span><span class="params">(Date date)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.date = date;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"News [id="</span> + id + <span class="string">", title="</span> + title + <span class="string">", author="</span> + author + <span class="string">", date="</span> + date + <span class="string">"]"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="3-åˆ›å»ºå¯¹è±¡-å…³ç³»æ˜ å°„æ–‡ä»¶">3ã€åˆ›å»ºå¯¹è±¡-å…³ç³»æ˜ å°„æ–‡ä»¶</h3>
<ul>
<li>Hibernate é‡‡ç”¨ XML æ ¼å¼çš„æ–‡ä»¶æ¥æŒ‡å®šå¯¹è±¡å’Œå…³ç³»æ•°æ®ä¹‹é—´çš„æ˜ å°„ã€‚</li>
<li>åœ¨è¿è¡Œæ—¶ Hibernate å°†æ ¹æ®è¿™ä¸ªæ˜ å°„æ–‡ä»¶æ¥ç”Ÿæˆå„ç§ SQL è¯­å¥ã€‚</li>
<li><strong>æ˜ å°„æ–‡ä»¶çš„æ‰©å±•åä¸º .hbm.xml</strong></li>
</ul>
<hr>
<h3 id="4-æµ‹è¯•">4ã€æµ‹è¯•</h3>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.Transaction;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.service.ServiceRegistry;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.service.ServiceRegistryBuilder;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HibernateTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 1. åˆ›å»ºä¸€ä¸ª SessionFactory å¯¹è±¡</span></span><br><span class="line">		SessionFactory sessionFactory = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 1). åˆ›å»º Configuration å¯¹è±¡: å¯¹åº” hibernate çš„åŸºæœ¬é…ç½®ä¿¡æ¯å’Œ å¯¹è±¡å…³ç³»æ˜ å°„ä¿¡æ¯</span></span><br><span class="line">		Configuration configuration = <span class="keyword">new</span> Configuration().configure();</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 4.0 ä¹‹å‰è¿™æ ·åˆ›å»º</span></span><br><span class="line">		<span class="comment">// sessionFactory = configuration.buildSessionFactory();</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">// 2). åˆ›å»ºä¸€ä¸ª ServiceRegistry å¯¹è±¡: hibernate 4.x æ–°æ·»åŠ çš„å¯¹è±¡</span></span><br><span class="line">		<span class="comment">// hibernate çš„ä»»ä½•é…ç½®å’ŒæœåŠ¡éƒ½éœ€è¦åœ¨è¯¥å¯¹è±¡ä¸­æ³¨å†Œåæ‰èƒ½æœ‰æ•ˆ.</span></span><br><span class="line">		ServiceRegistry serviceRegistry = <span class="keyword">new</span> ServiceRegistryBuilder()</span><br><span class="line">				.applySettings(configuration.getProperties())</span><br><span class="line">				.buildServiceRegistry();</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 3).</span></span><br><span class="line">		sessionFactory = configuration.buildSessionFactory(serviceRegistry);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 2. åˆ›å»ºä¸€ä¸ª Session å¯¹è±¡</span></span><br><span class="line">		Session session = sessionFactory.openSession();</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 3. å¼€å¯äº‹åŠ¡</span></span><br><span class="line">		Transaction transaction = session.beginTransaction();</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 4. æ‰§è¡Œä¿å­˜æ“ä½œ</span></span><br><span class="line">		News news = <span class="keyword">new</span> News(<span class="string">"Java"</span>, <span class="string">"Hibernate"</span>, <span class="keyword">new</span> Date(<span class="keyword">new</span> java.util.Date().getTime()));</span><br><span class="line">		session.save(news);<span class="comment">//saveåï¼Œnewså˜æˆæŒä¹…æ€</span></span><br><span class="line">					<span class="comment">//news.setTitle("HB"); ``å¯¹æŒä¹…æ€çš„æ”¹å˜ï¼Œä¼šåœ¨sessionæäº¤æ—¶è‡ªåŠ¨æ›´æ–°æ•°æ®åº“``</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">// 5. æäº¤äº‹åŠ¡</span></span><br><span class="line">		transaction.commit();</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 6. å…³é—­ Session</span></span><br><span class="line">		session.close();</span><br><span class="line">					<span class="comment">//sessionå…³é—­å news.setTitle("HB"); //è¿™æ—¶æ”¹å˜å…¶å±æ€§ï¼Œå°†ä¸ä¼šè‡ªåŠ¨æ›´æ–°æ•°æ®åº“</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">// 7. å…³é—­ SessionFactory å¯¹è±¡</span></span><br><span class="line">		sessionFactory.close();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<hr>
<h2 id="ä¸‰-hibernate-å±æ€§">ä¸‰ã€Hibernate å±æ€§</h2>
<h3 id="1-configuration-ç±»">1ã€Configuration ç±»</h3>
<p><strong>Configuration ç±»è´Ÿè´£ç®¡ç† Hibernate çš„é…ç½®ä¿¡æ¯ã€‚</strong></p>
<p><strong>åŒ…æ‹¬å¦‚ä¸‹å†…å®¹ï¼š</strong></p>
<ul>
<li>Hibernate è¿è¡Œçš„åº•å±‚ä¿¡æ¯ï¼šæ•°æ®åº“çš„URLã€ç”¨æˆ·åã€å¯†ç ã€JDBCé©±åŠ¨ç±»ï¼Œæ•°æ®åº“æ–¹è¨€Dialect,æ•°æ®åº“è¿æ¥æ± ç­‰ï¼ˆå¯¹åº” hibernate.cfg.xml æ–‡ä»¶ï¼‰ã€‚æŒä¹…åŒ–ç±»ä¸æ•°æ®è¡¨çš„æ˜ å°„å…³ç³»ï¼ˆ*.hbm.xmlï¼‰</li>
</ul>
<hr>
<p><strong>åˆ›å»º Configuration çš„æ–¹å¼</strong></p>
<ul>
<li>æ¨èä½¿ç”¨XMLæ–¹å¼ Xmlæ–‡ä»¶ï¼ˆhibernate.cfg.xmlï¼‰</li>
</ul>
<p><strong>Configuration cfg = new Configuration().configure();</strong></p>
<hr>
<h3 id="2-sessionfactory-æ¥å£">2ã€SessionFactory æ¥å£</h3>
<p><strong>é’ˆå¯¹å•ä¸ªæ•°æ®åº“æ˜ å°„å…³ç³»ç»è¿‡ç¼–è¯‘åçš„å†…å­˜é•œåƒï¼Œæ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</strong></p>
<ul>
<li>SessionFactory å¯¹è±¡ä¸€æ—¦æ„é€ å®Œæ¯•ï¼Œå³è¢«èµ‹äºˆç‰¹å®šçš„é…ç½®ä¿¡æ¯</li>
</ul>
<p><strong>SessionFactoryæ˜¯ç”ŸæˆSessionçš„å·¥å‚</strong></p>
<ul>
<li>æ„é€  SessionFactory å¾ˆæ¶ˆè€—èµ„æºï¼Œä¸€èˆ¬æƒ…å†µä¸€ä¸ªåº”ç”¨ä¸­åªåˆå§‹åŒ–ä¸€ä¸ª SessionFactory å¯¹è±¡ã€‚<br>
Hibernate4 æ–°å¢äº†ä¸€ä¸ª ServiceRegistry æ¥å£ï¼Œæ‰€æœ‰åŸºäº Hibernate çš„é…ç½®æˆ–è€…æœåŠ¡éƒ½å¿…é¡»ç»Ÿä¸€å‘è¿™ä¸ª ServiceRegistry  æ³¨å†Œåæ‰èƒ½ç”Ÿæ•ˆã€‚</li>
</ul>
<p><strong>Hibernate4 ä¸­åˆ›å»º SessionFactory çš„æ­¥éª¤</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. åˆ›å»º Configuration å¯¹è±¡: å¯¹åº” hibernate çš„åŸºæœ¬é…ç½®ä¿¡æ¯å’Œ å¯¹è±¡å…³ç³»æ˜ å°„ä¿¡æ¯</span></span><br><span class="line">Configuration configuration = <span class="keyword">new</span> Configuration().configure();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.åˆ›å»ºä¸€ä¸ª ServiceRegistry å¯¹è±¡: hibernate 4.x æ–°æ·»åŠ çš„å¯¹è±¡</span></span><br><span class="line"><span class="comment">// hibernate çš„ä»»ä½•é…ç½®å’ŒæœåŠ¡éƒ½éœ€è¦åœ¨è¯¥å¯¹è±¡ä¸­æ³¨å†Œåæ‰èƒ½æœ‰æ•ˆã€‚</span></span><br><span class="line">ServiceRegistry serviceRegistry = <span class="keyword">new</span> ServiceRegistryBuilder()</span><br><span class="line">				.applySettings(configuration.getProperties())</span><br><span class="line">				.buildServiceRegistry();</span><br><span class="line"><span class="comment">// 3. å¾—åˆ°ä¸€ä¸ª SessionFactory å¯¹è±¡</span></span><br><span class="line"> SessionFactory sessionFactory = configuration.buildSessionFactory(serviceRegistry);</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="3-session-æ¥å£">3ã€Session (æ¥å£)</h3>
<p><strong>Session æ˜¯åº”ç”¨ç¨‹åºä¸æ•°æ®åº“ä¹‹é—´äº¤äº’æ“ä½œçš„ä¸€ä¸ªå•çº¿ç¨‹å¯¹è±¡ï¼Œæ˜¯ Hibernate è¿ä½œçš„ä¸­å¿ƒ</strong>ã€‚</p>
<ul>
<li>æ‰€æœ‰æŒä¹…åŒ–å¯¹è±¡å¿…é¡»åœ¨ session çš„ç®¡ç†ä¸‹æ‰å¯ä»¥è¿›è¡ŒæŒä¹…åŒ–æ“ä½œï¼Œç›¸å½“äº JDBC ä¸­çš„ Connectionã€‚</li>
</ul>
<hr>
<p><strong>æ­¤å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸå¾ˆçŸ­</strong></p>
<ul>
<li>Session å¯¹è±¡æœ‰ä¸€ä¸ªä¸€çº§ç¼“å­˜ï¼Œæ˜¾å¼æ‰§è¡Œ flush ä¹‹å‰ï¼Œæ‰€æœ‰çš„æŒä¹…å±‚æ“ä½œçš„æ•°æ®éƒ½ç¼“å­˜åœ¨ session å¯¹è±¡å¤„ã€‚</li>
</ul>
<p><strong>æŒä¹…åŒ–ç±»ä¸ Session å…³è”èµ·æ¥åå°±å…·æœ‰äº†æŒä¹…åŒ–çš„èƒ½åŠ›</strong><br>
<strong>Session ç±»çš„æ–¹æ³•ï¼š</strong></p>
<ul>
<li>å–å¾—æŒä¹…åŒ–å¯¹è±¡çš„æ–¹æ³•ï¼š get() load()</li>
<li>æŒä¹…åŒ–å¯¹è±¡ä¿å­˜ï¼Œæ›´æ–°å’Œåˆ é™¤ï¼šsave(),update(),saveOrUpdate(),delete()</li>
<li>å¼€å¯äº‹åŠ¡: beginTransaction()</li>
<li>ç®¡ç† Session çš„æ–¹æ³•ï¼šisOpen(),flush(), clear(), evict(), close()ç­‰</li>
</ul>
<hr>
<h3 id="4-transactionäº‹åŠ¡">4ã€Transaction(äº‹åŠ¡)</h3>
<p><strong>ä»£è¡¨ä¸€æ¬¡åŸå­æ“ä½œï¼Œå®ƒå…·æœ‰æ•°æ®åº“äº‹åŠ¡æ¦‚å¿µã€‚æ‰€æœ‰æŒä¹…å±‚éƒ½åº”åœ¨äº‹åŠ¡ç®¡ç†ä¸‹è¿›è¡Œï¼Œå³ä½¿æ˜¯åªè¯»æ“ä½œã€‚</strong></p>
<ul>
<li><strong>Transaction tx = session.beginTransaction();</strong></li>
</ul>
<p><strong>å¸¸ç”¨æ–¹æ³•ï¼š</strong></p>
<ul>
<li>commit()ï¼š æäº¤ç›¸å…³è”çš„sessionå®ä¾‹</li>
<li>rollback()ï¼š æ’¤é”€äº‹åŠ¡æ“ä½œ</li>
<li>wasCommitted()ï¼š æ£€æŸ¥äº‹åŠ¡æ˜¯å¦æäº¤</li>
</ul>
<hr>
<h2 id="å››-hibernate-é…ç½®æ–‡ä»¶çš„é…ç½®é¡¹">å››ã€Hibernate é…ç½®æ–‡ä»¶çš„é…ç½®é¡¹</h2>
<h3 id="1-hbm2ddlauto">1ã€hbm2ddl.auto</h3>
<ul>
<li>è¯¥å±æ€§å¯å®ç°æ­£å‘å·¥ç¨‹, å³ç”± java ä»£ç ç”Ÿæˆæ•°æ®åº“è„šæœ¬, è¿›è€Œç”Ÿæˆå…·ä½“çš„è¡¨ç»“æ„ã€‚</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- æŒ‡å®šè‡ªåŠ¨ç”Ÿæˆæ•°æ®è¡¨çš„ç­–ç•¥ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hbm2ddl.auto"</span>&gt;</span>update<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>å–å€¼ create | update | create-drop | validate</strong></p>
<ul>
<li><strong>createï¼š</strong> ä¼šæ ¹æ® .hbm.xml  æ–‡ä»¶æ¥ç”Ÿæˆæ•°æ®è¡¨ï¼Œ ä½†æ˜¯æ¯æ¬¡è¿è¡Œéƒ½ä¼šåˆ é™¤ä¸Šä¸€æ¬¡çš„è¡¨ ï¼Œé‡æ–°ç”Ÿæˆè¡¨ï¼Œå“ªæ€•äºŒæ¬¡æ²¡æœ‰ä»»ä½•æ”¹å˜ã€‚</li>
<li><strong>create-dropï¼š</strong> ä¼šæ ¹æ® .hbm.xml æ–‡ä»¶ç”Ÿæˆè¡¨ï¼Œä½†æ˜¯SessionFactoryä¸€å…³é—­ï¼Œè¡¨å°±è‡ªåŠ¨åˆ é™¤ã€‚</li>
<li><strong>updateï¼š</strong> æœ€å¸¸ç”¨çš„å±æ€§å€¼ï¼Œä¹Ÿä¼šæ ¹æ® .hbm.xml æ–‡ä»¶ç”Ÿæˆè¡¨ï¼Œä½†è‹¥ .hbm.xml æ–‡ä»¶å’Œæ•°æ®åº“ä¸­å¯¹åº”çš„æ•°æ®è¡¨çš„è¡¨ç»“æ„ä¸åŒï¼ŒHiberante å°†æ›´æ–°æ•°æ®è¡¨ç»“æ„ï¼Œä½†ä¸ä¼šåˆ é™¤å·²æœ‰çš„è¡Œå’Œåˆ—ã€‚<br>
<strong>validateï¼š</strong> ä¼šå’Œæ•°æ®åº“ä¸­çš„è¡¨è¿›è¡Œæ¯”è¾ƒï¼Œè‹¥ .hbm.xml æ–‡ä»¶ä¸­çš„åˆ—åœ¨æ•°æ®è¡¨ä¸­ä¸å­˜åœ¨ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ã€‚</li>
</ul>
<hr>
<h3 id="2-format_sql">2ã€format_sql</h3>
<ul>
<li>æ˜¯å¦å°† SQL è½¬åŒ–ä¸ºæ ¼å¼è‰¯å¥½çš„ SQLã€‚ å–å€¼ true | false</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- æ˜¯å¦å¯¹ SQL è¿›è¡Œæ ¼å¼åŒ– --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"format_sql"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
<hr>
<h3 id="3-åœ¨-hibernate-ä¸­è®¾ç½®éš”ç¦»çº§åˆ«">3ã€åœ¨ Hibernate ä¸­è®¾ç½®éš”ç¦»çº§åˆ«</h3>
<ul>
<li>JDBC æ•°æ®åº“è¿æ¥ä½¿ç”¨æ•°æ®åº“ç³»ç»Ÿé»˜è®¤çš„éš”ç¦»çº§åˆ«ã€‚</li>
</ul>
<p><strong>åœ¨ Hibernate çš„é…ç½®æ–‡ä»¶ä¸­å¯ä»¥æ˜¾å¼çš„è®¾ç½®éš”ç¦»çº§åˆ«ã€‚ æ¯ä¸€ä¸ªéš”ç¦»çº§åˆ«éƒ½å¯¹åº”ä¸€ä¸ªæ•´æ•°ï¼š</strong></p>
<ul>
<li>READ UNCOMMITED ----&gt; 1</li>
<li><strong>READ COMMITED</strong> ----&gt; 2</li>
<li>REPEATABLE READ ----&gt; 4</li>
<li>SERIALIZEABLE ----&gt; 8</li>
</ul>
<p><strong>Hibernate é€šè¿‡ æ˜ å°„æ–‡ä»¶æŒ‡å®š <code>hibernate.connection.isolation</code> å±æ€§æ¥è®¾ç½®äº‹åŠ¡çš„éš”ç¦»çº§åˆ«ã€‚</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- è®¾ç½® Hibernate çš„äº‹åŠ¡éš”ç¦»çº§åˆ« --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.isolation"</span>&gt;</span>2<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
<hr>
<h3 id="4-åœ¨-hibernate-ä¸­ä½¿ç”¨-c3p0-æ•°æ®æº">4ã€åœ¨ hibernate ä¸­ä½¿ç”¨ C3P0 æ•°æ®æº</h3>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- é…ç½® C3P0 æ•°æ®æº --&gt;</span></span><br><span class="line">//å¯é…å¯ä¸é… </span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.connection.provider_class"</span>&gt;</span>org.hibernate.connection.C3P0ConnectionProvider<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">//æ•°æ®åº“è¿æ¥æ± çš„æœ€å¤§è¿æ¥æ•°</span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.c3p0.max_size"</span>&gt;</span>10<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">//æ•°æ®åº“è¿æ¥æ± çš„æœ€å°è¿æ¥æ•°</span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.c3p0.min_size"</span>&gt;</span>5<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">//å½“æ•°æ®åº“è¿æ¥æ± ä¸­çš„è¿æ¥è€—å°½æ—¶, åŒä¸€æ—¶åˆ»è·å–å¤šå°‘ä¸ªæ•°æ®åº“è¿æ¥</span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"c3p0.acquire_increment"</span>&gt;</span>2<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">//è¡¨ç¤ºè¿æ¥æ± æ£€æµ‹çº¿ç¨‹å¤šé•¿æ—¶é—´æ£€æµ‹ä¸€æ¬¡æ± å†…çš„æ‰€æœ‰é“¾æ¥å¯¹è±¡æ˜¯å¦è¶…æ—¶</span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"c3p0.idle_test_period"</span>&gt;</span>2000<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">//æ•°æ®åº“è¿æ¥æ± ä¸­è¿æ¥å¯¹è±¡åœ¨å¤šé•¿æ—¶é—´æ²¡æœ‰ä½¿ç”¨è¿‡åï¼Œå°±åº”è¯¥è¢«é”€æ¯</span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"c3p0.timeout"</span>&gt;</span>2000<span class="tag">&lt;/<span class="name">property</span>&gt;</span>		</span><br><span class="line">//ç¼“å­˜ Statement å¯¹è±¡çš„æ•°é‡</span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"c3p0.max_statements"</span>&gt;</span>10<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="äº”-é€šè¿‡-session-æ“çºµå¯¹è±¡">äº”ã€é€šè¿‡ Session æ“çºµå¯¹è±¡</h2>
<hr>
<ul>
<li>Session æ¥å£æ˜¯ Hibernate å‘åº”ç”¨ç¨‹åºæä¾›çš„æ“çºµæ•°æ®åº“çš„æœ€ä¸»è¦çš„æ¥å£, å®ƒæä¾›äº†åŸºæœ¬çš„ä¿å­˜, æ›´æ–°, åˆ é™¤å’ŒåŠ è½½ Java å¯¹è±¡çš„æ–¹æ³•ã€‚</li>
<li><strong>Session å…·æœ‰ä¸€ä¸ªç¼“å­˜, ä½äºç¼“å­˜ä¸­çš„å¯¹è±¡ç§°ä¸ºæŒä¹…åŒ–å¯¹è±¡, å®ƒå’Œæ•°æ®åº“ä¸­çš„ç›¸å…³è®°å½•å¯¹åº”ã€‚</strong></li>
<li>Session èƒ½å¤Ÿåœ¨æŸäº›æ—¶é—´ç‚¹, æŒ‰ç…§ç¼“å­˜ä¸­å¯¹è±¡çš„å˜åŒ–æ¥æ‰§è¡Œç›¸å…³çš„ SQL è¯­å¥, æ¥åŒæ­¥æ›´æ–°æ•°æ®åº“, è¿™ä¸€è¿‡ç¨‹è¢«ç§°ä¸ºåˆ·æ–°ç¼“å­˜(flush)ã€‚</li>
</ul>
<p><strong>ç«™åœ¨æŒä¹…åŒ–çš„è§’åº¦, Hibernate æŠŠå¯¹è±¡åˆ†ä¸º 4 ç§çŠ¶æ€ï¼š</strong><br>
<strong>Session çš„ç‰¹å®šæ–¹æ³•èƒ½ä½¿å¯¹è±¡ä»ä¸€ä¸ªçŠ¶æ€è½¬æ¢åˆ°å¦ä¸€ä¸ªçŠ¶æ€ã€‚</strong></p>
<ul>
<li>æŒä¹…åŒ–çŠ¶æ€</li>
<li>ä¸´æ—¶çŠ¶æ€</li>
<li>æ¸¸ç¦»çŠ¶æ€</li>
<li>åˆ é™¤çŠ¶æ€</li>
</ul>
<hr>
<h3 id="1-æŒä¹…åŒ–å¯¹è±¡-æ‰˜ç®¡-persist">1ã€æŒä¹…åŒ–å¯¹è±¡ ( æ‰˜ç®¡ ) ï¼ˆPersistï¼‰</h3>
<ul>
<li>åœ¨ OID ä¸ä¸º null Session ç¼“å­˜ä¸­å«åšæŒä¹…åŒ–æ€ æ•°æ®åº“ä¸­å·²ç»æœ‰å’Œå…¶å¯¹åº”çš„è®°å½•,æŒä¹…åŒ–å¯¹è±¡å’Œæ•°æ®åº“ä¸­çš„ç›¸å…³è®°å½•å¯¹åº”ã€‚</li>
<li>Session åœ¨ flush ç¼“å­˜æ—¶, ä¼šæ ¹æ®æŒä¹…åŒ–å¯¹è±¡çš„å±æ€§å˜åŒ–, æ¥è®¡åˆ’SQLè¯­å¥åŒæ­¥æ›´æ–°æ•°æ®åº“ã€‚</li>
<li>åœ¨äº‹åŠ¡æäº¤å æ›´æ–°æ•°æ®åº“è¡¨ä¸­æ•°æ®ï¼Œæ•°æ®æ‰ä¼šæ°¸ä¹…ä¿å­˜ä¸‹æ¥,ä¹Ÿå°±æ˜¯è¢«æŒä¹…åŒ–äº†ã€‚</li>
<li>åœ¨åŒä¸€ä¸ª Session å®ä¾‹çš„ç¼“å­˜ä¸­, æ•°æ®åº“è¡¨ä¸­çš„æ¯æ¡è®°å½•åªå¯¹åº”å”¯ä¸€çš„æŒä¹…åŒ–å¯¹è±¡ã€‚</li>
</ul>
<hr>
<h3 id="2-ä¸´æ—¶å¯¹è±¡transient">2ã€ä¸´æ—¶å¯¹è±¡ï¼ˆTransientï¼‰</h3>
<ul>
<li>åœ¨ä½¿ç”¨ä»£ç†ä¸»é”®æƒ…å†µä¸‹ï¼ŒOID é€šå¸¸ä¸º null ä¸å¤„äº Session çš„ç¼“å­˜ä¸­åœ¨æ•°æ®åº“ä¸­æ²¡æœ‰å¯¹åº”è®°å½•ã€‚</li>
</ul>
<hr>
<h3 id="3-æ¸¸ç¦»å¯¹è±¡ä¹Ÿå«-è„±ç®¡detached">3ã€æ¸¸ç¦»å¯¹è±¡(ä¹Ÿå« è„±ç®¡ï¼‰ï¼ˆDetachedï¼‰</h3>
<ul>
<li>OID ä¸ä¸º null ä¸å†å¤„äº Session ç¼“å­˜ä¸­</li>
<li>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ¸¸ç¦»å¯¹è±¡ç”±æŒä¹…åŒ–å¯¹è±¡è½¬å˜è¿‡æ¥çš„ï¼Œå› æ­¤æ•°æ®åº“ä¸­å¯èƒ½è¿˜å­˜åœ¨ä¸å®ƒå¯¹åº”çš„è®°å½•ã€‚</li>
</ul>
<hr>
<h3 id="4-åˆ é™¤å¯¹è±¡removed">4ã€åˆ é™¤å¯¹è±¡(Removed)</h3>
<ul>
<li>åœ¨æ•°æ®åº“ä¸­æ²¡æœ‰å’Œå…¶ OID å¯¹åº”çš„è®°å½• ä¸å†å¤„äº Session ç¼“å­˜ä¸­ ä¸€èˆ¬æƒ…å†µä¸‹, åº”ç”¨ç¨‹åºä¸è¯¥å†ä½¿ç”¨è¢«åˆ é™¤çš„å¯¹è±¡ã€‚</li>
</ul>
<hr>
<h3 id="å¯¹è±¡çš„çŠ¶æ€è½¬æ¢å›¾">ğŸ‘‰å¯¹è±¡çš„çŠ¶æ€è½¬æ¢å›¾</h3>
<img src="http://ww1.sinaimg.cn/large/006vWPzFly1g1hfavns4sj30ta0gn0u4.jpg" width="700">
<h3 id="session-çš„-save-æ–¹æ³•">Session çš„ save() æ–¹æ³•</h3>
<p><strong>Session çš„ save() æ–¹æ³•ä½¿ä¸€ä¸ªä¸´æ—¶å¯¹è±¡è½¬å˜ä¸ºæŒä¹…åŒ–å¯¹è±¡ã€‚</strong><br>
<strong>Session çš„ save() æ–¹æ³•å®Œæˆä»¥ä¸‹æ“ä½œï¼š</strong></p>
<ul>
<li>æŠŠä¸€ä¸ªä¸´æ—¶å¯¹è±¡åŠ å…¥åˆ° Session ç¼“å­˜ä¸­, ä½¿å®ƒè¿›å…¥æŒä¹…åŒ–çŠ¶æ€ã€‚</li>
<li>é€‰ç”¨æ˜ å°„æ–‡ä»¶æŒ‡å®šçš„æ ‡è¯†ç¬¦ç”Ÿæˆå™¨, ä¸ºæŒä¹…åŒ–å¯¹è±¡åˆ†é…å”¯ä¸€çš„ OIDã€‚ åœ¨ä½¿ç”¨ä»£ç†ä¸»é”®çš„æƒ…å†µä¸‹, setId() æ–¹æ³•ä¸ºå¯¹è±¡è®¾ç½® OID ä½¿æ— æ•ˆçš„ã€‚</li>
<li>è®¡åˆ’æ‰§è¡Œä¸€æ¡ insert è¯­å¥ï¼šåœ¨ flush ç¼“å­˜çš„æ—¶å€™ã€‚</li>
<li>Hibernate é€šè¿‡æŒä¹…åŒ–å¯¹è±¡çš„ OID æ¥ç»´æŒå®ƒå’Œæ•°æ®åº“ç›¸å…³è®°å½•çš„å¯¹åº”å…³ç³»ã€‚</li>
<li>å½“ä¸€ä¸ªå¯¹è±¡å¤„äºæŒä¹…åŒ–çŠ¶æ€æ—¶, ä¸å…è®¸ç¨‹åºéšæ„ä¿®æ”¹å®ƒçš„ IDã€‚</li>
</ul>
<p><strong>persist() å’Œ save() åŒºåˆ«ï¼š</strong></p>
<ul>
<li>å½“å¯¹ä¸€ä¸ª OID ä¸ä¸º Null çš„å¯¹è±¡æ‰§è¡Œ save() æ–¹æ³•æ—¶, ä¼šæŠŠè¯¥å¯¹è±¡ä»¥ä¸€ä¸ªæ–°çš„ oid ä¿å­˜åˆ°æ•°æ®åº“ä¸­ã€‚ä½†æ‰§è¡Œ persist() æ–¹æ³•æ—¶ä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚</li>
</ul>
<hr>
<h3 id="session-çš„-get-å’Œ-load-æ–¹æ³•">Session çš„ get() å’Œ load() æ–¹æ³•</h3>
<p><strong>éƒ½å¯ä»¥æ ¹æ®è·Ÿå®šçš„ OID ä»æ•°æ®åº“ä¸­åŠ è½½ä¸€ä¸ªæŒä¹…åŒ–å¯¹è±¡ã€‚</strong></p>
<hr>
<p><strong>get() å’Œ load()åŒºåˆ«ï¼š</strong></p>
<ul>
<li><strong>1ã€ get æ˜¯ ç«‹å³æ£€ç´¢, load æ˜¯å»¶è¿Ÿæ£€ç´¢ã€‚</strong>
<ul>
<li>æ‰§è¡Œ get æ–¹æ³•ï¼š ä¼šç«‹å³åŠ è½½å¯¹è±¡ï¼Œä¸æ”¯æŒå»¶è¿ŸåŠ è½½ã€‚</li>
<li>æ‰§è¡Œ load æ–¹æ³•ï¼šè‹¥ä¸ä½¿ç”¨è¯¥å¯¹è±¡, åˆ™ä¸ä¼šç«‹å³æ‰§è¡ŒæŸ¥è¯¢æ“ä½œ, è€Œè¿”å›ä¸€ä¸ªä»£ç†å¯¹è±¡ã€‚</li>
</ul>
</li>
<li><strong>2ã€å¼‚å¸¸ï¼š åœ¨éœ€è¦åˆå§‹åŒ–ä»£ç†å¯¹è±¡ä¹‹å‰å·²ç»å…³é—­äº† Sessionã€‚</strong>
<ul>
<li><strong>load æ–¹æ³•ä¼šæŠ›å‡º LazyInitializationException</strong></li>
</ul>
</li>
<li><strong>3ã€ è‹¥æ•°æ®è¡¨ä¸­ä¸å­˜åœ¨ä¸ OID å¯¹åº”çš„è®°å½•æ—¶, Session ä¹Ÿæ²¡æœ‰è¢«å…³é—­ã€‚</strong></li>
</ul>
<p><strong><code>get è¿”å› null</code> ----&gt; load è‹¥ä¸ä½¿ç”¨è¯¥å¯¹è±¡çš„ä»»ä½•å±æ€§, æ²¡é—®é¢˜ã€‚è‹¥éœ€è¦åˆå§‹åŒ–äº†, æŠ›å‡º ObjectNotFoundException å¼‚å¸¸ã€‚</strong></p>
<hr>
<h3 id="session-çš„-update-æ–¹æ³•">Session çš„ update() æ–¹æ³•</h3>
<ul>
<li>
<p><strong>1ã€è‹¥æ›´æ–°ä¸€ä¸ªæŒä¹…åŒ–å¯¹è±¡, <code>ä¸éœ€è¦æ˜¾ç¤º</code> è°ƒç”¨ update æ–¹æ³•ã€‚</strong></p>
<ul>
<li><strong>å› ä¸ºåœ¨è°ƒç”¨ Transaction çš„ commit() æ–¹æ³•æ—¶, ä¼šå…ˆæ‰§è¡Œ session çš„ flush æ–¹æ³•ã€‚</strong></li>
</ul>
</li>
<li>
<p><strong>2ã€æ›´æ–°ä¸€ä¸ªæ¸¸ç¦»å¯¹è±¡, <code>éœ€è¦æ˜¾å¼</code> è°ƒç”¨ session çš„ update æ–¹æ³•ã€‚</strong></p>
<ul>
<li><strong>å¯ä»¥æŠŠä¸€ä¸ªæ¸¸ç¦»å¯¹è±¡å˜ä¸ºæŒä¹…åŒ–å¯¹è±¡ã€‚</strong></li>
</ul>
</li>
</ul>
<p><strong>éœ€è¦æ³¨æ„ï¼š</strong></p>
<ul>
<li><strong>å¯¹äºå½“å‰Sessionæ˜¯ æ¸¸ç¦»å¯¹è±¡ æ— è®ºè¦æ›´æ–°çš„ æ•°æ®å’Œæ•°æ®è¡¨çš„è®°å½• æ˜¯å¦ä¸€è‡´, éƒ½ä¼šå‘é€ UPDATE è¯­å¥ã€‚</strong></li>
</ul>
<p><strong>Session çš„ update() æ–¹æ³•ä½¿ä¸€ä¸ª<code>æ¸¸ç¦»å¯¹è±¡è½¬å˜ä¸ºæŒä¹…åŒ–å¯¹è±¡</code>, å¹¶ä¸”è®¡åˆ’æ‰§è¡Œä¸€æ¡ update è¯­å¥ã€‚</strong></p>
<p><strong>è‹¥å¸Œæœ› Session ä»…å½“ä¿®æ”¹äº†å¯¹è±¡çš„å±æ€§æ—¶, æ‰æ‰§è¡Œ update() è¯­å¥ å¯ä»¥æŠŠæ˜ å°„æ–‡ä»¶ä¸­ <code>&lt;class&gt;</code> å…ƒç´ çš„select-before-update è®¾ä¸º trueã€‚è¯¥å±æ€§çš„é»˜è®¤å€¼ä¸º false ä½†é€šå¸¸ä¸éœ€è¦è®¾ç½®è¯¥å±æ€§ã€‚</strong></p>
<ul>
<li>å½“ update() æ–¹æ³•å…³è”ä¸€ä¸ªæ¸¸ç¦»å¯¹è±¡æ—¶, å¦‚æœåœ¨ Session çš„ç¼“å­˜ä¸­å·²ç»å­˜åœ¨ç›¸åŒ OID çš„æŒä¹…åŒ–å¯¹è±¡, ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</li>
<li>å½“ update() æ–¹æ³•å…³è”ä¸€ä¸ªæ¸¸ç¦»å¯¹è±¡æ—¶, å¦‚æœåœ¨æ•°æ®åº“ä¸­ä¸å­˜åœ¨ç›¸åº”çš„è®°å½•, ä¹Ÿä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</li>
</ul>
<hr>
<h3 id="session-çš„-saveorupdate-æ–¹æ³•">Session çš„ saveOrUpdate() æ–¹æ³•</h3>
<p><strong>Session çš„ saveOrUpdate() æ–¹æ³•åŒæ—¶åŒ…å«äº† save() ä¸ update() æ–¹æ³•çš„åŠŸèƒ½ã€‚</strong></p>
<ul>
<li>åˆ¤å®šå¯¹è±¡ä¸ºä¸´æ—¶å¯¹è±¡çš„æ ‡å‡†
<ul>
<li>Java å¯¹è±¡çš„ OID ä¸º null</li>
<li>æ˜ å°„æ–‡ä»¶ä¸­ä¸º <id> è®¾ç½®äº† unsaved-value  å±æ€§</id></li>
<li>å¹¶ä¸” Java å¯¹è±¡çš„ OID å–å€¼ä¸è¿™ä¸ª unsaved-value å±æ€§å€¼åŒ¹é…</li>
</ul>
</li>
</ul>
<hr>
<h3 id="session-çš„-merge-æ–¹æ³•">Session çš„ merge() æ–¹æ³•</h3>
<img src="http://ww1.sinaimg.cn/large/006vWPzFly1g1hfgzpxrrj30sv0j2ju4.jpg" width="700">
<hr>
<h3 id="session-çš„-delete-æ–¹æ³•">Session çš„ delete() æ–¹æ³•</h3>
<p><strong>Session çš„ delete() æ–¹æ³•æ—¢å¯ä»¥åˆ é™¤ä¸€ä¸ªæ¸¸ç¦»å¯¹è±¡, ä¹Ÿå¯ä»¥åˆ é™¤ä¸€ä¸ªæŒä¹…åŒ–å¯¹è±¡ã€‚</strong></p>
<p><strong>Session çš„ delete() æ–¹æ³•å¤„ç†è¿‡ç¨‹ï¼š</strong></p>
<ul>
<li>è®¡åˆ’æ‰§è¡Œä¸€æ¡ delete è¯­å¥ã€‚</li>
<li>æŠŠå¯¹è±¡ä» Session ç¼“å­˜ä¸­åˆ é™¤, è¯¥å¯¹è±¡è¿›å…¥åˆ é™¤çŠ¶æ€ã€‚
<ul>
<li>Hibernate çš„ cfg.xml é…ç½®æ–‡ä»¶ä¸­æœ‰ä¸€ä¸ª hibernate.use_identifier_rollback å±æ€§,å…¶é»˜è®¤å€¼ä¸º falseã€‚</li>
<li>è‹¥æŠŠå®ƒè®¾ä¸º true, å°†æ”¹å˜ delete() æ–¹æ³•çš„è¿è¡Œè¡Œä¸ºï¼š
<ul>
<li>delete() æ–¹æ³•ä¼šæŠŠæŒä¹…åŒ–å¯¹è±¡æˆ–æ¸¸ç¦»å¯¹è±¡çš„ OID è®¾ç½®ä¸º null, ä½¿å®ƒä»¬å˜ä¸ºä¸´æ—¶å¯¹è±¡ã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
<hr>
<h3 id="session-çš„-evict-æ–¹æ³•">Session çš„ Evict() æ–¹æ³•</h3>
<ul>
<li><strong>ä» session ç¼“å­˜ä¸­æŠŠæŒ‡å®šçš„æŒä¹…åŒ–å¯¹è±¡ç§»é™¤ã€‚</strong></li>
</ul>
<hr>
<h3 id="session-çš„-refresh-æ–¹æ³•">Session çš„ refresh() æ–¹æ³•</h3>
<ul>
<li><strong>ä¼šå¼ºåˆ¶å‘é€ SELECT è¯­å¥,ä½¿ Session ç¼“å­˜ä¸­å¯¹è±¡çš„çŠ¶æ€å’Œæ•°æ®è¡¨ä¸­å¯¹åº”çš„è®°å½•ä¿æŒä¸€è‡´ï¼ä½†æ˜¯æœ‰äº‹åŠ¡éš”ç¦»çº§åˆ«é™åˆ¶ã€‚</strong></li>
</ul>
<hr>
<h3 id="session-çš„-clear-æ–¹æ³•">Session çš„ clear() æ–¹æ³•</h3>
<ul>
<li><strong>æ¸…ç†ç¼“å­˜</strong></li>
</ul>
<hr>
<h3 id="session-ç¼“å­˜">Session ç¼“å­˜</h3>
<ul>
<li><strong>åœ¨ Session æ¥å£çš„å®ç°ä¸­åŒ…å«ä¸€ç³»åˆ—çš„ Java é›†åˆ, è¿™äº› Java é›†åˆæ„æˆäº† Session ç¼“å­˜ã€‚</strong></li>
<li><strong>åªè¦Sessionå®ä¾‹æ²¡æœ‰ç»“æŸç”Ÿå‘½å‘¨æœŸ, ä¸”æ²¡æœ‰æ¸…ç†ç¼“å­˜ï¼Œåˆ™å­˜æ”¾åœ¨å®ƒç¼“å­˜ä¸­çš„å¯¹è±¡ä¹Ÿä¸ä¼šç»“æŸç”Ÿå‘½å‘¨æœŸã€‚</strong></li>
<li><strong>Session ç¼“å­˜å¯å‡å°‘ Hibernate åº”ç”¨ç¨‹åºè®¿é—®æ•°æ®åº“çš„é¢‘ç‡ã€‚</strong></li>
</ul>
<img src="http://ww1.sinaimg.cn/large/006vWPzFly1g1hdnrvoo7j30pp0fbwf9.jpg" width="700">
<hr>
<h3 id="flush-ç¼“å­˜">flush ç¼“å­˜</h3>
<p><strong>flushï¼šä½¿æ•°æ®åº“è¡¨ä¸­çš„è®°å½•å’Œ Hibernate Session ç¼“å­˜ä¸­çš„å¯¹è±¡çš„çŠ¶æ€ä¿æŒä¸€è‡´ã€‚ä¸ºäº†ä¿æŒä¸€è‡´, åˆ™å¯èƒ½ä¼šå‘é€å¯¹åº”çš„ SQL è¯­å¥ã€‚</strong></p>
<ul>
<li>Session æŒ‰ç…§ç¼“å­˜ä¸­å¯¹è±¡çš„å±æ€§å˜åŒ–æ¥åŒæ­¥æ›´æ–°æ•°æ®åº“ã€‚</li>
</ul>
<p><strong>é»˜è®¤æƒ…å†µä¸‹ Session åœ¨ä»¥ä¸‹æ—¶é—´ç‚¹åˆ·æ–°ç¼“å­˜ï¼š</strong></p>
<ul>
<li>1ã€æ˜¾å¼è°ƒç”¨ Session çš„ flush() æ–¹æ³•</li>
<li>2ã€åº”ç”¨ç¨‹åºè°ƒç”¨ Transaction çš„ commit() æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å…ˆ flush ï¼Œç„¶åå‘æ•°æ®åº“æäº¤äº‹åŠ¡ã€‚</li>
<li>3ã€<code>flush() æ–¹æ³•ä¼šå¯èƒ½ä¼šå‘é€ SQL è¯­å¥, ä½†ä¸ä¼šæäº¤äº‹åŠ¡ã€‚</code></li>
</ul>
<hr>
<p><strong>flush ç¼“å­˜çš„ä¾‹å¤–æƒ…å†µï¼š</strong><br>
æ³¨æ„ï¼š åœ¨æœªæäº¤äº‹åŠ¡æˆ–æ˜¾å¼çš„è°ƒç”¨ session.flush() æ–¹æ³•ä¹‹å‰, ä¹Ÿæœ‰å¯èƒ½ä¼šè¿›è¡Œ flush() æ“ä½œã€‚</p>
<ul>
<li>æ‰§è¡Œ HQL æˆ– QBC æŸ¥è¯¢, å¦‚æœç¼“å­˜ä¸­æŒä¹…åŒ–å¯¹è±¡çš„å±æ€§å·²ç»å‘ç”Ÿäº†å˜åŒ–ï¼Œä¼šå…ˆè¿›è¡Œ flush() æ“ä½œ, ä»¥å¾—åˆ°æ•°æ®è¡¨çš„æœ€æ–°çš„è®°å½•ã€‚</li>
<li>å¦‚æœå¯¹è±¡ä½¿ç”¨ native ç”Ÿæˆå™¨ç”Ÿæˆ OID, é‚£ä¹ˆå½“è°ƒç”¨ Session çš„ save() æ–¹æ³•ä¿å­˜å¯¹è±¡æ—¶, ä¼šç«‹å³æ‰§è¡Œå‘æ•°æ®åº“æ’å…¥è¯¥å®ä½“çš„ insert è¯­å¥ã€‚
<ul>
<li>å› ä¸º save æ–¹æ³•å, å¿…é¡»ä¿è¯å¯¹è±¡çš„ ID æ˜¯å­˜åœ¨çš„ï¼</li>
</ul>
</li>
</ul>
<p><strong>commit() å’Œ flush() æ–¹æ³•çš„åŒºåˆ«ï¼š</strong></p>
<ul>
<li>flush æ‰§è¡Œä¸€ç³»åˆ— sql è¯­å¥ï¼Œä½†ä¸æäº¤äº‹åŠ¡ï¼›</li>
<li>commit() æ–¹æ³•å…ˆè°ƒç”¨ flush() æ–¹æ³•ï¼Œç„¶åæäº¤äº‹åŠ¡ã€‚æäº¤äº‹åŠ¡æ„å‘³ç€å¯¹æ•°æ®åº“æ“ä½œæ°¸ä¹…ä¿å­˜ã€‚</li>
</ul>
<hr>
<h2 id="å…­-å¯¹è±¡å…³ç³»æ˜ å°„æ–‡ä»¶">å…­ã€å¯¹è±¡å…³ç³»æ˜ å°„æ–‡ä»¶</h2>
<p><strong>POJO ç±» å’Œ æ•°æ®åº“çš„æ˜ å°„æ–‡ä»¶  *.hbm.xml</strong></p>
<ul>
<li>POJO ç±»å’Œå…³ç³»æ•°æ®åº“ä¹‹é—´çš„æ˜ å°„å¯ä»¥ç”¨ä¸€ä¸ªXMLæ–‡æ¡£æ¥å®šä¹‰ã€‚</li>
<li>é€šè¿‡ POJO ç±»çš„æ•°æ®åº“æ˜ å°„æ–‡ä»¶ï¼ŒHibernateå¯ä»¥ç†è§£æŒä¹…åŒ–ç±»å’Œæ•°æ®è¡¨ä¹‹é—´çš„å¯¹åº”å…³ç³»ï¼Œä¹Ÿå¯ä»¥ç†è§£æŒä¹…åŒ–ç±»å±æ€§ä¸æ•°æ®åº“è¡¨åˆ—ä¹‹é—´çš„å¯¹åº”å…³ç³»ã€‚</li>
<li>åœ¨è¿è¡Œæ—¶ Hibernate å°†æ ¹æ®è¿™ä¸ªæ˜ å°„æ–‡ä»¶æ¥ç”Ÿæˆå„ç§ SQL è¯­å¥ã€‚</li>
<li>æ˜ å°„æ–‡ä»¶çš„æ‰©å±•åä¸º .hbm.xml</li>
</ul>
<p><strong>hibernate-mapping</strong></p>
<ul>
<li>ç±»å±‚æ¬¡ï¼šclass</li>
<li>ä¸»é”®ï¼šid</li>
<li>åŸºæœ¬ç±»å‹:property</li>
<li>å®ä½“å¼•ç”¨ç±»: many-to-one  |  one-to-one</li>
<li>é›†åˆ:set | list | map | array
<ul>
<li>one-to-many</li>
<li>many-to-many</li>
</ul>
</li>
<li>å­ç±»:subclass | joined-subclass</li>
<li>å…¶å®ƒ:component | any ç­‰</li>
<li>æŸ¥è¯¢è¯­å¥:queryï¼ˆç”¨æ¥æ”¾ç½®æŸ¥è¯¢è¯­å¥ï¼Œä¾¿äºå¯¹æ•°æ®åº“æŸ¥è¯¢çš„ç»Ÿä¸€ç®¡ç†å’Œä¼˜åŒ–ï¼‰</li>
</ul>
<p><strong>æ¯ä¸ªHibernate-mappingä¸­å¯ä»¥åŒæ—¶å®šä¹‰å¤šä¸ªç±»ã€‚ ä½†æ›´æ¨èä¸ºæ¯ä¸ªç±»éƒ½åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„æ˜ å°„æ–‡ä»¶</strong></p>
<hr>
<h3 id="1-hibernate-mapping">1ã€hibernate-mapping</h3>
<p><strong>hibernate-mapping æ˜¯ hibernate.hbm.xml æ˜ å°„æ–‡ä»¶çš„æ ¹å…ƒç´ ã€‚</strong></p>
<ul>
<li>schemaï¼š æŒ‡å®šæ‰€æ˜ å°„çš„æ•°æ®åº“schemaçš„åç§°ã€‚è‹¥æŒ‡å®šè¯¥å±æ€§, åˆ™è¡¨æ˜ä¼šè‡ªåŠ¨æ·»åŠ è¯¥ schema å‰ç¼€ã€‚</li>
<li>catalogï¼šæŒ‡å®šæ‰€æ˜ å°„çš„æ•°æ®åº“catalogçš„åç§°ã€‚</li>
<li>default-cascade(é»˜è®¤ä¸º none)ï¼š è®¾ç½®hibernateé»˜è®¤çš„çº§è”é£æ ¼ã€‚
<ul>
<li>è‹¥é…ç½® Java å±æ€§, é›†åˆæ˜ å°„æ—¶æ²¡æœ‰æŒ‡å®š cascade å±æ€§, åˆ™ Hibernate å°†é‡‡ç”¨æ­¤å¤„æŒ‡å®šçš„çº§è”é£æ ¼ã€‚</li>
</ul>
</li>
<li>default-access (é»˜è®¤ä¸º property)ï¼š æŒ‡å®š Hibernate çš„é»˜è®¤çš„å±æ€§è®¿é—®ç­–ç•¥ã€‚
<ul>
<li>é»˜è®¤å€¼ä¸º property, å³ä½¿ç”¨ getter, setter æ–¹æ³•æ¥è®¿é—®å±æ€§. è‹¥æŒ‡å®š access, åˆ™ Hibernate ä¼šå¿½ç•¥ getter/setter æ–¹æ³•, è€Œé€šè¿‡åå°„è®¿é—®æˆå‘˜å˜é‡ã€‚</li>
</ul>
</li>
<li>default-lazy(é»˜è®¤ä¸º true)ï¼š è®¾ç½® Hibernat morningçš„å»¶è¿ŸåŠ è½½ç­–ç•¥ã€‚
<ul>
<li>è¯¥å±æ€§çš„é»˜è®¤å€¼ä¸º true, å³å¯ç”¨å»¶è¿ŸåŠ è½½ç­–ç•¥ã€‚ è‹¥é…ç½® Java å±æ€§æ˜ å°„, é›†åˆæ˜ å°„æ—¶æ²¡æœ‰æŒ‡å®š lazy å±æ€§, åˆ™ Hibernate å°†é‡‡ç”¨æ­¤å¤„æŒ‡å®šçš„å»¶è¿ŸåŠ è½½ç­–ç•¥ã€‚</li>
</ul>
</li>
<li>auto-import (é»˜è®¤ä¸º true)ï¼š æŒ‡å®šæ˜¯å¦å¯ä»¥åœ¨æŸ¥è¯¢è¯­è¨€ä¸­ä½¿ç”¨éå…¨é™å®šçš„ç±»åï¼ˆä»…é™äºæœ¬æ˜ å°„æ–‡ä»¶ä¸­çš„ç±»ï¼‰ã€‚</li>
<li>package (å¯é€‰)ï¼š æŒ‡å®šä¸€ä¸ªåŒ…å‰ç¼€,å¦‚æœåœ¨æ˜ å°„æ–‡æ¡£ä¸­æ²¡æœ‰æŒ‡å®šå…¨é™å®šçš„ç±»å,å°±ä½¿ç”¨è¿™ä¸ªä½œä¸ºåŒ…åã€‚</li>
</ul>
<hr>
<h3 id="2-class">2ã€class</h3>
<p><strong>class æ˜¯ hibernate-mapping çš„å­å…ƒç´ ,class å…ƒç´ ç”¨äºæŒ‡å®šç±»å’Œè¡¨çš„æ˜ å°„ã€‚</strong></p>
<ul>
<li>nameï¼šæŒ‡å®šè¯¥æŒä¹…åŒ–ç±»æ˜ å°„çš„æŒä¹…åŒ–ç±»çš„ç±»åã€‚</li>
<li>tableï¼šæŒ‡å®šè¯¥æŒä¹…åŒ–ç±»æ˜ å°„çš„è¡¨å, Hibernate é»˜è®¤ä»¥æŒä¹…åŒ–ç±»çš„ç±»åä½œä¸ºè¡¨åã€‚</li>
<li>dynamic-insertï¼š è‹¥è®¾ç½®ä¸º true, è¡¨ç¤ºå½“ä¿å­˜ä¸€ä¸ªå¯¹è±¡æ—¶, ä¼šåŠ¨æ€ç”Ÿæˆ insert è¯­å¥,
<ul>
<li>insert è¯­å¥ä¸­ä»…åŒ…å«æ‰€æœ‰å–å€¼ä¸ä¸º null çš„å­—æ®µ. é»˜è®¤å€¼ä¸º false</li>
</ul>
</li>
<li>dynamic-updateï¼š è‹¥è®¾ç½®ä¸º true, è¡¨ç¤ºå½“æ›´æ–°ä¸€ä¸ªå¯¹è±¡æ—¶, ä¼šåŠ¨æ€ç”Ÿæˆ update è¯­å¥,
<ul>
<li><code>update è¯­å¥ä¸­ä»…åŒ…å«æ‰€æœ‰å–å€¼éœ€è¦æ›´æ–°çš„å­—æ®µã€‚</code> é»˜è®¤å€¼ä¸º false</li>
</ul>
</li>
<li>select-before-updateï¼šè®¾ç½® Hibernate åœ¨æ›´æ–°æŸä¸ªæŒä¹…åŒ–å¯¹è±¡ä¹‹å‰æ˜¯å¦éœ€è¦å…ˆæ‰§è¡Œä¸€æ¬¡æŸ¥è¯¢ã€‚ é»˜è®¤å€¼ä¸º falseã€‚</li>
<li>batch-sizeï¼šæŒ‡å®šæ ¹æ® OID æ¥æŠ“å–å®ä¾‹æ—¶æ¯æ‰¹æŠ“å–çš„å®ä¾‹æ•°ã€‚</li>
<li>lazyï¼š æŒ‡å®šæ˜¯å¦ä½¿ç”¨å»¶è¿ŸåŠ è½½ã€‚</li>
<li>mutableï¼š è‹¥è®¾ç½®ä¸º true, ç­‰ä»·äºæ‰€æœ‰çš„ <property> å…ƒç´ çš„ update å±æ€§ä¸º false, è¡¨ç¤ºæ•´ä¸ªå®ä¾‹ä¸èƒ½è¢«æ›´æ–°ã€‚ é»˜è®¤ä¸º trueã€‚</property></li>
<li>discriminator-valueï¼š æŒ‡å®šåŒºåˆ†ä¸åŒå­ç±»çš„å€¼. å½“ä½¿ç”¨ <subclass> å…ƒç´ æ¥å®šä¹‰æŒä¹…åŒ–ç±»çš„ç»§æ‰¿å…³ç³»æ—¶éœ€è¦ä½¿ç”¨è¯¥å±æ€§ã€‚</subclass></li>
</ul>
<hr>
<h3 id="3-id">3ã€id</h3>
<p><strong>id æ˜¯ class çš„å­å…ƒç´ ã€‚</strong></p>
<ul>
<li>idï¼šè®¾å®šæŒä¹…åŒ–ç±»çš„ OID å’Œè¡¨çš„ä¸»é”®çš„æ˜ å°„ã€‚
<ul>
<li>Hibernate æ¨èåœ¨æ•°æ®è¡¨ä¸­ä½¿ç”¨ä»£ç†ä¸»é”®, å³ä¸å…·å¤‡ä¸šåŠ¡å«ä¹‰çš„å­—æ®µã€‚</li>
<li>ä»£ç†ä¸»é”®é€šå¸¸ä¸ºæ•´æ•°ç±»å‹, å› ä¸ºæ•´æ•°ç±»å‹æ¯”å­—ç¬¦ä¸²ç±»å‹è¦èŠ‚çœæ›´å¤šçš„æ•°æ®åº“ç©ºé—´ã€‚</li>
</ul>
</li>
<li>nameï¼š æ ‡è¯†æŒä¹…åŒ–ç±» OID çš„å±æ€§åã€‚</li>
<li>columnï¼š è®¾ç½®æ ‡è¯†å±æ€§æ‰€æ˜ å°„çš„æ•°æ®è¡¨çš„åˆ—å(ä¸»é”®å­—æ®µçš„åå­—)ã€‚</li>
<li>unsaved-valueï¼šè‹¥è®¾å®šäº†è¯¥å±æ€§, Hibernate ä¼šé€šè¿‡æ¯”è¾ƒæŒä¹…åŒ–ç±»çš„ OID å€¼å’Œè¯¥å±æ€§å€¼æ¥åŒºåˆ†å½“å‰æŒä¹…åŒ–ç±»çš„å¯¹è±¡æ˜¯å¦ä¸ºä¸´æ—¶å¯¹è±¡ã€‚</li>
<li>typeï¼šæŒ‡å®š Hibernate æ˜ å°„ç±»å‹ã€‚ Hibernate æ˜ å°„ç±»å‹æ˜¯ Java ç±»å‹ä¸ SQL ç±»å‹çš„æ¡¥æ¢ã€‚
<ul>
<li>å¦‚æœæ²¡æœ‰ä¸ºæŸä¸ªå±æ€§æ˜¾å¼è®¾å®šæ˜ å°„ç±»å‹, Hibernate ä¼šè¿ç”¨åå°„æœºåˆ¶å…ˆè¯†åˆ«å‡ºæŒä¹…åŒ–ç±»çš„ç‰¹å®šå±æ€§çš„ Java ç±»å‹, ç„¶åè‡ªåŠ¨ä½¿ç”¨ä¸ä¹‹å¯¹åº”çš„é»˜è®¤çš„ Hibernate æ˜ å°„ç±»å‹ã€‚</li>
</ul>
</li>
<li>Java çš„åŸºæœ¬æ•°æ®ç±»å‹å’ŒåŒ…è£…ç±»å‹å¯¹åº”ç›¸åŒçš„ Hibernate æ˜ å°„ç±»å‹. åŸºæœ¬æ•°æ®ç±»å‹æ— æ³•è¡¨è¾¾ null, æ‰€ä»¥å¯¹äºæŒä¹…åŒ–ç±»çš„ OID æ¨èä½¿ç”¨åŒ…è£…ç±»å‹ã€‚</li>
<li>generatorï¼šè®¾å®šæŒä¹…åŒ–ç±»è®¾å®šæ ‡è¯†ç¬¦ç”Ÿæˆå™¨ã€‚
<ul>
<li>classï¼šæŒ‡å®šä½¿ç”¨çš„æ ‡è¯†ç¬¦ç”Ÿæˆå™¨å…¨é™å®šç±»åæˆ–å…¶ç¼©å†™åã€‚</li>
</ul>
</li>
</ul>
<hr>
<p><strong>ä¸»é”®ç”Ÿæˆç­–ç•¥generator</strong></p>
<table>
<thead>
<tr>
<th>æ ‡è¯†ç¬¦</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td>increment</td>
<td>é€‚ç”¨äºä»£ç†ä¸»é”®ã€‚ç”±Hibernate è‡ªåŠ¨ä»¥é€’å¢æ–¹å¼ç”Ÿæˆã€‚</td>
</tr>
<tr>
<td>identity</td>
<td>é€‚ç”¨äºä»£ç†ä¸»é”®ã€‚ç”±åº•å±‚æ•°æ®åº“ç”Ÿæˆæ ‡è¯†ç¬¦ã€‚</td>
</tr>
<tr>
<td>sequence</td>
<td>é€‚ç”¨äºä»£ç†ä¸»é”®ã€‚Hibernateæ ¹æ®åº•å±‚æ•°æ®åº“çš„åºåˆ—ç”Ÿæˆæ ‡è¯†ç¬¦ï¼Œè¿™è¦æ±‚åº•å±‚æ•°æ®åº“æ”¯æŒåºåˆ—ã€‚</td>
</tr>
<tr>
<td>hilo</td>
<td>é€‚ç”¨äºä»£ç†ä¸»é”®ã€‚Hibernateåˆ†å±€high/lowç®—æ³•ç”Ÿæˆæ ‡è¯†ç¬¦ã€‚</td>
</tr>
<tr>
<td>seqhilo</td>
<td>é€‚ç”¨äºä»£ç†ä¸»é”®ã€‚ä½¿ç”¨ä¸€ä¸ªé«˜/ä½ä½ç®—æ³•æ¥é«˜æ•ˆçš„ç”Ÿæˆlong, shortæˆ–è€…intç±»å‹çš„æ ‡è¯†ç¬¦ã€‚</td>
</tr>
<tr>
<td>native</td>
<td>é€‚ç”¨äºä»£ç†ä¸»é”®ã€‚æ ¹æ®åº•å±‚æ•°æ®åº“å¯¹è‡ªåŠ¨ç”Ÿæˆæ ‡è¯†ç¬¦çš„æ–¹å¼ï¼Œè‡ªåŠ¨é€‰æ‹©identity. sequenceæˆ–hiloã€‚</td>
</tr>
<tr>
<td>uuid.hex</td>
<td>é€‚ç”¨äºä»£ç†ä¸»é”®ã€‚Hibernateé‡‡ç”¨128ä½çš„UUIDç®—æ³•ç”Ÿæˆæ ‡è¯†ç¬¦ã€‚</td>
</tr>
<tr>
<td>uuid.string</td>
<td>é€‚ç”¨äºä»£ç†ä¸»é”®ã€‚UUIDè¢«ç¼–ç æˆä¸€ä¸ª16å­—ç¬¦é•¿çš„å­—ç¬¦ä¸²ã€‚</td>
</tr>
<tr>
<td>assigned</td>
<td>é€‚ç”¨äºè‡ªç„¶ä¸»é”®ã€‚ç”±Javaåº”ç”¨ç¨‹åºè´Ÿè´£ç”Ÿæˆæ ‡è¯†ç¬¦ã€‚</td>
</tr>
<tr>
<td>foreign</td>
<td>é€‚ç”¨äºä»£ç†ä¸»é”®ã€‚ä½¿ç”¨å¦å¤–ä¸€ä¸ªç›¸å…³è”çš„å¯¹è±¡çš„æ ‡è¯†ç¬¦ã€‚</td>
</tr>
</tbody>
</table>
<hr>
<p><strong>increment æ ‡è¯†ç¬¦ç”Ÿæˆå™¨</strong></p>
<ul>
<li>increment æ ‡è¯†ç¬¦ç”Ÿæˆå™¨ç”± Hibernate ä»¥é€’å¢çš„æ–¹å¼ä¸ºä»£ç†ä¸»é”®èµ‹å€¼ã€‚</li>
<li>Hibernate ä¼šå…ˆè¯»å–è¡¨ä¸­çš„ä¸»é”®çš„æœ€å¤§å€¼, è€Œæ¥ä¸‹æ¥å‘è¡¨ä¸­æ’å…¥è®°å½•æ—¶, å°±åœ¨ max(id) çš„åŸºç¡€ä¸Šé€’å¢, å¢é‡ä¸º 1ã€‚</li>
<li><strong>é€‚ç”¨èŒƒå›´ï¼š</strong><br>
1ã€ç”±äº increment ç”Ÿå­˜æ ‡è¯†ç¬¦æœºåˆ¶ä¸ä¾èµ–äºåº•å±‚æ•°æ®åº“ç³»ç»Ÿ, å› æ­¤å®ƒé€‚åˆæ‰€æœ‰çš„æ•°æ®åº“ç³»ç»Ÿã€‚<br>
2ã€é€‚ç”¨äºåªæœ‰å•ä¸ª Hibernate åº”ç”¨è¿›ç¨‹è®¿é—®åŒä¸€ä¸ªæ•°æ®åº“çš„åœºåˆ, åœ¨é›†ç¾¤ç¯å¢ƒä¸‹ä¸æ¨èä½¿ç”¨å®ƒ æµ‹è¯•ä½¿ç”¨ã€‚<br>
3ã€OID å¿…é¡»ä¸º long, int æˆ– short ç±»å‹, å¦‚æœæŠŠ OID å®šä¹‰ä¸º byte ç±»å‹, åœ¨è¿è¡Œæ—¶ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</li>
</ul>
<hr>
<p><strong>identity æ ‡è¯†ç¬¦ç”Ÿæˆå™¨</strong></p>
<ul>
<li>
<p>identity æ ‡è¯†ç¬¦ç”Ÿæˆå™¨ç”±åº•å±‚æ ‡æ•°æ®åº“æ¥è´Ÿè´£ç”Ÿæˆè¯†ç¬¦, å®ƒè¦æ±‚åº•å±‚æ•°æ®åº“æŠŠä¸»é”®å®šä¹‰ä¸ºè‡ªåŠ¨å¢é•¿å­—æ®µç±»å‹ã€‚</p>
</li>
<li>
<p><strong>é€‚ç”¨èŒƒå›´ï¼š</strong></p>
<p>1ã€ç”±äº identity ç”Ÿæˆæ ‡è¯†ç¬¦çš„æœºåˆ¶ä¾èµ–äºåº•å±‚æ•°æ®åº“ç³»ç»Ÿ, å› æ­¤, è¦æ±‚åº•å±‚æ•°æ®åº“ç³»ç»Ÿå¿…é¡»æ”¯æŒè‡ªåŠ¨å¢é•¿å­—æ®µç±»å‹ã€‚<br>
2ã€OID å¿…é¡»ä¸º long, int æˆ– short ç±»å‹, å¦‚æœæŠŠ OID å®šä¹‰ä¸º byte ç±»å‹, åœ¨è¿è¡Œæ—¶ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</p>
</li>
</ul>
<hr>
<p><strong>sequence æ ‡è¯†ç¬¦ç”Ÿæˆå™¨</strong></p>
<ul>
<li>sequence  æ ‡è¯†ç¬¦ç”Ÿæˆå™¨åˆ©ç”¨åº•å±‚æ•°æ®åº“æä¾›çš„åºåˆ—æ¥ç”Ÿæˆæ ‡è¯†ç¬¦ã€‚</li>
<li>Hibernate åœ¨æŒä¹…åŒ–ä¸€ä¸ªå¯¹è±¡æ—¶, å…ˆä»åº•å±‚æ•°æ®åº“çš„è¡¨ åºåˆ—ä¸­è·å¾—ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†å·, å†æŠŠå®ƒä½œä¸ºä¸»é”®å€¼ã€‚</li>
<li><strong>é€‚ç”¨èŒƒå›´ï¼š</strong><br>
1ã€ç”±äº sequence ç”Ÿæˆæ ‡è¯†ç¬¦çš„æœºåˆ¶ä¾èµ–äºåº•å±‚æ•°æ®åº“ç³»ç»Ÿçš„åºåˆ—,å› æ­¤,è¦æ±‚åº•å±‚æ•°æ®åº“ç³»ç»Ÿå¿…é¡»æ”¯æŒåºåˆ—ã€‚æ”¯æŒåºåˆ—çš„æ•°æ®åº“åŒ…æ‹¬ï¼š<code>DB2,Oracle</code>ç­‰<br>
2ã€OID å¿…é¡»ä¸º long, int æˆ– short ç±»å‹, å¦‚æœæŠŠ OID å®šä¹‰ä¸º byte ç±»å‹, åœ¨è¿è¡Œæ—¶ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</li>
</ul>
<hr>
<p><strong>hilo æ ‡è¯†ç¬¦ç”Ÿæˆå™¨</strong></p>
<ul>
<li>hilo æ ‡è¯†ç¬¦ç”Ÿæˆå™¨ç”± Hibernate æŒ‰ç…§ä¸€ç§ high/low ç®—æ³•*ç”Ÿæˆæ ‡è¯†ç¬¦, å®ƒä»æ•°æ®åº“çš„ç‰¹å®šè¡¨çš„å­—æ®µä¸­è·å– high å€¼ã€‚
<ul>
<li>æ ¹æ®ä¸‹é¢çš„å…¬å¼è®¡ç®—å€¼ï¼šhi*(max_lo+1)+lo</li>
<li>ä½†æ˜¯æœ‰ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼Œå°±æ˜¯hiæ˜¯0çš„æ—¶å€™ï¼Œé‚£ä¹ˆç¬¬ä¸€ä¸ªå€¼ä¸æ˜¯0*(max_lo+1)+0=0è€Œæ˜¯è·³è¿‡0ï¼Œç›´æ¥å°±æ˜¯1</li>
</ul>
</li>
<li>Hibernate åœ¨æŒä¹…åŒ–ä¸€ä¸ª News å¯¹è±¡æ—¶, ç”± Hibernate è´Ÿè´£ç”Ÿæˆä¸»é”®å€¼ã€‚</li>
<li>hilo æ ‡è¯†ç¬¦ç”Ÿæˆå™¨åœ¨ç”Ÿæˆæ ‡è¯†ç¬¦æ—¶, éœ€è¦è¯»å–å¹¶ä¿®æ”¹ HI_TABLE è¡¨ä¸­çš„ NEXT_VALUE å€¼ã€‚</li>
<li><strong>é€‚ç”¨èŒƒå›´ï¼š</strong><br>
1ã€ç”±äº hilo ç”Ÿå­˜æ ‡è¯†ç¬¦æœºåˆ¶ä¸ä¾èµ–äºåº•å±‚æ•°æ®åº“ç³»ç»Ÿ, å› æ­¤å®ƒé€‚åˆæ‰€æœ‰çš„æ•°æ®åº“ç³»ç»Ÿã€‚<br>
2ã€OID å¿…é¡»ä¸º long, int æˆ– short ç±»å‹, å¦‚æœæŠŠ OID å®šä¹‰ä¸º byte ç±»å‹, åœ¨è¿è¡Œæ—¶ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</li>
</ul>
<hr>
<p><strong>native æ ‡è¯†ç¬¦ç”Ÿæˆå™¨</strong></p>
<ul>
<li>native æ ‡è¯†ç¬¦ç”Ÿæˆå™¨ä¾æ®åº•å±‚æ•°æ®åº“å¯¹è‡ªåŠ¨ç”Ÿæˆæ ‡è¯†ç¬¦çš„æ”¯æŒèƒ½åŠ›, æ¥é€‰æ‹©ä½¿ç”¨ identity, sequence æˆ– hilo æ ‡è¯†ç¬¦ç”Ÿæˆå™¨ã€‚</li>
<li><strong>é€‚ç”¨èŒƒå›´ï¼š</strong><br>
1ã€ç”±äº native èƒ½æ ¹æ®åº•å±‚æ•°æ®åº“ç³»ç»Ÿçš„ç±»å‹, è‡ªåŠ¨é€‰æ‹©åˆé€‚çš„æ ‡è¯†ç¬¦ç”Ÿæˆå™¨, å› æ­¤å¾ˆé€‚åˆäºè·¨æ•°æ®åº“å¹³å°å¼€å‘ã€‚<br>
2ã€OID å¿…é¡»ä¸º long, int æˆ– short ç±»å‹, å¦‚æœæŠŠ OID å®šä¹‰ä¸º byte ç±»å‹, åœ¨è¿è¡Œæ—¶ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</li>
</ul>
<hr>
<h3 id="4-property">4ã€Property</h3>
<p><strong>property å…ƒç´ ç”¨äºæŒ‡å®šç±»çš„å±æ€§å’Œè¡¨çš„å­—æ®µçš„æ˜ å°„ã€‚</strong></p>
<ul>
<li>nameï¼šæŒ‡å®šè¯¥æŒä¹…åŒ–ç±»çš„å±æ€§çš„åå­—ã€‚</li>
<li>typeï¼šæŒ‡å®š Hibernate æ˜ å°„ç±»å‹ã€‚ Hibernate æ˜ å°„ç±»å‹æ˜¯ Java ç±»å‹ä¸ SQL ç±»å‹çš„æ¡¥æ¢ã€‚
<ul>
<li>å¦‚æœæ²¡æœ‰ä¸ºæŸä¸ªå±æ€§æ˜¾å¼è®¾å®šæ˜ å°„ç±»å‹, Hibernate ä¼šè¿ç”¨åå°„æœºåˆ¶å…ˆè¯†åˆ«å‡ºæŒä¹…åŒ–ç±»çš„ç‰¹å®šå±æ€§çš„ Java ç±»å‹, ç„¶åè‡ªåŠ¨ä½¿ç”¨ä¸ä¹‹å¯¹åº”çš„é»˜è®¤çš„ Hibernate æ˜ å°„ç±»å‹ã€‚</li>
</ul>
</li>
<li>columnï¼šæŒ‡å®šä¸ç±»çš„å±æ€§æ˜ å°„çš„è¡¨çš„å­—æ®µåã€‚
<ul>
<li>å¦‚æœæ²¡æœ‰è®¾ç½®è¯¥å±æ€§, Hibernate å°†ç›´æ¥ä½¿ç”¨ç±»çš„å±æ€§åä½œä¸ºå­—æ®µåã€‚</li>
</ul>
</li>
<li>not-nullï¼šè‹¥è¯¥å±æ€§å€¼ä¸º true, è¡¨æ˜ä¸å…è®¸ä¸º null, é»˜è®¤ä¸º falseã€‚</li>
<li>accessï¼šæŒ‡å®š Hibernate çš„é»˜è®¤çš„å±æ€§è®¿é—®ç­–ç•¥ã€‚
<ul>
<li>é»˜è®¤å€¼ä¸º property, å³ä½¿ç”¨ getter, setter æ–¹æ³•æ¥è®¿é—®å±æ€§ã€‚</li>
<li>è‹¥æŒ‡å®š field, åˆ™ Hibernate ä¼šå¿½ç•¥ getter/setter æ–¹æ³•, è€Œé€šè¿‡åå°„è®¿é—®æˆå‘˜å˜é‡ã€‚</li>
</ul>
</li>
<li>uniqueï¼šè®¾ç½®æ˜¯å¦ä¸ºè¯¥å±æ€§æ‰€æ˜ å°„çš„æ•°æ®åˆ—æ·»åŠ å”¯ä¸€çº¦æŸã€‚</li>
<li>updateï¼šè®¾ç½®æ˜¯å¦ä¸ºè¯¥å±æ€§æ‰€æ˜ å°„çš„æ•°æ®åˆ—èƒ½å¦è¢«ä¿®æ”¹ã€‚</li>
<li>lengthï¼šæŒ‡å®šè¯¥å±æ€§æ‰€æ˜ å°„æ•°æ®åˆ—çš„å­—æ®µçš„é•¿åº¦ã€‚</li>
<li>indexï¼šæŒ‡å®šä¸€ä¸ªå­—ç¬¦ä¸²çš„ç´¢å¼•åç§°ã€‚å½“ç³»ç»Ÿéœ€è¦ Hibernate è‡ªåŠ¨å»ºè¡¨æ—¶, ç”¨äºä¸ºè¯¥å±æ€§æ‰€æ˜ å°„çš„æ•°æ®åˆ—åˆ›å»ºç´¢å¼•, ä»è€ŒåŠ å¿«è¯¥æ•°æ®åˆ—çš„æŸ¥è¯¢ã€‚</li>
<li>scaleï¼šæŒ‡å®šè¯¥å±æ€§æ‰€æ˜ å°„æ•°æ®åˆ—çš„å°æ•°ä½æ•°, å¯¹ double, float, decimal ç­‰ç±»å‹çš„æ•°æ®åˆ—æœ‰æ•ˆã€‚</li>
<li>formulaï¼šè®¾ç½®ä¸€ä¸ª SQL è¡¨è¾¾å¼, Hibernate å°†æ ¹æ®å®ƒæ¥è®¡ç®—å‡ºæ´¾ç”Ÿå±æ€§çš„å€¼ã€‚
<ul>
<li>æ´¾ç”Ÿå±æ€§ï¼šå¹¶ä¸æ˜¯æŒä¹…åŒ–ç±»çš„æ‰€æœ‰å±æ€§éƒ½ç›´æ¥å’Œè¡¨çš„å­—æ®µåŒ¹é…, æŒä¹…åŒ–ç±»çš„æœ‰äº›å±æ€§çš„å€¼å¿…é¡»åœ¨è¿è¡Œæ—¶é€šè¿‡è®¡ç®—æ‰èƒ½å¾—å‡ºæ¥ è¿™ç§ç§°ä¸ºæ´¾ç”Ÿå±æ€§
<ul>
<li><strong>ä½¿ç”¨ formula å±æ€§æ—¶</strong></li>
</ul>
</li>
<li>formula=â€œ(sql)â€ çš„è‹±æ–‡æ‹¬å·ä¸èƒ½å°‘</li>
<li>Sql è¡¨è¾¾å¼ä¸­çš„åˆ—åå’Œè¡¨åéƒ½åº”è¯¥å’Œæ•°æ®åº“å¯¹åº”, è€Œä¸æ˜¯å’ŒæŒä¹…åŒ–å¯¹è±¡çš„å±æ€§å¯¹åº”</li>
<li>å¦‚æœéœ€è¦åœ¨ formula å±æ€§ä¸­ä½¿ç”¨å‚æ•°, è¿™ç›´æ¥ä½¿ç”¨ where cur.id=id å½¢å¼</li>
<li>å…¶ä¸­ id å°±æ˜¯å‚æ•°, å’Œå½“å‰æŒä¹…åŒ–å¯¹è±¡çš„ id å±æ€§å¯¹åº”çš„åˆ—çš„ id å€¼å°†ä½œä¸ºå‚æ•°ä¼ å…¥</li>
</ul>
</li>
</ul>
<hr>
<h3 id="5-æ˜ å°„-java-çš„æ—¶é—´-æ—¥æœŸç±»å‹">5ã€æ˜ å°„ Java çš„æ—¶é—´, æ—¥æœŸç±»å‹</h3>
<p><strong>ä¸¤ä¸ªåŸºç¡€çŸ¥è¯†ï¼š</strong><br>
1ã€åœ¨ Java ä¸­, ä»£è¡¨æ—¶é—´å’Œæ—¥æœŸçš„ç±»å‹åŒ…æ‹¬ï¼š <code>java.util.Date</code> å’Œ <code>java.util.Calendar</code></p>
<ul>
<li>æ­¤å¤–, åœ¨ JDBC API ä¸­è¿˜æä¾›äº† 3 ä¸ªæ‰©å±•äº† java.util.Date ç±»çš„å­ç±»ï¼š</li>
<li>java.sql.Date</li>
<li>java.sql.Time</li>
<li>java.sql.Timestamp</li>
</ul>
<p>2ã€è¿™ä¸‰ä¸ªç±»åˆ†åˆ«å’Œæ ‡å‡† SQL ç±»å‹ä¸­çš„ DATE, TIME å’Œ TIMESTAMP ç±»å‹å¯¹åº”ã€‚</p>
<ul>
<li>æ‰€ä»¥ java.util.Date å¯ä»¥å¯¹åº”æ ‡å‡† SQL ç±»å‹ä¸­çš„ DATE, TIME å’Œ TIMESTAMP</li>
</ul>
<p><strong>åŸºäºä¸Šè¿°, æ‰€ä»¥åœ¨è®¾ç½®æŒä¹…åŒ–ç±»çš„ Date ç±»å‹æ˜¯, è®¾ç½®ä¸º java.util.Date</strong></p>
<hr>
<p><strong>å¦‚ä½•è¿›è¡Œæ˜ å°„</strong></p>
<p>åœ¨æ ‡å‡† SQL ä¸­, DATE ç±»å‹è¡¨ç¤ºæ—¥æœŸ, TIME ç±»å‹è¡¨ç¤ºæ—¶é—´, TIMESTAMP ç±»å‹è¡¨ç¤ºæ—¶é—´æˆ³, åŒæ—¶åŒ…å«æ—¥æœŸå’Œæ—¶é—´ä¿¡æ¯ã€‚</p>
<hr>
<img src="http://ww1.sinaimg.cn/large/006vWPzFly1g1mzx23jnmj30m2072wfr.jpg">
<p><strong>å¦‚ä½•æŠŠ java.util.Date æ˜ å°„ä¸º DATE, TIME å’Œ TIMESTAMPï¼Ÿ</strong></p>
<ul>
<li><strong>å¯ä»¥é€šè¿‡ property çš„ type å±æ€§æ¥è¿›è¡Œæ˜ å°„</strong></li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"date"</span> <span class="attr">type</span>=<span class="string">"timestamp"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">column</span> <span class="attr">name</span>=<span class="string">"DATE"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"date"</span> <span class="attr">type</span>=<span class="string">"data"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">column</span> <span class="attr">name</span>=<span class="string">"DATE"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"date"</span> <span class="attr">type</span>=<span class="string">"time"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">column</span> <span class="attr">name</span>=<span class="string">"DATE"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>å…¶ä¸­ timestamp, date, time æ—¢ä¸æ˜¯ Java ç±»å‹, ä¹Ÿä¸æ˜¯æ ‡å‡† SQL ç±»å‹, è€Œæ˜¯ hibernate æ˜ å°„ç±»å‹ã€‚</strong></p>
<hr>
<h3 id="7-java-å¤§å¯¹è±¡ç±»å‹çš„-hiberante-æ˜ å°„">7ã€Java å¤§å¯¹è±¡ç±»å‹çš„ Hiberante æ˜ å°„</h3>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- æ˜ å°„å¤§å¯¹è±¡ --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- è‹¥å¸Œæœ›ç²¾ç¡®æ˜ å°„ SQL ç±»å‹, å¯ä»¥ä½¿ç”¨ sql-type å±æ€§. --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"content"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">column</span> <span class="attr">name</span>=<span class="string">"CONTENT"</span> <span class="attr">sql-type</span>=<span class="string">"mediumtext"</span>&gt;</span><span class="tag">&lt;/<span class="name">column</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"image"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">column</span> <span class="attr">name</span>=<span class="string">"IMAGE"</span> <span class="attr">sql-type</span>=<span class="string">"mediumblob"</span>&gt;</span><span class="tag">&lt;/<span class="name">column</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>Mysql ä¸æ”¯æŒæ ‡å‡† SQL çš„ CLOB ç±»å‹, åœ¨ Mysql ä¸­, ç”¨ TEXT, MEDIUMTEXT åŠ LONGTEXT ç±»å‹æ¥è¡¨ç¤ºé•¿åº¦æ“ä½œ 255 çš„é•¿æ–‡æœ¬æ•°æ®</li>
<li>åœ¨æŒä¹…åŒ–ç±»ä¸­, äºŒè¿›åˆ¶å¤§å¯¹è±¡å¯ä»¥å£°æ˜ä¸º byte[] æˆ– java.sql.Blob ç±»å‹  å­—ç¬¦ä¸²å¯ä»¥å£°æ˜ä¸º java.lang.String æˆ– java.sql.Clob</li>
<li>å®é™…ä¸Šåœ¨ Java åº”ç”¨ç¨‹åºä¸­å¤„ç†é•¿åº¦è¶…è¿‡ 255 çš„å­—ç¬¦ä¸², ä½¿ç”¨ java.lang.String æ¯” java.sql.Clob æ›´æ–¹ä¾¿</li>
</ul>
<h3 id="8-æ˜ å°„ç»„æˆå…³ç³»-component">8ã€æ˜ å°„ç»„æˆå…³ç³» component</h3>
<p><strong>Hibernate æŠŠæŒä¹…åŒ–ç±»çš„å±æ€§åˆ†ä¸ºä¸¤ç§ï¼š</strong></p>
<ul>
<li>å€¼(value)ç±»å‹ï¼šæ²¡æœ‰ OID, ä¸èƒ½è¢«å•ç‹¬æŒä¹…åŒ–, ç”Ÿå‘½å‘¨æœŸä¾èµ–äºæ‰€å±æŒä¹…åŒ–ç±»çš„å¯¹è±¡ç”Ÿå‘½å‘¨æœŸã€‚</li>
<li>å®ä½“(entity)ç±»å‹ï¼šæœ‰ OID, å¯ä»¥è¢«å•ç‹¬æŒä¹…åŒ–, æœ‰ç‹¬ç«‹çš„ç”Ÿå‘½å‘¨æœŸã€‚</li>
</ul>
<p>æ˜¾ç„¶æ— æ³•ç›´æ¥ç”¨ property æ˜ å°„ POJO å±æ€§ã€‚<br>
Hibernate ä½¿ç”¨ <component> å…ƒç´ æ¥æ˜ å°„ç»„æˆå…³ç³», è¯¥å…ƒç´ è¡¨åå±æ€§æ˜¯å¦ä¸€ä¸ªç±»ä¸€ä¸ªç»„æˆéƒ¨åˆ†, åœ¨ Hibernate ä¸­ç§°ä¹‹ä¸ºç»„ä»¶ã€‚</component></p>
<ul>
<li>
<p><component> å…ƒç´ æ¥æ˜ å°„ç»„æˆå…³ç³»</component></p>
<ul>
<li>classï¼šè®¾å®šç»„æˆå…³ç³»å±æ€§çš„ç±»å‹, æ­¤å¤„è¡¨æ˜ pay å±æ€§ä¸º Pay ç±»å‹</li>
</ul>
</li>
<li>
<p><parent> å…ƒç´ æŒ‡å®šç»„ä»¶å±æ€§æ‰€å±çš„æ•´ä½“ç±»</parent></p>
<ul>
<li>nameï¼šæ•´ä½“ç±»åœ¨ç»„ä»¶ç±»ä¸­çš„å±æ€§å</li>
</ul>
</li>
</ul>
<hr>
<img src="https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1551442650328&di=78dfb03450cc5fff5d31ea92de81ba1f&imgtype=0&src=http%3A%2F%2Fimg.mp.itc.cn%2Fupload%2F20160719%2F6ea36d17d5e94124ad1791eadd923554_th.jpg" width="150">
<h2 id="ä¸ƒ-é€šè¿‡-hibernate-è°ƒç”¨å­˜å‚¨è¿‡ç¨‹">ä¸ƒã€é€šè¿‡ Hibernate è°ƒç”¨å­˜å‚¨è¿‡ç¨‹</h2>
<ul>
<li>Work æ¥å£ï¼šç›´æ¥é€šè¿‡ JDBC API æ¥è®¿é—®æ•°æ®åº“çš„æ“ä½œã€‚</li>
<li>Session çš„ doWork(Work) æ–¹æ³•ç”¨äºæ‰§è¡Œ Work å¯¹è±¡æŒ‡å®šçš„æ“ä½œ, å³è°ƒç”¨ Work å¯¹è±¡çš„ execute() æ–¹æ³•ã€‚</li>
<li>Session ä¼šæŠŠå½“å‰ä½¿ç”¨çš„æ•°æ®åº“è¿æ¥ä¼ é€’ç»™ execute() æ–¹æ³•ã€‚</li>
</ul>
<h2 id="å…«-hibernate-ä¸è§¦å‘å™¨ååŒå·¥ä½œ">å…«ã€Hibernate ä¸è§¦å‘å™¨ååŒå·¥ä½œ</h2>
<p><strong>Hibernate ä¸æ•°æ®åº“ä¸­çš„è§¦å‘å™¨ååŒå·¥ä½œæ—¶, ä¼šé€ æˆä¸¤ç±»é—®é¢˜ï¼š</strong></p>
<p>1ã€è§¦å‘å™¨ä½¿ Session çš„ç¼“å­˜ä¸­çš„æŒä¹…åŒ–å¯¹è±¡ä¸æ•°æ®åº“ä¸­å¯¹åº”çš„æ•°æ®ä¸ä¸€è‡´ï¼›<br>
2ã€è§¦å‘å™¨è¿è¡Œåœ¨æ•°æ®åº“ä¸­, å®ƒæ‰§è¡Œçš„æ“ä½œå¯¹ Session æ˜¯é€æ˜çš„<br>
Session çš„ update() æ–¹æ³•ç›²ç›®åœ°æ¿€å‘è§¦å‘å™¨ï¼šæ— è®ºæ¸¸ç¦»å¯¹è±¡çš„å±æ€§æ˜¯å¦å‘ç”Ÿå˜åŒ–, éƒ½ä¼šæ‰§è¡Œ update è¯­å¥, è€Œ update è¯­å¥ä¼šæ¿€å‘æ•°æ®åº“ä¸­ç›¸åº”çš„è§¦å‘å™¨</p>
<p>è§£å†³æ–¹æ¡ˆï¼š<br>
åœ¨æ‰§è¡Œå®Œ Session çš„ç›¸å…³æ“ä½œå, ç«‹å³è°ƒç”¨ Session çš„ flush() å’Œ refresh() æ–¹æ³•<br>
è¿«ä½¿ Session çš„ç¼“å­˜ä¸æ•°æ®åº“åŒæ­¥(refresh() æ–¹æ³•é‡æ–°ä»æ•°æ®åº“ä¸­åŠ è½½å¯¹è±¡)</p>
<img src="http://ww1.sinaimg.cn/large/006vWPzFly1g1ho92h9jkj30nr05f3ym.jpg" width="800">
<p>åœ¨æ˜ å°„æ–‡ä»¶çš„çš„ <class> å…ƒç´ ä¸­è®¾ç½® select-before-update å±æ€§ (å’Œè§¦å‘å™¨ååŒå·¥ä½œæ—¶è®¾ç½®)ï¼š<br>
å½“ Session çš„ update æˆ– saveOrUpdate() æ–¹æ³•æ›´æ–°ä¸€ä¸ªæ¸¸ç¦»å¯¹è±¡æ—¶, ä¼šå…ˆæ‰§è¡Œ Select è¯­å¥,<br>
è·å¾—å½“å‰æ¸¸ç¦»å¯¹è±¡åœ¨æ•°æ®åº“ä¸­çš„æœ€æ–°æ•°æ®, åªæœ‰åœ¨ä¸ä¸€è‡´çš„æƒ…å†µä¸‹æ‰ä¼šæ‰§è¡Œ update è¯­å¥</class></p>
<hr>
<img src="https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1551442650328&di=78dfb03450cc5fff5d31ea92de81ba1f&imgtype=0&src=http%3A%2F%2Fimg.mp.itc.cn%2Fupload%2F20160719%2F6ea36d17d5e94124ad1791eadd923554_th.jpg" width="150">
<h2 id="ä¹-æ˜ å°„ä¸€å¯¹å¤šå…³è”å…³ç³»">ä¹ã€æ˜ å°„ä¸€å¯¹å¤šå…³è”å…³ç³»</h2>
<ul>
<li>
<p><strong>åœ¨é¢†åŸŸæ¨¡å‹ä¸­, ç±»ä¸ç±»ä¹‹é—´æœ€æ™®éçš„å…³ç³»å°±æ˜¯å…³è”å…³ç³»ã€‚</strong></p>
</li>
<li>
<p>åœ¨ UML ä¸­, å…³è”æ˜¯æœ‰æ–¹å‘çš„ã€‚</p>
</li>
<li>
<p><strong>ä»¥ Customer å’Œ Order ä¸ºä¾‹ï¼š</strong></p>
<ul>
<li>ä¸€ä¸ªç”¨æˆ·èƒ½å‘å‡ºå¤šä¸ªè®¢å•, è€Œä¸€ä¸ªè®¢å•åªèƒ½å±äºä¸€ä¸ªå®¢æˆ·</li>
<li>ä» Order åˆ° Customer çš„å…³è”æ˜¯å¤šå¯¹ä¸€å…³è”</li>
<li>è€Œä» Customer åˆ° Order æ˜¯ä¸€å¯¹å¤šå…³è”</li>
</ul>
</li>
</ul>
<img src="http://ww1.sinaimg.cn/large/006vWPzFly1g1n27v7toxj30x70bewgg.jpg" width="600">
<hr>
<h3 id="1-å•å‘-n-1">1ã€å•å‘ N-1</h3>
<p><strong>å•å‘ N-1 å…³è”åªéœ€ä» N çš„ä¸€ç«¯å¯ä»¥è®¿é—® 1 çš„ä¸€ç«¯ã€‚</strong></p>
<p><strong>åŸŸæ¨¡å‹ï¼š</strong></p>
<ul>
<li><strong>ä» Order åˆ° Customerå¤šå¯¹ä¸€å•å‘å…³è”éœ€è¦åœ¨Order ç±»ä¸­å®šä¹‰ä¸€ä¸ª Customer å±æ€§</strong></li>
<li><strong>è€Œåœ¨ Customer ç±»ä¸­æ— éœ€å®šä¹‰å­˜æ”¾ Order å¯¹è±¡çš„é›†åˆå±æ€§</strong><br>
<img src="http://ww1.sinaimg.cn/large/006vWPzFly1g1n2elu60yj30gz057wf7.jpg" width="400"></li>
</ul>
<p><strong>å…³ç³»æ•°æ®æ¨¡å‹ï¼šORDERS è¡¨ä¸­çš„ CUSTOMER_ID å‚ç…§ CUSTOMER è¡¨çš„ä¸»é”®</strong><br>
<img src="http://ww1.sinaimg.cn/large/006vWPzFly1g1n2joeoetj30l40483z0.jpg" width="400"></p>
<ul>
<li><strong>æ˜¾ç„¶æ— æ³•ç›´æ¥ç”¨ property æ˜ å°„ customer å±æ€§</strong></li>
<li><strong>Hibernate ä½¿ç”¨ <code>&lt;many-to-one&gt;</code> å…ƒç´ æ¥æ˜ å°„å¤šå¯¹ä¸€å…³è”å…³ç³»</strong>
<ul>
<li><many-to-one> å…ƒç´ æ¥æ˜ å°„ç»„æˆå…³ç³»
<ul>
<li>nameï¼š è®¾å®šå¾…æ˜ å°„çš„æŒä¹…åŒ–ç±»çš„å±æ€§çš„åå­—</li>
<li>classï¼šè®¾å®šå¾…æ˜ å°„çš„æŒä¹…åŒ–ç±»çš„å±æ€§çš„ç±»å‹<br>
	* columnï¼š è®¾å®šå’ŒæŒä¹…åŒ–ç±»çš„å±æ€§å¯¹åº”çš„è¡¨çš„å¤–é”®<br>
<code>&lt;many-to-one name=&quot;customer&quot; class=&quot;Customer&quot; column=&quot;CUSTOMER_ID&quot;&gt;&lt;/many-to-one&gt;</code></li>
</ul>
</many-to-one></li>
</ul>
</li>
</ul>
<hr>
<p><strong>æ’å…¥</strong></p>
<ul>
<li>
<p>å…ˆæ’å…¥ 1 çš„ä¸€ç«¯, å†æ’å…¥ n çš„ä¸€ç«¯, åªæœ‰ INSERT è¯­å¥<br>
session.save(customer)ï¼›<br>
session.save(order1)ï¼›<br>
session.save(order2)ï¼›</p>
</li>
<li>
<p>å…ˆæ’å…¥ n çš„ä¸€ç«¯, å†æ’å…¥ 1 çš„ä¸€ç«¯, ä¼šå¤šå‡º UPDATE è¯­å¥<br>
session.save(order1)ï¼›<br>
session.save(order2)ï¼›	<br>
session.save(customer)ï¼›<br>
å› ä¸ºåœ¨æ’å…¥å¤šçš„ä¸€ç«¯æ—¶, æ— æ³•ç¡®å®š 1 çš„ä¸€ç«¯çš„å¤–é”®å€¼ã€‚æ‰€ä»¥åªèƒ½ç­‰ 1 çš„ä¸€ç«¯æ’å…¥å, å†é¢å¤–å‘é€ UPDATE è¯­å¥ã€‚</p>
</li>
</ul>
<p><strong>æ¨èå…ˆæ’å…¥ 1 çš„ä¸€ç«¯, åæ’å…¥ n çš„ä¸€ç«¯</strong></p>
<hr>
<p><strong>è·å–</strong></p>
<ul>
<li>è‹¥æŸ¥è¯¢å¤šçš„ä¸€ç«¯çš„ä¸€ä¸ªå¯¹è±¡, åˆ™é»˜è®¤æƒ…å†µä¸‹, åªæŸ¥è¯¢äº†å¤šçš„ä¸€ç«¯çš„å¯¹è±¡ã€‚ è€Œæ²¡æœ‰æŸ¥è¯¢å…³è”çš„çš„é‚£ä¸€ç«¯çš„å¯¹è±¡ï¼</li>
<li>åœ¨éœ€è¦ä½¿ç”¨åˆ°å…³è”çš„å¯¹è±¡æ—¶, æ‰å‘é€å¯¹åº”çš„ SQL è¯­å¥ æ‡’åŠ è½½ã€‚
<ul>
<li>åœ¨æŸ¥è¯¢ Customer å¯¹è±¡æ—¶, ç”±å¤šçš„ä¸€ç«¯å¯¼èˆªåˆ° 1 çš„ä¸€ç«¯æ—¶, è‹¥æ­¤æ—¶ session å·²è¢«å…³é—­, åˆ™é»˜è®¤æƒ…å†µä¸‹ ä¼šå‘ç”Ÿ LazyInitializationException å¼‚å¸¸</li>
</ul>
</li>
<li>è·å– Order å¯¹è±¡æ—¶, é»˜è®¤æƒ…å†µä¸‹, å…¶å…³è”çš„ Customer å¯¹è±¡æ˜¯ä¸€ä¸ªä»£ç†å¯¹è±¡ï¼</li>
</ul>
<hr>
<p><strong>åˆ é™¤</strong></p>
<ul>
<li><strong>åœ¨ä¸è®¾å®šçº§è”å…³ç³»çš„æƒ…å†µä¸‹, ä¸” 1 è¿™ä¸€ç«¯çš„å¯¹è±¡æœ‰ n çš„å¯¹è±¡åœ¨å¼•ç”¨, ä¸èƒ½ç›´æ¥åˆ é™¤ 1 è¿™ä¸€ç«¯å¯¹è±¡</strong></li>
</ul>
<hr>
<p><strong>æ›´æ–°</strong></p>
<ul>
<li>ä¸€åˆ‡æ­£å¸¸</li>
</ul>
<hr>
<h3 id="2-åŒå‘-1-n">2ã€åŒå‘ 1-N</h3>
<p><strong>åŒå‘ 1-N ä¸ åŒå‘ N-1 æ˜¯å®Œå…¨ç›¸åŒçš„ä¸¤ç§æƒ…å½¢</strong></p>
<ul>
<li>åŒå‘ 1-N éœ€è¦åœ¨ 1 çš„ä¸€ç«¯å¯ä»¥è®¿é—® N çš„ä¸€ç«¯, åä¹‹ä¾ç„¶ã€‚</li>
</ul>
<p><strong>åŸŸæ¨¡å‹ï¼š</strong></p>
<ul>
<li><strong>ä» Order åˆ° Customer çš„å¤šå¯¹ä¸€åŒå‘å…³è”éœ€è¦åœ¨Order ç±»ä¸­å®šä¹‰ä¸€ä¸ª Customer å±æ€§</strong></li>
<li><strong>è€Œåœ¨ Customer ç±»ä¸­éœ€å®šä¹‰å­˜æ”¾ Order å¯¹è±¡çš„é›†åˆå±æ€§</strong></li>
<li><strong>å£°æ˜é›†åˆç±»å‹æ—¶, éœ€ä½¿ç”¨æ¥å£ç±»å‹, å› ä¸º hibernate åœ¨è·å–é›†åˆç±»å‹æ—¶, è¿”å›çš„æ˜¯ Hibernate å†…ç½®çš„é›†åˆç±»å‹, è€Œä¸æ˜¯ JavaSE ä¸€ä¸ªæ ‡å‡†çš„é›†åˆå®ç°ã€‚</strong></li>
<li><strong>åœ¨å®šä¹‰é›†åˆå±æ€§æ—¶, é€šå¸¸æŠŠå®ƒåˆå§‹åŒ–ä¸ºé›†åˆå®ç°ç±»çš„ä¸€ä¸ªå®ä¾‹ã€‚</strong>
<ul>
<li><strong>è¿™æ ·å¯ä»¥æé«˜ç¨‹åºçš„å¥å£®æ€§, é¿å…åº”ç”¨ç¨‹åºè®¿é—®å–å€¼ä¸º null çš„é›†åˆçš„æ–¹æ³•æŠ›å‡º NullPointerException</strong></li>
</ul>
</li>
</ul>
<img src="http://ww1.sinaimg.cn/large/006vWPzFly1g1n2zte4boj30fq04eq3m.jpg" width="400">
<p><strong>å…³ç³»æ•°æ®æ¨¡å‹ï¼šORDERS è¡¨ä¸­çš„ CUSTOMER_ID å‚ç…§ CUSTOMER è¡¨çš„ä¸»é”®ã€‚</strong><br>
<img src="http://ww1.sinaimg.cn/large/006vWPzFly1g1n30ziwvdj30lu04hjrw.jpg" width="400"></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- æ˜ å°„ ä¸€å¯¹å¤šçš„é›†åˆå±æ€§ --&gt;</span></span><br><span class="line">setï¼š æ˜ å°„ set ç±»å‹çš„å±æ€§</span><br><span class="line">nameï¼š è®¾å®šå¾…æ˜ å°„çš„æŒä¹…åŒ–ç±»çš„å±æ€§çš„ã€‚</span><br><span class="line">tableï¼š set ä¸­çš„å…ƒç´ å¯¹åº”çš„è®°å½•æ”¾åœ¨å“ªä¸€ä¸ªæ•°æ®è¡¨ä¸­ã€‚ è¯¥å€¼éœ€è¦å’Œå¤šå¯¹ä¸€çš„ å¤š çš„é‚£ä¸ªè¡¨çš„åå­—ä¸€è‡´ã€‚</span><br><span class="line">inverseï¼š æŒ‡å®šç”±å“ªä¸€æ–¹æ¥ç»´æŠ¤å…³è”å…³ç³»ã€‚é€šå¸¸è®¾ç½®ä¸º true, æ¥ä½¿ 1 çš„ä¸€ç«¯æ”¾å¼ƒç»´æŠ¤å…³è”å…³ç³» ä»¥æŒ‡å®šç”±å¤šçš„ä¸€ç«¯æ¥ç»´æŠ¤å…³è”å…³ç³»ã€‚</span><br><span class="line">cascadeï¼š è®¾å®šçº§è”æ“ä½œã€‚å¼€å‘æ—¶ä¸å»ºè®®è®¾å®šè¯¥å±æ€§ã€‚å»ºè®®ä½¿ç”¨æ‰‹å·¥çš„æ–¹å¼æ¥å¤„ç†ã€‚</span><br><span class="line">order-byï¼š åœ¨æŸ¥è¯¢æ—¶å¯¹é›†åˆä¸­çš„å…ƒç´ è¿›è¡Œæ’åº, order-by ä¸­ä½¿ç”¨çš„æ˜¯è¡¨çš„å­—æ®µå, è€Œä¸æ˜¯æŒä¹…åŒ–ç±»çš„å±æ€§åã€‚</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">set</span> <span class="attr">name</span>=<span class="string">"orders"</span> <span class="attr">table</span>=<span class="string">"ORDERS"</span> <span class="attr">inverse</span>=<span class="string">"true"</span> <span class="attr">order-by</span>=<span class="string">"ORDER_NAME DESC"</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- æ‰§è¡Œå¤šçš„è¡¨ä¸­çš„å¤–é”®åˆ—çš„åå­— --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">key</span> <span class="attr">column</span>=<span class="string">"CUSTOMER_ID"</span>&gt;</span><span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- æŒ‡å®šå…³è”çš„æŒä¹…åŒ–ç±»çš„ç±»å æ˜ å°„ç±»å‹ --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">one-to-many</span> <span class="attr">class</span>=<span class="string">"Order"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>&lt;set&gt; å…ƒç´ çš„ inverse å±æ€§</strong></p>
<ul>
<li>åœ¨hibernateä¸­é€šè¿‡å¯¹ inverse å±æ€§çš„æ¥å†³å®šæ˜¯ç”±åŒå‘å…³è”çš„å“ªä¸€æ–¹æ¥ç»´æŠ¤è¡¨å’Œè¡¨ä¹‹é—´çš„å…³ç³»ã€‚
<ul>
<li>inverse = false çš„ä¸ºä¸»åŠ¨æ–¹ç»´æŠ¤å…³è”å…³ç³»ï¼Œinverse = true çš„ä¸ºè¢«åŠ¨æ–¹ç»´æŠ¤å…³è”å…³ç³»</li>
</ul>
</li>
<li>åœ¨ 1-N å…³ç³»ä¸­ï¼Œå°† n æ–¹è®¾ä¸ºä¸»æ§æ–¹å°†æœ‰åŠ©äºæ€§èƒ½æ”¹å–„
<ul>
<li>(å¦‚æœè¦å›½å®¶å…ƒé¦–è®°ä½å…¨å›½äººæ°‘çš„åå­—ï¼Œä¸æ˜¯å¤ªå¯èƒ½ï¼Œä½†è¦è®©å…¨å›½äººæ°‘çŸ¥é“å›½å®¶å…ƒé¦–ï¼Œå°±å®¹æ˜“çš„å¤š)</li>
</ul>
</li>
<li>åœ¨ 1-N å…³ç³»ä¸­ï¼Œè‹¥å°† 1 æ–¹è®¾ä¸ºä¸»æ§æ–¹
<ul>
<li>ä¼šé¢å¤–å¤šå‡º update è¯­å¥ æ’å…¥æ•°æ®æ—¶æ— æ³•åŒæ—¶æ’å…¥å¤–é”®åˆ—ï¼Œå› è€Œæ— æ³•ä¸ºå¤–é”®åˆ—æ·»åŠ éç©ºçº¦æŸ</li>
</ul>
</li>
</ul>
<hr>
<p><strong>æ’å…¥</strong></p>
<p>order1.setCustomer(customer)ï¼›<br>
order2.setCustomer(customer)ï¼›<br>
customer.getOrders().add(order1)ï¼›<br>
customer.getOrders().add(order2)ï¼›</p>
<ul>
<li>æ‰§è¡Œsave æ“ä½œï¼š å…ˆæ’å…¥ Customer, å†æ’å…¥ Order, ä¼šå¤šå‡º UPDATE è¯­å¥</li>
<li>å› ä¸º 1 çš„ä¸€ç«¯å’Œ n çš„ä¸€ç«¯éƒ½ç»´æŠ¤å…³è”å…³ç³»ã€‚æ‰€ä»¥ä¼šå¤šå‡º UPDATE</li>
</ul>
<p><strong>å»ºè®®è®¾å®š set çš„ inverse=true, ä½¿ 1 æ”¾å¼ƒç»´æŠ¤å…³ç³»ã€‚å»ºè®®å…ˆæ’å…¥ 1 çš„ä¸€ç«¯, åæ’å…¥å¤šçš„ä¸€ç«¯</strong></p>
<hr>
<p><strong>è·å–</strong></p>
<ul>
<li>è‹¥æŸ¥è¯¢å¤šçš„ä¸€ç«¯çš„ä¸€ä¸ªå¯¹è±¡, åˆ™é»˜è®¤æƒ…å†µä¸‹, åªæŸ¥è¯¢äº†å¤šçš„ä¸€ç«¯çš„å¯¹è±¡ã€‚ è€Œæ²¡æœ‰æŸ¥è¯¢å…³è”çš„çš„é‚£ä¸€ç«¯çš„å¯¹è±¡ï¼</li>
<li>åœ¨éœ€è¦ä½¿ç”¨åˆ°å…³è”çš„å¯¹è±¡æ—¶, æ‰å‘é€å¯¹åº”çš„ SQL è¯­å¥ æ‡’åŠ è½½ã€‚
<ul>
<li>åœ¨éœ€è¦ä½¿ç”¨é›†åˆä¸­å…ƒç´ çš„æ—¶å€™è¿›è¡Œåˆå§‹åŒ–ã€‚</li>
<li>è‹¥æ­¤æ—¶ session å·²è¢«å…³é—­ ä¼šå‘ç”Ÿ LazyInitializationException å¼‚å¸¸ã€‚</li>
</ul>
</li>
</ul>
<hr>
<p><strong>åˆ é™¤</strong></p>
<ul>
<li><strong>åœ¨ä¸è®¾å®šçº§è”å…³ç³»çš„æƒ…å†µä¸‹, ä¸” 1 è¿™ç«¯çš„å¯¹è±¡æœ‰ n çš„å¯¹è±¡åœ¨å¼•ç”¨, ä¸èƒ½ç›´æ¥åˆ é™¤ 1 è¿™ä¸€ç«¯çš„å¯¹è±¡</strong></li>
</ul>
<hr>
<p><strong>æ›´æ–°</strong></p>
<ul>
<li>ä¸€åˆ‡æ­£å¸¸</li>
</ul>
<hr>
<h2 id="æ˜ å°„ä¸€å¯¹ä¸€å…³è”å…³ç³»">æ˜ å°„ä¸€å¯¹ä¸€å…³è”å…³ç³»</h2>
<p><strong>åŸŸæ¨¡å‹ï¼š</strong><br>
<img src="http://ww1.sinaimg.cn/large/006vWPzFly1g1n5s0ctr9j30j5066ab7.jpg" width="500"></p>
<hr>
<img src="http://ww1.sinaimg.cn/large/006vWPzFly1g1n5x3xny5j30i4080q3u.jpg" width="600">
<hr>
<p><strong>åŸºäºå¤–é”®æ˜ å°„çš„ 1-1 å…³è”</strong></p>
<ul>
<li><strong>å…¶å¤–é”®å¯ä»¥å­˜æ”¾åœ¨ä»»æ„ä¸€è¾¹ï¼Œåœ¨éœ€è¦å­˜æ”¾å¤–é”®ä¸€ç«¯ï¼Œå¢åŠ many-to-oneå…ƒç´ ã€‚ä¸ºmany-to-oneå…ƒç´ å¢åŠ unique=â€œtrueâ€å±æ€§æ¥è¡¨ç¤ºä¸º1-1å…³è”ã€‚</strong></li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- ä½¿ç”¨ many-to-one çš„æ–¹å¼æ¥æ˜ å°„ 1-1 å…³è”å…³ç³» --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">many-to-one</span> <span class="attr">name</span>=<span class="string">"mgr"</span> <span class="attr">class</span>=<span class="string">"Manager"</span> <span class="attr">column</span>=<span class="string">"MGR_ID"</span> <span class="attr">unique</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">many-to-one</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- æ˜ å°„ 1-1 çš„å…³è”å…³ç³»ï¼š åœ¨å¯¹åº”çš„æ•°æ®è¡¨ä¸­å·²ç»æœ‰å¤–é”®äº†, å½“å‰æŒä¹…åŒ–ç±»ä½¿ç”¨ one-to-one è¿›è¡Œæ˜ å°„ --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- æ²¡æœ‰å¤–é”®çš„ä¸€ç«¯éœ€è¦ä½¿ç”¨one-to-oneå…ƒç´ ï¼Œè¯¥å…ƒç´ ä½¿ç”¨ property-ref å±æ€§æŒ‡å®šä½¿ç”¨è¢«å…³è”å®ä½“ä¸»é”®ä»¥å¤–çš„å­—æ®µä½œä¸ºå…³è”å­—æ®µ--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">one-to-one</span> <span class="attr">name</span>=<span class="string">"dept"</span> <span class="attr">class</span>=<span class="string">"Department"</span> <span class="attr">property-ref</span>=<span class="string">"mgr"</span>&gt;</span><span class="tag">&lt;/<span class="name">one-to-one</span>&gt;</span></span><br></pre></td></tr></table></figure>
<hr>
<p><strong>åŸºäºä¸»é”®æ˜ å°„çš„ 1-1 å…³è”</strong></p>
<p><strong>åŸºäºä¸»é”®çš„æ˜ å°„ç­–ç•¥ï¼š</strong></p>
<ul>
<li>æŒ‡ä¸€ç«¯çš„ä¸»é”®ç”Ÿæˆå™¨ä½¿ç”¨ foreign ç­–ç•¥,è¡¨æ˜æ ¹æ®â€å¯¹æ–¹â€çš„ä¸»é”®æ¥ç”Ÿæˆè‡ªå·±çš„ä¸»é”®ï¼Œè‡ªå·±å¹¶ä¸èƒ½ç‹¬ç«‹ç”Ÿæˆä¸»é”®ã€‚</li>
<li>&lt;param&gt; å­å…ƒç´ æŒ‡å®šä½¿ç”¨å½“å‰æŒä¹…åŒ–ç±»çš„å“ªä¸ªå±æ€§ä½œä¸º â€œå¯¹æ–¹â€</li>
</ul>
<p><strong>é‡‡ç”¨foreignä¸»é”®ç”Ÿæˆå™¨ç­–ç•¥çš„ä¸€ç«¯å¢åŠ  one-to-one å…ƒç´ æ˜ å°„å…³è”å±æ€§ï¼Œå…¶one-to-oneå±æ€§è¿˜åº”å¢åŠ  constrained=â€œtrueâ€ å±æ€§ï¼›</strong></p>
<ul>
<li>
<p>å¦ä¸€ç«¯å¢åŠ one-to-oneå…ƒç´ æ˜ å°„å…³è”å±æ€§ã€‚</p>
</li>
<li>
<p>constrained(çº¦æŸ)ï¼šæŒ‡å®šä¸ºå½“å‰æŒä¹…åŒ–ç±»å¯¹åº”çš„æ•°æ®åº“è¡¨çš„ä¸»é”®æ·»åŠ ä¸€ä¸ªå¤–é”®çº¦æŸï¼Œå¼•ç”¨è¢«å…³è”çš„å¯¹è±¡(â€œå¯¹æ–¹â€)æ‰€å¯¹åº”çš„æ•°æ®åº“è¡¨ä¸»é”®</p>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">"deptId"</span> <span class="attr">type</span>=<span class="string">"java.lang.Integer"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">column</span> <span class="attr">name</span>=<span class="string">"DEPT_ID"</span> /&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- ä½¿ç”¨å¤–é”®çš„æ–¹å¼æ¥ç”Ÿæˆå½“å‰çš„ä¸»é”® --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">"foreign"</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- property å±æ€§æŒ‡å®šä½¿ç”¨å½“å‰æŒä¹…åŒ–ç±»çš„å“ªä¸€ä¸ªå±æ€§çš„ä¸»é”®ä½œä¸ºå¤–é”® --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"property"</span>&gt;</span>mgr<span class="tag">&lt;/<span class="name">param</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">generator</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">one-to-one</span> <span class="attr">name</span>=<span class="string">"mgr"</span> <span class="attr">class</span>=<span class="string">"Manager"</span> <span class="attr">constrained</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">one-to-one</span>&gt;</span></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="æ˜ å°„å¤šå¯¹å¤šå…³è”å…³ç³»">æ˜ å°„å¤šå¯¹å¤šå…³è”å…³ç³»</h2>
<p><strong>å•å‘ n-n</strong><br>
<img src="http://ww1.sinaimg.cn/large/006vWPzFly1g1n6m4qmvyj30ug0i9gnx.jpg" width="500"></p>
<p><strong>n-n çš„å…³è”å¿…é¡»ä½¿ç”¨è¿æ¥è¡¨</strong></p>
<ul>
<li>ä¸ 1-n æ˜ å°„ç±»ä¼¼ï¼Œå¿…é¡»ä¸º set é›†åˆå…ƒç´ æ·»åŠ  key å­å…ƒç´ ï¼ŒæŒ‡å®š CATEGORIES_ITEMS è¡¨ä¸­å‚ç…§ CATEGORIES è¡¨çš„å¤–é”®ä¸º CATEGORIY_IDã€‚</li>
<li>ä¸ 1-n å…³è”æ˜ å°„ä¸åŒçš„æ˜¯ï¼Œå»ºç«‹ n-n å…³è”æ—¶, é›†åˆä¸­çš„å…ƒç´ ä½¿ç”¨ many-to-manyã€‚</li>
<li>many-to-many å­å…ƒç´ çš„ class å±æ€§æŒ‡å®š items é›†åˆä¸­å­˜æ”¾çš„æ˜¯ Item å¯¹è±¡</li>
<li>column å±æ€§æŒ‡å®š  CATEGORIES_ITEMS è¡¨ä¸­å‚ç…§ ITEMS è¡¨çš„å¤–é”®ä¸º ITEM_ID</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- table: æŒ‡å®šä¸­é—´è¡¨ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">class</span> <span class="attr">name</span>=<span class="string">"Category"</span> <span class="attr">table</span>=<span class="string">"CATEGORIES"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">set</span> <span class="attr">name</span>=<span class="string">"items"</span> <span class="attr">table</span>=<span class="string">"CATEGORIES_ITEMS"</span>&gt;</span></span><br><span class="line">	    <span class="tag">&lt;<span class="name">key</span>&gt;</span></span><br><span class="line">	        <span class="tag">&lt;<span class="name">column</span> <span class="attr">name</span>=<span class="string">"C_ID"</span> /&gt;</span></span><br><span class="line">	    <span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">	    <span class="comment">&lt;!-- ä½¿ç”¨ many-to-many æŒ‡å®šå¤šå¯¹å¤šçš„å…³è”å…³ç³». column æ‰§è¡Œ Set é›†åˆä¸­çš„æŒä¹…åŒ–ç±»åœ¨ä¸­é—´è¡¨çš„å¤–é”®åˆ—çš„åç§°  --&gt;</span></span><br><span class="line">	    <span class="tag">&lt;<span class="name">many-to-many</span> <span class="attr">class</span>=<span class="string">"Item"</span> <span class="attr">column</span>=<span class="string">"I_ID"</span>&gt;</span><span class="tag">&lt;/<span class="name">many-to-many</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">class</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">class</span> <span class="attr">name</span>=<span class="string">"hibernate.n2n.Item"</span> <span class="attr">table</span>=<span class="string">"ITEMS"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">set</span> <span class="attr">name</span>=<span class="string">"categories"</span> <span class="attr">table</span>=<span class="string">"CATEGORIES_ITEMS"</span> <span class="attr">inverse</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">key</span> <span class="attr">column</span>=<span class="string">"I_ID"</span>&gt;</span><span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">many-to-many</span> <span class="attr">class</span>=<span class="string">"hibernate.n2n.Category"</span> <span class="attr">column</span>=<span class="string">"C_ID"</span>&gt;</span><span class="tag">&lt;/<span class="name">many-to-many</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">class</span>&gt;</span></span><br></pre></td></tr></table></figure>
<hr>
<p><strong>åŒå‘ n-n</strong></p>
<img src="http://ww1.sinaimg.cn/large/006vWPzFly1g1n72ggp8ij30uv0ismzk.jpg" width="600">
<p><strong>åŒå‘ n-n å…³è”éœ€è¦ä¸¤ç«¯éƒ½ä½¿ç”¨é›†åˆå±æ€§</strong><br>
<strong>åŒå‘n-nå…³è”å¿…é¡»ä½¿ç”¨è¿æ¥è¡¨</strong></p>
<ul>
<li>é›†åˆå±æ€§åº”å¢åŠ  key å­å…ƒç´ ç”¨ä»¥æ˜ å°„å¤–é”®åˆ—, é›†åˆå…ƒç´ é‡Œè¿˜åº”å¢åŠ many-to-manyå­å…ƒç´ å…³è”å®ä½“ç±»ã€‚</li>
<li>åœ¨åŒå‘ n-n å…³è”çš„ä¸¤è¾¹éƒ½éœ€æŒ‡å®šè¿æ¥è¡¨çš„è¡¨ååŠå¤–é”®åˆ—çš„åˆ—åã€‚ä¸¤ä¸ªé›†åˆå…ƒç´  set çš„ table å…ƒç´ çš„å€¼å¿…é¡»æŒ‡å®šï¼Œè€Œä¸”å¿…é¡»ç›¸åŒã€‚
<ul>
<li>setå…ƒç´ çš„ä¸¤ä¸ªå­å…ƒç´ ï¼škey å’Œ many-to-many éƒ½å¿…é¡»æŒ‡å®š column å±æ€§ï¼Œå…¶ä¸­ï¼Œ</li>
<li>key å’Œ many-to-many åˆ†åˆ«æŒ‡å®šæœ¬æŒä¹…åŒ–ç±»å’Œå…³è”ç±»åœ¨è¿æ¥è¡¨ä¸­çš„å¤–é”®åˆ—åï¼Œå› æ­¤ä¸¤è¾¹çš„ key ä¸ many-to-many çš„columnå±æ€§äº¤å‰ç›¸åŒã€‚</li>
<li>ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€è¾¹çš„setå…ƒç´ çš„keyçš„ cloumnå€¼ä¸ºa,many-to-many çš„ column ä¸ºbï¼›</li>
<li>åˆ™å¦ä¸€è¾¹çš„ set å…ƒç´ çš„ key çš„ column å€¼ b,many-to-manyçš„ column å€¼ä¸º a.</li>
</ul>
</li>
</ul>
<p><strong>å¯¹äºåŒå‘ n-n å…³è”, å¿…é¡»æŠŠå…¶ä¸­ä¸€ç«¯çš„ inverse è®¾ç½®ä¸º true, å¦åˆ™ä¸¤ç«¯éƒ½ç»´æŠ¤å…³è”å…³ç³»å¯èƒ½ä¼šé€ æˆä¸»é”®å†²çªã€‚</strong></p>
<h1 id="æ„Ÿè°¢é˜…è¯»">æ„Ÿè°¢é˜…è¯»</h1>

                

                <hr>
                <!-- Pager -->
                <ul class="pager">
                    
                        <li class="previous">
                            <a href="/article/SpringMVC/" data-toggle="tooltip" data-placement="top" title="SpringMVC">&larr; Previous Post</a>
                        </li>
                    
                    
                        <li class="next">
                            <a href="/article/Spring/" data-toggle="tooltip" data-placement="top" title="Spring">Next Post &rarr;</a>
                        </li>
                    
                </ul>

                <br>

                <!--æ‰“èµ-->
                
                    <div class="reward">
                        <div class="reward-button">èµ <span class="reward-code"> 
                            <span class="alipay-code"> <img class="alipay-img" src="http://ww1.sinaimg.cn/large/006vWPzFly1g0o77ru34uj30dz0drdhv.jpg"><b>æ”¯ä»˜å®æ‰“èµ</b></span> 
                            <span class="wechat-code"> <img class="wechat-img" src="http://ww1.sinaimg.cn/large/006vWPzFly1g0o740lhb9j30rb0ov77z.jpg"><b>å¾®ä¿¡æ‰“èµ</b> </span>
                            </span></div>
                        <p class="reward-notice">èµèµä¸€ä¸‹</p>
                    </div>
                
                <!--æ‰“èµ-->

                <br>
                <!--åˆ†äº«-->
                
                <!--åˆ†äº«-->
                <br>                       
                
                <!-- require APlayer -->
                

                <!-- duoshuo Share start -->
                
                <!-- å¤šè¯´ Share end-->

                <!-- å¤šè¯´è¯„è®ºæ¡† start -->
                
                <!-- å¤šè¯´è¯„è®ºæ¡† end -->

                <!-- disqus comment start -->
                
                <!-- disqus comment end -->

                

            </div>
            
            <!-- Tabe of Content -->
            <!-- Table of Contents -->

  
    <style>
      span.toc-nav-number{
        display: none
      }
    </style>
  
    
      <aside id="sidebar">
        <div id="toc" class="toc-article">
        <strong class="toc-title">Contents</strong>
        
          <ol class="toc-nav"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#ä¸€-æŒä¹…åŒ–æ¡†æ¶"><span class="toc-nav-number">1.</span> <span class="toc-nav-text">&#x4E00;&#x3001;&#x6301;&#x4E45;&#x5316;&#x6846;&#x67B6;</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#ormçš„æ€æƒ³"><span class="toc-nav-number">1.1.</span> <span class="toc-nav-text">ORM&#x7684;&#x601D;&#x60F3;</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#äºŒ-hibernate-é…ç½®æ–‡ä»¶"><span class="toc-nav-number">2.</span> <span class="toc-nav-text">&#x4E8C;&#x3001;Hibernate &#x914D;&#x7F6E;&#x6587;&#x4EF6;</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#1-åˆ›å»º-hibernatecfgxml"><span class="toc-nav-number">2.1.</span> <span class="toc-nav-text">1&#x3001;&#x521B;&#x5EFA; hibernate.cfg.xml</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#2-åˆ›å»ºæŒä¹…åŒ–-java-ç±»"><span class="toc-nav-number">2.2.</span> <span class="toc-nav-text">2&#x3001;&#x521B;&#x5EFA;&#x6301;&#x4E45;&#x5316; Java &#x7C7B;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#3-åˆ›å»ºå¯¹è±¡-å…³ç³»æ˜ å°„æ–‡ä»¶"><span class="toc-nav-number">2.3.</span> <span class="toc-nav-text">3&#x3001;&#x521B;&#x5EFA;&#x5BF9;&#x8C61;-&#x5173;&#x7CFB;&#x6620;&#x5C04;&#x6587;&#x4EF6;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#4-æµ‹è¯•"><span class="toc-nav-number">2.4.</span> <span class="toc-nav-text">4&#x3001;&#x6D4B;&#x8BD5;</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#ä¸‰-hibernate-å±æ€§"><span class="toc-nav-number">3.</span> <span class="toc-nav-text">&#x4E09;&#x3001;Hibernate &#x5C5E;&#x6027;</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#1-configuration-ç±»"><span class="toc-nav-number">3.1.</span> <span class="toc-nav-text">1&#x3001;Configuration &#x7C7B;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#2-sessionfactory-æ¥å£"><span class="toc-nav-number">3.2.</span> <span class="toc-nav-text">2&#x3001;SessionFactory &#x63A5;&#x53E3;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#3-session-æ¥å£"><span class="toc-nav-number">3.3.</span> <span class="toc-nav-text">3&#x3001;Session (&#x63A5;&#x53E3;)</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#4-transactionäº‹åŠ¡"><span class="toc-nav-number">3.4.</span> <span class="toc-nav-text">4&#x3001;Transaction(&#x4E8B;&#x52A1;)</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#å››-hibernate-é…ç½®æ–‡ä»¶çš„é…ç½®é¡¹"><span class="toc-nav-number">4.</span> <span class="toc-nav-text">&#x56DB;&#x3001;Hibernate &#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x7684;&#x914D;&#x7F6E;&#x9879;</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#1-hbm2ddlauto"><span class="toc-nav-number">4.1.</span> <span class="toc-nav-text">1&#x3001;hbm2ddl.auto</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#2-format_sql"><span class="toc-nav-number">4.2.</span> <span class="toc-nav-text">2&#x3001;format_sql</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#3-åœ¨-hibernate-ä¸­è®¾ç½®éš”ç¦»çº§åˆ«"><span class="toc-nav-number">4.3.</span> <span class="toc-nav-text">3&#x3001;&#x5728; Hibernate &#x4E2D;&#x8BBE;&#x7F6E;&#x9694;&#x79BB;&#x7EA7;&#x522B;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#4-åœ¨-hibernate-ä¸­ä½¿ç”¨-c3p0-æ•°æ®æº"><span class="toc-nav-number">4.4.</span> <span class="toc-nav-text">4&#x3001;&#x5728; hibernate &#x4E2D;&#x4F7F;&#x7528; C3P0 &#x6570;&#x636E;&#x6E90;</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#äº”-é€šè¿‡-session-æ“çºµå¯¹è±¡"><span class="toc-nav-number">5.</span> <span class="toc-nav-text">&#x4E94;&#x3001;&#x901A;&#x8FC7; Session &#x64CD;&#x7EB5;&#x5BF9;&#x8C61;</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#1-æŒä¹…åŒ–å¯¹è±¡-æ‰˜ç®¡-persist"><span class="toc-nav-number">5.1.</span> <span class="toc-nav-text">1&#x3001;&#x6301;&#x4E45;&#x5316;&#x5BF9;&#x8C61; ( &#x6258;&#x7BA1; ) &#xFF08;Persist&#xFF09;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#2-ä¸´æ—¶å¯¹è±¡transient"><span class="toc-nav-number">5.2.</span> <span class="toc-nav-text">2&#x3001;&#x4E34;&#x65F6;&#x5BF9;&#x8C61;&#xFF08;Transient&#xFF09;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#3-æ¸¸ç¦»å¯¹è±¡ä¹Ÿå«-è„±ç®¡detached"><span class="toc-nav-number">5.3.</span> <span class="toc-nav-text">3&#x3001;&#x6E38;&#x79BB;&#x5BF9;&#x8C61;(&#x4E5F;&#x53EB; &#x8131;&#x7BA1;&#xFF09;&#xFF08;Detached&#xFF09;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#4-åˆ é™¤å¯¹è±¡removed"><span class="toc-nav-number">5.4.</span> <span class="toc-nav-text">4&#x3001;&#x5220;&#x9664;&#x5BF9;&#x8C61;(Removed)</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#å¯¹è±¡çš„çŠ¶æ€è½¬æ¢å›¾"><span class="toc-nav-number">5.5.</span> <span class="toc-nav-text">&#x1F449;&#x5BF9;&#x8C61;&#x7684;&#x72B6;&#x6001;&#x8F6C;&#x6362;&#x56FE;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#session-çš„-save-æ–¹æ³•"><span class="toc-nav-number">5.6.</span> <span class="toc-nav-text">Session &#x7684; save() &#x65B9;&#x6CD5;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#session-çš„-get-å’Œ-load-æ–¹æ³•"><span class="toc-nav-number">5.7.</span> <span class="toc-nav-text">Session &#x7684; get() &#x548C; load() &#x65B9;&#x6CD5;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#session-çš„-update-æ–¹æ³•"><span class="toc-nav-number">5.8.</span> <span class="toc-nav-text">Session &#x7684; update() &#x65B9;&#x6CD5;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#session-çš„-saveorupdate-æ–¹æ³•"><span class="toc-nav-number">5.9.</span> <span class="toc-nav-text">Session &#x7684; saveOrUpdate() &#x65B9;&#x6CD5;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#session-çš„-merge-æ–¹æ³•"><span class="toc-nav-number">5.10.</span> <span class="toc-nav-text">Session &#x7684; merge() &#x65B9;&#x6CD5;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#session-çš„-delete-æ–¹æ³•"><span class="toc-nav-number">5.11.</span> <span class="toc-nav-text">Session &#x7684; delete() &#x65B9;&#x6CD5;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#session-çš„-evict-æ–¹æ³•"><span class="toc-nav-number">5.12.</span> <span class="toc-nav-text">Session &#x7684; Evict() &#x65B9;&#x6CD5;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#session-çš„-refresh-æ–¹æ³•"><span class="toc-nav-number">5.13.</span> <span class="toc-nav-text">Session &#x7684; refresh() &#x65B9;&#x6CD5;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#session-çš„-clear-æ–¹æ³•"><span class="toc-nav-number">5.14.</span> <span class="toc-nav-text">Session &#x7684; clear() &#x65B9;&#x6CD5;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#session-ç¼“å­˜"><span class="toc-nav-number">5.15.</span> <span class="toc-nav-text">Session &#x7F13;&#x5B58;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#flush-ç¼“å­˜"><span class="toc-nav-number">5.16.</span> <span class="toc-nav-text">flush &#x7F13;&#x5B58;</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#å…­-å¯¹è±¡å…³ç³»æ˜ å°„æ–‡ä»¶"><span class="toc-nav-number">6.</span> <span class="toc-nav-text">&#x516D;&#x3001;&#x5BF9;&#x8C61;&#x5173;&#x7CFB;&#x6620;&#x5C04;&#x6587;&#x4EF6;</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#1-hibernate-mapping"><span class="toc-nav-number">6.1.</span> <span class="toc-nav-text">1&#x3001;hibernate-mapping</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#2-class"><span class="toc-nav-number">6.2.</span> <span class="toc-nav-text">2&#x3001;class</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#3-id"><span class="toc-nav-number">6.3.</span> <span class="toc-nav-text">3&#x3001;id</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#4-property"><span class="toc-nav-number">6.4.</span> <span class="toc-nav-text">4&#x3001;Property</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#5-æ˜ å°„-java-çš„æ—¶é—´-æ—¥æœŸç±»å‹"><span class="toc-nav-number">6.5.</span> <span class="toc-nav-text">5&#x3001;&#x6620;&#x5C04; Java &#x7684;&#x65F6;&#x95F4;, &#x65E5;&#x671F;&#x7C7B;&#x578B;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#7-java-å¤§å¯¹è±¡ç±»å‹çš„-hiberante-æ˜ å°„"><span class="toc-nav-number">6.6.</span> <span class="toc-nav-text">7&#x3001;Java &#x5927;&#x5BF9;&#x8C61;&#x7C7B;&#x578B;&#x7684; Hiberante &#x6620;&#x5C04;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#8-æ˜ å°„ç»„æˆå…³ç³»-component"><span class="toc-nav-number">6.7.</span> <span class="toc-nav-text">8&#x3001;&#x6620;&#x5C04;&#x7EC4;&#x6210;&#x5173;&#x7CFB; component</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#ä¸ƒ-é€šè¿‡-hibernate-è°ƒç”¨å­˜å‚¨è¿‡ç¨‹"><span class="toc-nav-number">7.</span> <span class="toc-nav-text">&#x4E03;&#x3001;&#x901A;&#x8FC7; Hibernate &#x8C03;&#x7528;&#x5B58;&#x50A8;&#x8FC7;&#x7A0B;</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#å…«-hibernate-ä¸è§¦å‘å™¨ååŒå·¥ä½œ"><span class="toc-nav-number">8.</span> <span class="toc-nav-text">&#x516B;&#x3001;Hibernate &#x4E0E;&#x89E6;&#x53D1;&#x5668;&#x534F;&#x540C;&#x5DE5;&#x4F5C;</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#ä¹-æ˜ å°„ä¸€å¯¹å¤šå…³è”å…³ç³»"><span class="toc-nav-number">9.</span> <span class="toc-nav-text">&#x4E5D;&#x3001;&#x6620;&#x5C04;&#x4E00;&#x5BF9;&#x591A;&#x5173;&#x8054;&#x5173;&#x7CFB;</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#1-å•å‘-n-1"><span class="toc-nav-number">9.1.</span> <span class="toc-nav-text">1&#x3001;&#x5355;&#x5411; N-1</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#2-åŒå‘-1-n"><span class="toc-nav-number">9.2.</span> <span class="toc-nav-text">2&#x3001;&#x53CC;&#x5411; 1-N</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#æ˜ å°„ä¸€å¯¹ä¸€å…³è”å…³ç³»"><span class="toc-nav-number">10.</span> <span class="toc-nav-text">&#x6620;&#x5C04;&#x4E00;&#x5BF9;&#x4E00;&#x5173;&#x8054;&#x5173;&#x7CFB;</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#æ˜ å°„å¤šå¯¹å¤šå…³è”å…³ç³»"><span class="toc-nav-number">11.</span> <span class="toc-nav-text">&#x6620;&#x5C04;&#x591A;&#x5BF9;&#x591A;&#x5173;&#x8054;&#x5173;&#x7CFB;</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#æ„Ÿè°¢é˜…è¯»"><span class="toc-nav-number"></span> <span class="toc-nav-text">&#x611F;&#x8C22;&#x9605;&#x8BFB;</span></a>
        
        </div>
      </aside>
    

                
            <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                
                <section>
                    <!-- no hr -->
                    <h5><a href="/tags/">FEATURED TAGS</a></h5>
                    <div class="tags">
                       
                          <a class="tag" href="/tags/#ORM æ¡†æ¶" title="ORM æ¡†æ¶">ORM æ¡†æ¶</a>
                        
                    </div>
                </section>
                

                <!-- Friends Blog -->
                
                <hr>
                <h5>FRIENDS</h5>
                <ul class="list-inline">

                    
                        <li><a href="https://yexua.github.io/" target="_blank">yexua</a></li>
                    
                        <li><a href="https://snailclimb.gitee.io/javaguide/#/" target="_blank">JavaGuide</a></li>
                    
                        <li><a href="http://cyc2018.gitee.io/cs-notes/#/notes/%E5%89%91%E6%8C%87%20Offer%20%E9%A2%98%E8%A7%A3%20-%20%E7%9B%AE%E5%BD%951" target="_blank">å‰‘æŒ‡Offer</a></li>
                    
                        <li><a href="http://cyc2018.gitee.io/cs-notes/#/" target="_blank">æŠ€æœ¯é¢è¯•å¿…å¤‡åŸºç¡€çŸ¥è¯†</a></li>
                    
                </ul>
                
            </div>
        </div>
    </div>
</article>








<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("https://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'hover',
          placement: 'left',
          icon: 'â„¬'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>



    <!-- Footer -->
    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                
                
                

                

                

                
                    <li>
                        <a target="_blank"  href="https://github.com/GitHub-yuteng">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                

                </ul>
                <p class="copyright text-muted">
                    Copyright &copy; äºè…¾ 2019 
                    <br>
                    Theme by <a href="http://beantech.org">BeanTech</a> 
                    <span style="display: inline-block; margin: 0 5px;">
                        <i class="fa fa-heart"></i>
                    </span> 
                    re-Ported by <a href="http://www.huweihuang.com">èƒ¡ä¼Ÿç…Œ</a> | 
                    <iframe
                        style="margin-left: 2px; margin-bottom:-5px;"
                        frameborder="0" scrolling="0" width="91px" height="20px"
                        src="https://ghbtns.com/github-btn.html?user=huweihuang&repo=hexo-theme-huweihuang&type=star&count=true" >
                    </iframe>
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js"></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js"></script>

<!-- Custom Theme JavaScript -->
<script src="/js/hux-blog.min.js"></script>


<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!-- 
     Because of the native support for backtick-style fenced code blocks 
     right within the Markdown is landed in Github Pages, 
     From V1.6, There is no need for Highlight.js, 
     so Huxblog drops it officially.

     - https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0  
     - https://help.github.com/articles/creating-and-highlighting-code-blocks/    
-->
<!--
    <script>
        async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
            hljs.initHighlightingOnLoad();
        })
    </script>
    <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">
-->


<!-- jquery.tagcloud.js -->
<script>
    // only load tagcloud.js in tag.html
    if($('#tag_cloud').length !== 0){
        async("https://github-yuteng.github.io/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                //size: {start: 1, end: 1, unit: 'em'},
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>

<!--fastClick.js -->
<script>
    async("https://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->


<script>
    // dynamic User by Hux
    var _gaId = 'UA-XXXXXXXX-X';
    var _gaDomain = 'yoursite';

    // Originial
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', _gaId, _gaDomain);
    ga('send', 'pageview');
</script>




<!-- Baidu Tongji -->

<script>
    // dynamic User by Hux
    var _baId = 'xxx';

    // Originial
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?" + _baId;
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
</script>






	<a id="rocket" href="#top" class=""></a>
	<script type="text/javascript" src="/js/totop.js?v=1.0.0" async=""></script>
    <script type="text/javascript" src="/js/toc.js?v=1.0.0" async=""></script>
<!-- Image to hack wechat -->
<img src="https://github-yuteng.github.io/img/icon_wechat.png" width="0" height="0" />
<!-- Migrate from head to bottom, no longer block render and still work -->

</body>

</html>
